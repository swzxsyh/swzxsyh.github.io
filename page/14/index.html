<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"swzxsyh.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="swzxsyh">
<meta property="og:url" content="https://swzxsyh.github.io/page/14/index.html">
<meta property="og:site_name" content="swzxsyh">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="swzxsyh">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://swzxsyh.github.io/page/14/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>swzxsyh</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="swzxsyh" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">swzxsyh</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">--笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-rss">

    <a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/25/Java-Web-Listener/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/25/Java-Web-Listener/" class="post-title-link" itemprop="url">Java Web - Listener</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-25 01:29:53" itemprop="dateCreated datePublished" datetime="2020-04-25T01:29:53+08:00">2020-04-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.Linstener<br>1.1 概述<br>中的监听器(观察者模式)<br>Java程序中，也要需要被监视的对象，一旦被监视对象发生变化，采取相应对象</p>
<p>监听器三大对象<br>HttpServletRequest,HttpSession,ServletContext</p>
<p>场景<br>历史访问次数，统计在线人数，系统启动时初始化配置信息</p>
<p>1.2 快速入门<br>使用ServletContextListener箭头项目启动和销毁做一些事，如在项目启动时加载配置文件<br>步骤:</p>
<p>创建ServletContextListener普通类<br>监听ServletContext创建、销毁<br>配置web.xml&#x2F;注解<br>补充:监听HttpServletRequestListener&#x2F;HttpSessionListener</p>
<p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.test.Demo01.MyListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line">  <span class="comment">//监听ServletContext创建</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ServletContext创建&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//监听ServletContext销毁</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ServletContext销毁&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line">  <span class="comment">//监听ServletContext创建</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ServletContext创建&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//监听ServletContext销毁</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ServletContext销毁&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.3 模拟Spring框架<br>ServletContext可以在项目启动时读取配置文件加载</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    全局配置参数--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>configLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>words.properties<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>




<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line">  <span class="comment">//监听ServletContext创建</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ServletContext创建&quot;</span>);</span><br><span class="line">    <span class="comment">//可以加载公司定义配置文件的名称</span></span><br><span class="line">    <span class="comment">//servletContextEvent 上下文事件对象，获取ServletContext</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> servletContextEvent.getServletContext();</span><br><span class="line">    <span class="comment">//通过加载定义公司定义的配置文件名称</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">configLoaction</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;configLocation&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;&quot;</span> + configLoaction);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//监听ServletContext销毁</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ServletContext销毁&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.4 案例统计在线人数<br>需求:<br>有用户使用网站: 在线人数+1,用户退出，在线人数-1</p>
<p>步骤分析<br>使用ServletContext域对象存储在线总人数<br>使用ServletContextListener在项目启动时，初始化总人数为0<br>使用HttpSessionListener监听器，用户访问，人数+1，用户退出，人数-1<br>使用LogoutServlet控制器对当前会话对Session手动销毁</p>
<p>代码实现</p>
<p>InitNumberListerner</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InitNumberListerner</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    <span class="comment">//获取上下文域对象</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> servletContextEvent.getServletContext();</span><br><span class="line">    <span class="comment">//初始化在线人数</span></span><br><span class="line">    servletContext.setAttribute(<span class="string">&quot;number&quot;</span>,<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>NumberChangeListener</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NumberChangeListener</span> <span class="keyword">implements</span> <span class="title class_">HttpSessionListener</span> &#123;</span><br><span class="line">  <span class="comment">//会话建立，在线人数+1</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionCreated</span><span class="params">(HttpSessionEvent httpSessionEvent)</span> &#123;</span><br><span class="line">    <span class="comment">//获取session</span></span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> httpSessionEvent.getSession();</span><br><span class="line">    <span class="comment">//获取上下文session域对象</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">    <span class="comment">//取出在线人数</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">number</span> <span class="operator">=</span> (Integer) servletContext.getAttribute(<span class="string">&quot;number&quot;</span>);</span><br><span class="line">    <span class="comment">//+1</span></span><br><span class="line">    servletContext.setAttribute(<span class="string">&quot;number&quot;</span>, number + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//会话销毁，在线人数-1</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionDestroyed</span><span class="params">(HttpSessionEvent httpSessionEvent)</span> &#123;</span><br><span class="line">    <span class="comment">//获取session</span></span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> httpSessionEvent.getSession();</span><br><span class="line">    <span class="comment">//获取上下文session域对象</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">    <span class="comment">//取出在线人数</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">number</span> <span class="operator">=</span> (Integer) servletContext.getAttribute(<span class="string">&quot;number&quot;</span>);</span><br><span class="line">    <span class="comment">//-1</span></span><br><span class="line">    servletContext.setAttribute(<span class="string">&quot;number&quot;</span>, number - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>index.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">  &lt;h3&gt;Learn Listener&lt;/h3&gt;</span><br><span class="line">  &lt;h5&gt;Online Member:$&#123;applicationScope.number&#125;&lt;/h5&gt;</span><br><span class="line"></span><br><span class="line">  &lt;a href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/LogoutServlet&quot;</span>&gt;Logout&lt;/a&gt;</span><br><span class="line">  $END$</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p>LogoutServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/LogoutServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogoutServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//销毁Session</span></span><br><span class="line">    req.getSession().invalidate();</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;Logout&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>二.综合案例<br>2.1 环境搭建</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String id;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String sex;</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line">  <span class="keyword">private</span> String address;</span><br><span class="line">  <span class="keyword">private</span> String qq;</span><br><span class="line">  <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EncodeFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">    <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) servletResponse;</span><br><span class="line">    <span class="keyword">if</span> (request.getMethod().equalsIgnoreCase(<span class="string">&quot;post&quot;</span>)) &#123;</span><br><span class="line">      request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    filterChain.doFilter(request, response);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataUtils</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">realpath</span> <span class="operator">=</span> <span class="string">&quot;/Users/swzxsyh/Program/userdata.txt&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//从文件中读取所有学员信息</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> List&lt;User&gt; <span class="title function_">readAll</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//保存所有学生对象信息</span></span><br><span class="line">    List&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//得到文件真实路径</span></span><br><span class="line">      <span class="comment">//创建字符输入流</span></span><br><span class="line">      <span class="type">Reader</span> <span class="variable">isr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(realpath), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">      <span class="comment">//创建字符缓冲流</span></span><br><span class="line">      <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(isr); <span class="comment">//装饰模式</span></span><br><span class="line">      <span class="comment">//一次读一行</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">row</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">while</span> ((row = br.readLine()) != <span class="literal">null</span>) &#123;<span class="comment">//row = &quot;1,张三,男,20&quot;</span></span><br><span class="line">        String[] arr = row.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(arr[<span class="number">0</span>]);</span><br><span class="line">        user.setName(arr[<span class="number">1</span>]);</span><br><span class="line">        user.setSex(arr[<span class="number">2</span>]);</span><br><span class="line">        user.setAge(Integer.parseInt(arr[<span class="number">3</span>]));</span><br><span class="line">        user.setAddress(arr[<span class="number">4</span>]);</span><br><span class="line">        user.setQq(arr[<span class="number">5</span>]);</span><br><span class="line">        user.setEmail(arr[<span class="number">6</span>]);</span><br><span class="line">        <span class="comment">//将User对象添加到集合</span></span><br><span class="line">        list.add(user);</span><br><span class="line">      &#125;</span><br><span class="line">      br.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//向文件中写入所有用户信息--覆盖写</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writeAll</span><span class="params">(List&lt;User&gt; list)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//创建字符输出流</span></span><br><span class="line">      <span class="type">Writer</span> <span class="variable">osw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(realpath), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">      <span class="comment">//创建字符缓冲流</span></span><br><span class="line">      <span class="type">BufferedWriter</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(osw);</span><br><span class="line">      <span class="comment">//循环向文件中写入文本</span></span><br><span class="line">      <span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">        out.write(user.getId() + <span class="string">&quot;,&quot;</span> + user.getName() + <span class="string">&quot;,&quot;</span> + user.getSex() + <span class="string">&quot;,&quot;</span> + user.getAge() + <span class="string">&quot;,&quot;</span> + user.getAddress() + <span class="string">&quot;,&quot;</span> + user.getQq() + <span class="string">&quot;,&quot;</span> + user.getEmail());</span><br><span class="line">        out.newLine();<span class="comment">//创建新的一行</span></span><br><span class="line">      &#125;</span><br><span class="line">      out.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    List&lt;User&gt; list = readAll();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.2 用户查询功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/FindAllServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FindAllServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line">    List&lt;User&gt; list = userService.findAll();</span><br><span class="line">    req.setAttribute(<span class="string">&quot;list&quot;</span>, list);</span><br><span class="line">    req.getRequestDispatcher(<span class="string">&quot;/list.jsp&quot;</span>).forward(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">  <span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDao</span>();</span><br><span class="line">  <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> userDao.findAll();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">      List&lt;User&gt; list = DataUtils.readAll();</span><br><span class="line">      <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


<p>2.3 添加用户功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AddServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();</span><br><span class="line">      <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">      BeanUtils.populate(user,parameterMap);</span><br><span class="line">      <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line">      userService.add(user);</span><br><span class="line">      resp.sendRedirect(req.getContextPath()+<span class="string">&quot;/FindAllServlet&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(User user)</span> &#123;</span><br><span class="line">  userDao.add(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(User user)</span> &#123;</span><br><span class="line">  List&lt;User&gt; list = DataUtils.readAll();</span><br><span class="line">  list.add(user);</span><br><span class="line">  DataUtils.writeAll(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.4 删除用户功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/DeleteServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeleteServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line">    userService.delete(id);</span><br><span class="line">    resp.sendRedirect(req.getContextPath()+<span class="string">&quot;/FindAllServlet&quot;</span>);</span><br><span class="line">  &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String id)</span>&#123;</span><br><span class="line">  userDao.delete(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String id)</span> &#123;</span><br><span class="line">  List&lt;User&gt; list = DataUtils.readAll();</span><br><span class="line">  <span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">    <span class="keyword">if</span> (user.getId().equalsIgnoreCase(id)) &#123;</span><br><span class="line">      list.remove(user);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  DataUtils.writeAll(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.5 修改用户功能<br>2.5.1 用户回显</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/FindByIdServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FindByIdServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.fidById(id);</span><br><span class="line">    req.setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">    req.getRequestDispatcher(<span class="string">&quot;/update.jsp&quot;</span>).forward(req, resp);</span><br><span class="line">  &#125;&#125;</span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">fidById</span><span class="params">(String id)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> userDao.findById(id);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">findById</span><span class="params">(String id)</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">returnUser</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    List&lt;User&gt; list = DataUtils.readAll();</span><br><span class="line">    <span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (user.getId().equalsIgnoreCase(id)) &#123;</span><br><span class="line">            returnUser = user;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> returnUser;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2.5.2 修改用户</p>
<p>​    </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/UpdateServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UpdateServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;<span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();</span><br><span class="line">      <span class="type">User</span> <span class="variable">newUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">      BeanUtils.populate(newUser, parameterMap);</span><br><span class="line">      <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line">      userService.update(newUser);</span><br><span class="line">      resp.sendRedirect(req.getContextPath() + <span class="string">&quot;/FindAllServlet&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User newUser)</span> &#123;</span><br><span class="line">  userDao.update(newUser);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User newUser)</span> &#123;</span><br><span class="line">  List&lt;User&gt; list = DataUtils.readAll();</span><br><span class="line">  <span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">    <span class="keyword">if</span> (user.getId().equalsIgnoreCase(newUser.getId())) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        BeanUtils.copyProperties(user, newUser);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  DataUtils.writeAll(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>总结<br>listener<br>概述<br>监听web三大域对象：Request、Session、ServletContext（创建和销毁）<br>作用<br>历史访问次数<br>统计在线人数<br>系统启动时初始化配置信息<br>快速入门<br>定义一个类，实现ServletContextListener接口<br>重写接口中的方法<br>配置</p>
<p>web.xml</p>
<p>别人写好的监听器，只能通过配置文件进行配置<br>注解</p>
<p>案例:统计在线人数<br>1）初始化在线人数<br>2）创建会话时人数+1，关闭会话时人数-1<br>3）servlet实现用户退出</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/23/Java-Web-Filter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/23/Java-Web-Filter/" class="post-title-link" itemprop="url">Java Web- Filter</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-23 01:28:53" itemprop="dateCreated datePublished" datetime="2020-04-23T01:28:53+08:00">2020-04-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.概述<br>Web中的过滤器:当用户访问服务器资源时，过滤器将请求拦截，完成一些通用操作</p>
<p>应用场景:登陆验证，统一编码处理，敏感字符过滤</p>
<p>二.快速入门<br>2.1 XML配置<br>编写Java类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuickFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    <span class="comment">//此方法拦截用户的请求</span></span><br><span class="line">    <span class="comment">//servletRequest请求对象</span></span><br><span class="line">    <span class="comment">//servletResponse响应对象</span></span><br><span class="line">    <span class="comment">//FilterChain过滤器链</span></span><br><span class="line">    System.out.println(<span class="string">&quot;QuickFilter Filter&quot;</span>);</span><br><span class="line">    <span class="comment">//放行</span></span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>配置XML</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    快速入门--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>QuickFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.test.Demo01.QuickFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>QuickFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Demo01.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.2 注解配置<br>注意:使用注解，需要把web.xml标签注释</p>
<p>编写java类，实现Filter接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@WebFilter(filterName = &quot;QuickFilter&quot;,urlPatterns = &quot;/quick.jsp&quot;)</span></span><br><span class="line"><span class="comment">//@WebFilter(urlPatterns = &quot;/quick.jsp&quot;)</span></span><br><span class="line"><span class="comment">//@WebFilter(value = &quot;/quick.jsp&quot;)</span></span><br><span class="line"><span class="meta">@WebFilter(&quot;/quick.jsp&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuickFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    <span class="comment">//此方法拦截用户的请求</span></span><br><span class="line">    <span class="comment">//servletRequest请求对象</span></span><br><span class="line">    <span class="comment">//servletResponse响应对象</span></span><br><span class="line">    <span class="comment">//FilterChain过滤器链</span></span><br><span class="line">    System.out.println(<span class="string">&quot;QuickFilter Filter&quot;</span>);</span><br><span class="line">    <span class="comment">//放行</span></span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>三.工作原理<br>发送请求<br>doFilter{<br>对请求拦截<br>是否放行<br>对响应增强<br>}<br>quick.jsp调用Service方法<br>doFilter{<br>对响应增强<br>}<br>返回响应<br>四.使用细节<br>4.1 生命周期<br>方法	代码<br>初始化方法	public void init(FilterConfig filterConfig)<br>拦截方法	public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)<br>销毁方法	public void destroy()<br>时机	说明<br>创建	服务器启动项目加载，创建filter对象，执行init方法<br>运行(过滤拦截)	用户访问被拦截目标资源时，执行doFilter方法<br>销毁	服务器关闭或项目卸载时，销毁filter对象，执行destroy方法(只执行一次)<br>注意	过滤器一定是优先于servlet创建的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置初始化参数一般不会在注解中使用</span></span><br><span class="line"><span class="comment">//@WebFilter(value = &quot;/show.jsp&quot;, initParams = &#123;@WebInitParam(name = &quot;encode&quot;, value = &quot;utf-8&quot;)&#125;)</span></span><br><span class="line"><span class="comment">//@WebFilter(&quot;/show.jsp&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LifeCycleFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String encode;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//filterConfig它是filter对配置对象</span></span><br><span class="line">  <span class="comment">//作用:获取filter对初始化参数</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;LifeCycleFilter Run&quot;</span>);</span><br><span class="line">    filterConfig.getInitParameter(<span class="string">&quot;encode&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;LifeCycleFilter Filter Request,Run Method&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;Unicode&quot;</span>+encode);</span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;LifeCycleFilter Destroy&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>LifeCycleFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.test.Demo02.LifeCycleFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encode<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>LifeCycleFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/show.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>4.2 拦截路径<br>在开发时，可以指定过滤器对拦截路径来定义拦截目标资源的范围<br>匹配方式	说明<br>精准匹配	用户访问指定目标资源(&#x2F;show.jsp)时，过滤器进行拦截<br>目录匹配	用户访问指定目录下(&#x2F;user&#x2F;<em>)所有资源时，过滤器进行拦截<br>后缀匹配	用户访问指定后缀名(</em>.jsp)的资源时，过滤器进行拦截<br>匹配所有	用户访问该网站所有资源(&#x2F;*)时，过滤器进行拦截</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@WebFilter(&quot;/show.jsp&quot;) //精准匹配</span></span><br><span class="line"><span class="comment">//@WebFilter(&quot;/User/*&quot;)     //目录匹配</span></span><br><span class="line"><span class="comment">//@WebFilter(&quot;*.html&quot;)  //后缀匹配</span></span><br><span class="line"><span class="meta">@WebFilter(&quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UrlPatternFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;UrlPatternFilter拦截了请求...&quot;</span>); <span class="comment">// 放行</span></span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4.3 拦截方式<br>开发时，可以指定过滤器拦截方式来处理不同的应用场景(如浏览器发送的，或内部转发的)<br>拦截方式	说明<br>request(默认拦截方式)	浏览器直接发送请求时，过滤器拦截<br>forward	资源A转发到资源B时，过滤器拦截<br>资源A:ForwardServlet<br>资源B:show.jsp<br>可以同时配置两者	<br>XML版本</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ModeFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Filter&quot;</span>);</span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>ModeFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.test.Demo04.ModeFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>ModeFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/show.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>FORWARD<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>REQUEST<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注解版本</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(value = &quot;/show.jsp&quot;,dispatcherTypes = &#123;DispatcherType.REQUEST,DispatcherType.FORWARD&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ModeFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Filter&quot;</span>);</span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4.4 过滤器链<br>在一次请求中，若请求匹配到多个filter，通过请求将相当于把这些filter串起来，形成过滤器链</p>
<p>需求<br>用户访问目标资源 show.jsp时，经过 FilterA FilterB</p>
<p>过滤器链执行顺序 (先进后出)</p>
<p>1.用户发送请求<br>2.FilterA拦截，放行<br>3.FilterB拦截，放行<br>4.执行目标资源 show.jsp<br>5.FilterB增强响应<br>6.FilterA增强响应<br>7.封装响应消息格式，返回到浏览器</p>
<p>过滤器链中执行的先后问题</p>
<p>方式	顺序<br>配置文件	谁先声明，谁先执行<br><filter-mapping><br>注解【不推荐】	根据过滤器类名进行排序，值小的先执行<br>FilterA FilterB 进行比较， FilterA先执行<br>4.5 注解和XML使用<br>如果是自己定义filter，无执行先后顺序，可以使用注解开发<br>如果是第三方jar提供的filter，要在web.xml进行配置<br>五.综合案例<br>5.1 用户评论留言<br>需求<br>用户访问某论坛网站，可以对文章比赛等内容进行留言</filter-mapping></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;BBS&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">  &lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h3&gt;LPL View Board&lt;/h3&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/WordServlet&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">      &lt;textarea name=<span class="string">&quot;content&quot;</span> id=<span class="string">&quot;&quot;</span> cols=<span class="string">&quot;30&quot;</span> rows=<span class="string">&quot;10&quot;</span>&gt;&lt;/textarea&gt;</span><br><span class="line">      &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;text&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/WordServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//接收请求参数Content</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;content&quot;</span>);</span><br><span class="line">    <span class="comment">//结果响应到浏览器</span></span><br><span class="line">    resp.getWriter().write(content);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.2 统一网站编码<br>需求<br>tomcat8.5版本中已经将get请求的中文乱码解决了,但是post请求还存在中文乱码 浏览器发出的任何请求，通过过滤器统一处理中文乱码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 统一网站编码   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodeFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.test.Case01.EncodeFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encode<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodeFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EncodeFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String encode;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    encode = filterConfig.getInitParameter(<span class="string">&quot;encode&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    <span class="comment">//类型向下转换</span></span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">    <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) servletResponse;</span><br><span class="line">    <span class="comment">//判断用户是否为post请求，才设置编码</span></span><br><span class="line">    <span class="keyword">if</span> (request.getMethod().equalsIgnoreCase(<span class="string">&quot;post&quot;</span>)) &#123;</span><br><span class="line">      request.setCharacterEncoding(encode);</span><br><span class="line">    &#125;</span><br><span class="line">    response.setContentType(<span class="string">&quot;text/html;charset=&quot;</span> + encode);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//放行</span></span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.3 非法字符拦截</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(&quot;/WordServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordsFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> List&lt;String&gt; wordList;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    <span class="comment">//加载配置文件,ResourceBundle专门读取src下的properties文件，不需要后缀名</span></span><br><span class="line">    <span class="type">ResourceBundle</span> <span class="variable">words</span> <span class="operator">=</span> ResourceBundle.getBundle(<span class="string">&quot;words&quot;</span>);</span><br><span class="line">    <span class="comment">//读取keyword关键字内容</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">keyword</span> <span class="operator">=</span> words.getString(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">    <span class="comment">//split切割，转为list集合</span></span><br><span class="line">    wordList = Arrays.asList(keyword.split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">    System.out.println(wordList);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    <span class="comment">//向下转型</span></span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">    <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) servletResponse;</span><br><span class="line">    <span class="comment">//获取用户输入的值</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;content&quot;</span>);</span><br><span class="line">    <span class="comment">//拦截非法内容，提示</span></span><br><span class="line">    <span class="keyword">for</span> (String word : wordList) &#123;</span><br><span class="line">      <span class="keyword">if</span>(content.contains(word))&#123;</span><br><span class="line">        response.getWriter().write(<span class="string">&quot;Input Words has Problem&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//放行</span></span><br><span class="line">    filterChain.doFilter(request, response);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.4 非法字符过滤</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRequest</span> <span class="keyword">extends</span> <span class="title class_">HttpServletRequestWrapper</span> &#123;</span><br><span class="line">  <span class="comment">//非法词库</span></span><br><span class="line">  <span class="keyword">private</span> List&lt;String&gt; wordList;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">MyRequest</span><span class="params">(HttpServletRequest request, List&lt;String&gt; wordList)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(request);</span><br><span class="line">    <span class="built_in">this</span>.wordList = wordList;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//对谁增强就重写谁</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getParameter</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    <span class="comment">//调用原有的功能，获取用户输入的值</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">parameter</span> <span class="operator">=</span> <span class="built_in">super</span>.getParameter(name);</span><br><span class="line">    <span class="comment">//对非法词库过滤</span></span><br><span class="line">    <span class="keyword">for</span> (String word : wordList) &#123;</span><br><span class="line">      <span class="keyword">if</span> (parameter.contains(word)) &#123;</span><br><span class="line">        <span class="comment">//注意:替换完后进行覆盖</span></span><br><span class="line">        parameter = parameter.replaceAll(word, <span class="string">&quot;**&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> parameter;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(&quot;/WordServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordsProFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> List&lt;String&gt; wordList;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    <span class="comment">//加载配置文件,ResourceBundle专门读取src下的properties文件，不需要后缀名</span></span><br><span class="line">    <span class="type">ResourceBundle</span> <span class="variable">words</span> <span class="operator">=</span> ResourceBundle.getBundle(<span class="string">&quot;words&quot;</span>);</span><br><span class="line">    <span class="comment">//读取keyword关键字内容</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">keyword</span> <span class="operator">=</span> words.getString(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">    <span class="comment">//split切割，转为list集合</span></span><br><span class="line">    wordList = Arrays.asList(keyword.split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">    System.out.println(wordList);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    <span class="comment">//向下转型</span></span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">    <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> (HttpServletResponse) servletResponse;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//对request对象进行包装(过滤)</span></span><br><span class="line">    <span class="type">MyRequest</span> <span class="variable">requestPro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyRequest</span>(request, wordList);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//放行</span></span><br><span class="line">    filterChain.doFilter(requestPro, response);</span><br><span class="line">    System.out.println(wordList);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>附录 Filter模版设置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> ($&#123;PACKAGE_NAME&#125; &amp;&amp; $&#123;PACKAGE_NAME&#125; != <span class="string">&quot;&quot;</span>)<span class="keyword">package</span> $&#123;PACKAGE_NAME&#125;;#end #parse(<span class="string">&quot;File Header.java&quot;</span>) <span class="meta">@javax</span>.servlet.annotation.WebFilter(<span class="string">&quot;/$&#123;Entity_Name&#125;&quot;</span>)</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">$</span>&#123;Class_Name&#125; <span class="keyword">implements</span> <span class="title class_">javax</span>.servlet.Filter &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(javax.servlet.FilterConfig config)</span> <span class="keyword">throws</span> javax.servlet.ServletException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(javax.servlet.ServletRequest servletRequest, javax.servlet.ServletResponse servletResponse, javax.servlet.FilterChain chain)</span> <span class="keyword">throws</span> javax.servlet.ServletException, java.io.IOException &#123;</span><br><span class="line">      <span class="comment">// 放行</span></span><br><span class="line">      chain.doFilter(servletRequest, servletResponse); &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125; &#125;</span><br></pre></td></tr></table></figure>


<p>总结<br>概述<br>作用<br>拦截用户请求<br>应用场景<br>如：登录验证、统一编码处理、敏感字符过滤…<br>快速入门</p>
<ol>
<li>定义一个类实现Filter接口<br>javax.servlet 包</li>
<li>重写filter方法<br>doFilter</li>
<li>配置<br>web.xml<br>注解<br>工作原理<br>用户发送请求<br>执行Filter拦截请求</li>
</ol>
<p>放行（执行放行后的资源）</p>
<p>执行Filter拦截响应</p>
<p>响应给浏览器结果<br>细节<br>生命周期<br>何时创建</p>
<p>在服务器启动时，创建fitler对象，执行init方法，只执行一次<br>何时销毁</p>
<p>服务器正常关闭时，销毁filter对象，执行destroy方法，只执行一次<br>创建优先级</p>
<p>ServletContext</p>
<p>Filter</p>
<p>Servlet<br>拦截路径<br>精准匹配</p>
<p>&#x2F;show.jsp<br>目录匹配</p>
<p>&#x2F;user&#x2F;*<br>后缀匹配</p>
<p>*.html<br>拦截所有</p>
<p>&#x2F;*<br>拦截方式<br>REQUEST</p>
<p>客户端直接访问资源时，执行Filter<br>FORWARD</p>
<p>服务器内部资源跳转时，执行Filter<br>过滤器链<br>拦截顺序</p>
<p>先进后出<br>执行先后</p>
<p>web.xml</p>
<p>谁先声明，谁先执行<br>注解</p>
<p>按照自定义过滤器类名的字符串比较规则，值小的先执行</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/23/Docker%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8Oracle-11g/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/23/Docker%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8Oracle-11g/" class="post-title-link" itemprop="url">Docker安装使用Oracle 11g</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-23 01:28:17" itemprop="dateCreated datePublished" datetime="2020-04-23T01:28:17+08:00">2020-04-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-15 04:25:41" itemprop="dateModified" datetime="2022-11-15T04:25:41+08:00">2022-11-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Docker安装使用Oracle-11g"><a href="#Docker安装使用Oracle-11g" class="headerlink" title="Docker安装使用Oracle 11g"></a>Docker安装使用Oracle 11g</h1><h2 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拉取镜像</span></span><br><span class="line">docker pull registry.cn-hangzhou.aliyuncs.com/helowin/oracle_11g</span><br><span class="line"><span class="comment"># 可以改名</span></span><br><span class="line">docker tag xxxxxxxxxx oracle:oracle_11g  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动镜像</span></span><br><span class="line">docker run -d -p 1521:1521 --name oracle_11g oracle_11g:latest               </span><br><span class="line"><span class="comment"># 查看容器是否运行</span></span><br><span class="line">docker ps -a</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入容器</span></span><br><span class="line">docker <span class="built_in">exec</span> -it oracle_11g bash  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到root</span></span><br><span class="line">su root</span><br><span class="line"><span class="comment">#密码:helowin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑profile文件</span></span><br><span class="line">vi /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最后行添加如下环境变量</span></span><br><span class="line"><span class="built_in">export</span> ORACLE_HOME=/home/oracle/app/oracle/product/11.2.0/dbhome_2</span><br><span class="line"><span class="built_in">export</span> ORACLE_SID=helowin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ORACLE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建软链接</span></span><br><span class="line"><span class="built_in">ln</span> -s <span class="variable">$ORACLE_HOME</span>/bin/sqlplus /usr/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换回oracle</span></span><br><span class="line">su - oracle</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/04/23/Docker%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8Oracle-11g/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/21/JSP-MVC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/21/JSP-MVC/" class="post-title-link" itemprop="url">JSP & MVC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-21 01:26:17" itemprop="dateCreated datePublished" datetime="2020-04-21T01:26:17+08:00">2020-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.JSP<br>1.1 概述<br>简单来说:在html标签中嵌套java代码<br>作用:简化书写，展示动态页面<br>1.2 快速入门<br>在jsp页面显示当前时间</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-mm-dd HH:mm:ss&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">currentTime</span> <span class="operator">=</span> sdf.format(date);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;h3&gt;&lt;%out.write(currentTime);%&gt;&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>1.3 工作原理<br>JSP本质就是一个Servlet<br>index.jsp<br>转换⬇<br>index_jsp.java<br>servlet接口<br>编译⬇<br>index_jsp.class<br>执行 service方法<br>1.4 脚本和注释<br>1.4.1 脚本<br>JSP通过脚本方式来定义Java代码<br>格式	说明<br>&lt;% 代码%&gt;	脚本片段，生成在service方法中，每次请求的时候都会执行<br>&lt;%! 代码%&gt;	声明片段，在java代码中声明成员，放在jsp生成jsva文件中的成员位置<br>&lt;%&#x3D;代码%&gt;	输出脚本片段，相当于out.print(“Code”);方法，输出到jsp页面<br>格式	说明<br>out.print();	方法支持一切类型输出<br>out.write();	仅支持字符类型输出，如果传递的是整型，将根据ASCII码表转换输出<br>1.4.2 注释<br>格式	说明<br>&lt;!– 注释静态资源 –&gt;	html注释<br>&lt;%– 注释所有 –%&gt;	JSP注释<br>&#x2F;&#x2F; 单行注释<br>&#x2F;* 多行注释 &#x2F;<br>&#x2F;*文档注释 *&#x2F;	Java注释(JSP脚本内使用)<br>1.5 指令<br>作用<br>用于配置JSP页面，导入资源文件</p>
<p>格式<br>&lt;%@ 指令名称 属性名1&#x3D;”属性值1” 属性名2&#x3D;”属性值2” %&gt;</p>
<p>三大指令</p>
<p>指令	作用<br>page	配置JSP页面<br>include	页面包含(静态)<br>taglib	导入资源文件<br>1.5.1 page指令<br>指令	作用<br>contentType	相当于response.setContentType();设置响应体的MIME类型和编码方式<br>language	指定语言，目前仅支持Java<br>import	导入jar包<br>errorpage	当页面报错后，自动跳转到指定错误提示页面<br>isErrorpage	默认false关闭，设置true</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.Date&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.text.SimpleDateFormat&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span>  errorPage=<span class="string">&quot;500.jsp&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>();</span><br><span class="line">    Integer age=<span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> isErrorPage=<span class="string">&quot;true&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h3&gt;Server Busy&lt;/h3&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//打印错误提示</span></span><br><span class="line">    out.print(exception.getMessage());</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>1.5.2 include指令(静态包含)</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- top.jsp --&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Top&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div style=<span class="string">&quot;border: skyblue dashed 5px;height: 150px&quot;</span>&gt;Top&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo03&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">&quot;top.jsp&quot;</span>%&gt;</span><br><span class="line">&lt;div style=<span class="string">&quot;border: 5px solid red;height:200px &quot;</span>&gt;</span><br><span class="line">Demo03</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>1.5.3 taglib指令<br>导入jar包<br>通过taglib指令引入</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%<span class="meta">@taglib</span> prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo04&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h3&gt;Taglib 指令&lt;/h3&gt;</span><br><span class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">&quot;&quot;</span>&gt;&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>1.6 内置对象<br>作用<br>JSP 页面中不需要get获取也不需要手动创建，就可以直接使用的对象<br>变量名	真实类型	作用<br>pageContexxt	PageContext	当前页面中共享数据(域对象)<br>request	HttpServletRequest	一切请求中共享数据<br>session	HttpSession	一次会话中共享数据(域对象)<br>application	ServletContext	整个web应用共享数据(域对象)<br>————-	——————-	——————-<br>response	HttpServletResponse	响应对象<br>page(this)	Object	当前页面Servlet对象<br>out	JSPWriter	输出对象<br>config	ServletConfig	Servlet配置对象<br>exception	Throwable	异常对象(默认关闭)<br>常用:<br>pageContext	1)当前页面的域对象<br>2)获取其他八个内置对象<br>request	1)接收用户请求(参数)<br>2)一次请求中域对象<br>response	1)设置响应:<br>  字节流<br>  字符流<br>out	1)专门在jsp中处理字符流<br>  print()&#x2F;&#x2F;可以输出一切类型<br>  wirte(); &#x2F;&#x2F;只能输出字符类型<br>1.7 JSP动作标签<br>作用<br>简化JSP页面编码<br>常用<br>指令	底层	作用<br><a href="Jsp:include">Jsp:include</a>	request.getRequestDispatcher().include(req,resp)	页面包含(动态)<br><a href="Jsp:forward">Jsp:forward</a>	request.getRequestDispatcher().forward(req,resp)	请求转发(页面跳转)<br><a href="Jsp:param">Jsp:param</a>	include forward的子标签<br>使用request.getParameter()获取参数	参数传递<br>1.7.1 动态包含<br>静态包含</p>
<p>demo03.jsp	合并转换为一个java文件➡	demo3.java	编译➡	demo3.class	执行➡	response封装响应输出<br>top.jsp<br>动态包含</p>
<p>demo06.jsp	转换➡	demo06.java	编译➡	demo06.class	合并执行➡	response封装响应输出<br>top.jsp	转换➡	top.java	编译➡	top.class</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo06&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;jsp:include page=<span class="string">&quot;top.jsp&quot;</span>&gt;&lt;/jsp:include&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=<span class="string">&quot;border: gray 1px solid;height: 400px&quot;</span>&gt;JSP的动态包含:主体&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>


<p>在企业开发时，推荐使用静态包含提示访问性能；注意:不能出现重名的变量</p>
<p>1.7.2 请求转发</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;A&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    System.out.println(<span class="string">&quot;A Run&quot;</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;request Set&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;jsp:forward page=<span class="string">&quot;b.jsp&quot;</span>&gt;</span><br><span class="line">    &lt;jsp:param name=<span class="string">&quot;name&quot;</span> value=<span class="string">&quot;jack&quot;</span>&gt;&lt;/jsp:param&gt;</span><br><span class="line">    &lt;jsp:param name=<span class="string">&quot;age&quot;</span> value=<span class="string">&quot;18&quot;</span>&gt;&lt;/jsp:param&gt;</span><br><span class="line">&lt;/jsp:forward&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;B&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    System.out.println(<span class="string">&quot;B Run&quot;</span>);</span><br><span class="line">    <span class="comment">//request域传递</span></span><br><span class="line">    System.out.println(request.getAttribute(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">    <span class="comment">//param标签传递</span></span><br><span class="line">    System.out.println(request.getParameter(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">    System.out.println(request.getParameter(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>二.MVC模式<br>2.1 JSP发展介绍<br>早期只有servlet，只能使用response输出html标签，非常麻烦。<br>后来有了JSP，简化了servlet开发;如果过度使用JSP，在JSP页面中写了大量的java代码和html标签，造成难于 维护，难于分工协作的场景。<br>再后来为了弥补过度使用jsp的问题，我们使用servlet+jsp这套组合拳，利于分工协作。<br>简单来说:就是一套总结出来的设计经验，适合在各种软件开发领域</p>
<p>目的:高内聚，低耦合<br>2.2 MVC介绍<br>MVC设计模式: Model-View-Controller简写。<br>MVC是软件工程中的一种软件架构模式，它是一种分离业务逻辑与显示界面的设计方法。<br>指令	<br>M	model(模型)<br>⬇<br>JavaBean(1.处理业务逻辑，2.封装实体)<br>V	view(视图<br>⬇<br>JSP(展示数据)<br>C	controller(控制器)<br>⬇<br>Servlet(1.接收请求，2.调用模型，3.转发视图)<br>优点	降低耦合性，方便维护和拓展，利于分工协作<br>缺点	使得项目架构变得复杂，对开发人员要求高<br>客户端<br>静态资源<br>动态资源<br>请求➡	服务器<br>Controller<br>Servlet<br>1.接收请求<br>2.调用模型<br>3.转发视图	➡<br>⬅	Model<br>JavaBean<br>处理业务逻辑<br>封装实体	➡<br>⬅	SQL<br>⬇<br>⬅返回	View<br>jsp、html<br>展示动静内容</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/21/EL-JSTL-MVC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/21/EL-JSTL-MVC/" class="post-title-link" itemprop="url">EL & JSTL & MVC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-21 01:23:40" itemprop="dateCreated datePublished" datetime="2020-04-21T01:23:40+08:00">2020-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.EL<br>1.1 概述<br>表达式语言(Expression Language)<br>作用:<br>主要用于代替jsp中脚本的功能，简化对java代码对操作<br>语法:<br>${表达式}<br>1.2 使用<br>1.2.1 获取值<br>EL表达式只能从域对象(4个域)中获取数据<br>标准写法	<br>${pageScope.键名}	从page域中获取指定键名对应的值<br>${requestScope.键名}	从request域中获取指定键名对应的值<br>${sessionScope.键名}	从session域中获取指定键名对应的值<br>${applicationScope.键名}	从servletContext域中获取指定键名对应的值<br>简化写法	<br>${键名}	特点:默认从最小域开始找，找到后直接显示，不在继续寻找<br>注意:要求四个域键名唯一</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo01&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h3&gt;EL 表达式基本语法&lt;/h3&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    /*模拟Servlet向域中存值*/</span><br><span class="line">    pageContext.setAttribute(&quot;Username&quot;, &quot;Jack&quot;);</span><br><span class="line">    request.setAttribute(&quot;Age&quot;, &quot;50&quot;);</span><br><span class="line">    session.setAttribute(&quot;Gender&quot;, &quot;Male&quot;);</span><br><span class="line">    application.setAttribute(&quot;Address&quot;, &quot;NY&quot;);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;h5&gt;标准语法&lt;/h5&gt;</span><br><span class="line">$&#123;pageScope.Username&#125;&lt;br&gt;&lt;%--不会提示空指针异常--%&gt;</span><br><span class="line">$&#123;requestScope.Age&#125;&lt;br&gt;</span><br><span class="line">$&#123;sessionScope.Gender&#125;&lt;br&gt;</span><br><span class="line">$&#123;applicationScope.Address&#125;&lt;br&gt;</span><br><span class="line">&lt;h5&gt;简化语法&lt;/h5&gt;</span><br><span class="line">$&#123;Username&#125;&lt;br&gt;</span><br><span class="line">$&#123;Age&#125;&lt;br&gt;</span><br><span class="line">$&#123;Gender&#125;&lt;br&gt;</span><br><span class="line">$&#123;Address&#125;&lt;br&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>练习<br>获取字符串	${键名}<br>获取对象(User)	${键名.属性名}<br>获取List(Array)集合	${键名[索引]}<br>获取Map集合	${键名.key}<br>${键名[“key”]}<br>——–	<br>注意	El不会出现null和数组角标越界问题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">  &lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">  &lt;title&gt;Demo02&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;h3&gt;获取User对象&lt;/h3&gt;</span><br><span class="line">&lt;%</span><br><span class="line">  User user = new User(&quot;Jack&quot;, 13, &quot;Male&quot;);</span><br><span class="line">request.setAttribute(&quot;user&quot;,user);</span><br><span class="line">%&gt;</span><br><span class="line">  $&#123;user&#125;&lt;br&gt;&lt;%--执行该对象对toString方法--%&gt;</span><br><span class="line">    $&#123;user.username&#125; ｜$&#123;user.age&#125; ｜$&#123;user.gender&#125;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">      &lt;h3&gt;获取List集合&lt;/h3&gt;</span><br><span class="line">&lt;%</span><br><span class="line">      List&lt;Object&gt; list = new ArrayList&lt;&gt;();</span><br><span class="line">list.add(&quot;A&quot;);</span><br><span class="line">list.add(&quot;B&quot;);</span><br><span class="line">list.add(&quot;C&quot;);</span><br><span class="line">list.add(user);</span><br><span class="line">request.setAttribute(&quot;list&quot;,list);</span><br><span class="line"></span><br><span class="line">%&gt;&gt;</span><br><span class="line">  $&#123;list&#125;&lt;br&gt;&lt;%--执行该对象对toString方法--%&gt;</span><br><span class="line">    $&#123;list[0]&#125; ｜ $&#123;list[1]&#125; ｜ $&#123;list[2]&#125; ｜ $&#123;list[3].username&#125; ｜$&#123;list[3].age&#125;&lt;br&gt;</span><br><span class="line">      $&#123;list[3].gender&#125;&lt;%--EL表达式不会出现集合(数组)角标越界异常--%&gt;</span><br><span class="line"></span><br><span class="line">        &lt;h3&gt;获取map集合&lt;/h3&gt;</span><br><span class="line">&lt;%</span><br><span class="line">        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span><br><span class="line">map.put(&quot;key1&quot;,&quot;A&quot;);</span><br><span class="line">map.put(&quot;key2&quot;,&quot;B&quot;);</span><br><span class="line">map.put(&quot;key3&quot;,&quot;C&quot;);</span><br><span class="line">map.put(&quot;key.4&quot;,user);</span><br><span class="line">request.setAttribute(&quot;map&quot;,map);</span><br><span class="line">%&gt;</span><br><span class="line">  $&#123;map&#125;&lt;br&gt;&lt;%--执行该对象对toString方法--%&gt;</span><br><span class="line">    $&#123;map.get(&quot;key1&quot;)&#125; | $&#123;map.key2&#125; | $&#123;map.key3&#125;&lt;br&gt;</span><br><span class="line">      $&#123;map[&#x27;key.4&#x27;]&#125;&lt;br&gt;</span><br><span class="line">        $&#123;map[&#x27;key.4&#x27;].username&#125; | $&#123;map[&#x27;key.4&#x27;].age&#125; | $&#123;map[&#x27;key.4&#x27;].gender&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>1.2.2 执行运算<br>运算符	语法<br>算数运算符	+ - * &#x2F;(div) %(mod)<br>比较运算符	&gt; &lt; &gt;&#x3D; &lt;&#x3D; &#x3D;&#x3D;(eq) !&#x3D;(ne)<br>逻辑运算符	&amp;&amp;(and)<br>三元运算符	${条件表达式?为真:为假}<br>——–	————————–<br>空运算符	${not empty 对象}<br>功能:<br>可以判断字符串和对象是否为空<br>可以判断一个集合的长度是否为0</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">  &lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">  &lt;title&gt;Demo03&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;%</span><br><span class="line">  int a = 4;</span><br><span class="line">int b = 3;</span><br><span class="line">request.setAttribute(&quot;a&quot;, a);</span><br><span class="line">request.setAttribute(&quot;b&quot;, b);</span><br><span class="line">%&gt;</span><br><span class="line">  &lt;h5&gt;算数运算符&lt;/h5&gt;</span><br><span class="line">$&#123;a / b&#125; | $&#123;a div b&#125; &lt;br&gt;</span><br><span class="line">  $&#123;a % b&#125; | $&#123;a mod b&#125; &lt;br&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h5&gt;比较运算符&lt;/h5&gt;</span><br><span class="line">$&#123;a == b&#125; | $&#123;a eq b&#125;&lt;br&gt;</span><br><span class="line">  $&#123;a != b&#125; | $&#123;a ne b&#125;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h5&gt;三元运算符&lt;/h5&gt;</span><br><span class="line">$&#123;a==b?&quot;Y&quot;:&quot;N&quot;&#125;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">  &lt;h5&gt;非空判断&lt;/h5&gt;</span><br><span class="line">&lt;%</span><br><span class="line">  User user = new User();</span><br><span class="line">request.setAttribute(&quot;user&quot;, user);</span><br><span class="line"></span><br><span class="line">List list = new ArrayList();</span><br><span class="line">list.add(&quot;aa&quot;);</span><br><span class="line">request.setAttribute(&quot;list&quot;, list);</span><br><span class="line">%&gt;</span><br><span class="line">  $&#123;not empty user&#125;&lt;%--if(user != null)&#123;&#125;--%&gt;</span><br><span class="line">    $&#123;not empty list&#125;&lt;%--if(list != null &amp;&amp; list.size()&gt;0)--%&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">      &lt;h5&gt;空值判断&lt;/h5&gt;</span><br><span class="line">$&#123;empty user&#125;&lt;%--if(user == null)&#123;&#125;--%&gt;</span><br><span class="line">  $&#123;empty list&#125;&lt;%--if(list == null &amp;&amp; list.size()==0)--%&gt;&lt;br&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>1.2.3 隐式对象<br>EL表达式中有11个隐藏对象<br>掌握<br>pageContext<br>cookie<br>对象	作用<br>pageContext	就是jsp九大内置对象之一，可以通过它获得其他八个内置对象<br>cookie	可以获取浏览器指定cookie名称的值</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo04&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">  &lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h3&gt;EL隐式对象&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">    $&#123;pageContext.request.contextPath&#125;&lt;%--动态获取:项目名称(虚拟路径)--%&gt;&lt;br&gt;</span><br><span class="line">    $&#123;cookie.JSESSIONID.value&#125;&lt;%--获取指定cookie名称的值--%&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="number">1.2</span><span class="number">.4</span> 补充</span><br><span class="line">jsp默认支持el表达式</span><br><span class="line">servlet2<span class="number">.3</span>规范中，默认不支持el表达式</span><br><span class="line">忽略el表达式	方法</span><br><span class="line">忽略当前jsp页面中所有的el表达式	isELIgnored=”<span class="literal">true</span>” 属性</span><br><span class="line">忽略单个el表达式	$&#123;表达式&#125;</span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> isELIgnored=<span class="string">&quot;false&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo04&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;h3&gt;EL隐式对象&lt;/h3&gt;</span><br><span class="line">    $&#123;pageContext.request.contextPath&#125;&lt;%--动态获取:项目名称(虚拟路径)--%&gt;&lt;br&gt;</span><br><span class="line">    $&#123;cookie.JSESSIONID.value&#125;&lt;br&gt;&lt;%--获取指定cookie名称的值--%&gt;</span><br><span class="line">    \$&#123;cookie.JSESSIONID.value&#125;&lt;%--获取指定cookie名称的值--%&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>1.3 JavaBean<br>实际上是一个普通Java类<br>使用规范<br>所有字段(成员变量)为private<br>提供无参构造方法<br>提供getter,setter和is方法<br>实现Serializable接口<br>例如:如下User类有4个字段(成员变量),有全参和无参构造方法，有一个属性(username)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String Username;</span><br><span class="line">  <span class="keyword">private</span> Integer Age;</span><br><span class="line">  <span class="keyword">private</span> String  Gender;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> success;<span class="comment">//是否操作成功</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSuccess</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> success;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSuccess</span><span class="params">(<span class="type">boolean</span> success)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.success = success;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Username;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">    Username = username;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> Integer <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(Integer age)</span> &#123;</span><br><span class="line">    Age = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getGender</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Gender;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setGender</span><span class="params">(String gender)</span> &#123;</span><br><span class="line">    Gender = gender;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>二.JSTL<br>2.1 概述<br>Jsp 标准标签库(Jsp Standard Tag Library)，是由Apache组织提供的开源的jsp标签库<br>作用:替换和简化jsp页面中java代码的编写<br>JSTL标准标签库有5个子库，但随着发展，目前常使用的是它的核心库(Core)<br>标签库	标签库的URI	前缀<br>Core	<a target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/core">http://java.sun.com/jsp/jstl/core</a>	c<br>国际化(几乎不用)	<a target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/fmt">http://java.sun.com/jsp/jstl/fmt</a>	fmt<br>SQL(过时)	<a target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/sql">http://java.sun.com/jsp/jstl/sql</a>	sql<br>XML(过时)	<a target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/xml">http://java.sun.com/jsp/jstl/xml</a>	x<br>Functions(几乎不用)	<a target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/functions">http://java.sun.com/jsp/jstl/functions</a>	fn<br>2.2 Core标签使用<br>2.2.1 使用步骤<br>当前Web项目引入第三方jar包<br>当前JSP页面使用taglib指令引入core核心标签</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">  &lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Demo01<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>2.2.2 常用标签<br>标签		语法<br>c:if	相当于Java中的if(){}	&lt;c:if test&#x3D;”boolean值&gt;<br>true:显示标签体内容<br>false:隐藏标签体内容<br>注意:此标签没有else功能，需要使用就取反<br>c:forEach	1)普通for循环for(int i&#x3D;1;i&lt;&#x3D;5;i++){i}<br>&lt;c:forEach&gt;<br>begin&#x3D;”1”起始值(包含)<br>end&#x3D;”5”结束值(包含)<br>step&#x3D;”1”步长1<br>var&#x3D;”i” 当前输出临时变量</p>
<ol start="2">
<li>增强for循环 for(User user:list){user}	&lt;c:forEach items&#x3D;”${list}” var&#x3D;”user” varStatus&#x3D;”vs”&gt;<br>${user}<br><br>items&#x3D;”list” 集合<br>var&#x3D;”user” 当前输出的临时变量<br>varStatus&#x3D;”vs” 变量状态<br>index 当前索引 从0开始<br>count 计数器 从1开始<br>c:choose	相当于java中的switch语句	&lt;c:choose&gt;等价于switch<br>&lt;c:when&gt;等价于case+break<br>&lt;c:otherwise&gt;等价于default<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">  &lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Demo01<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;%</span></span><br><span class="line"><span class="language-xml">    User user = new User();</span></span><br><span class="line"><span class="language-xml">user.setUsername(&quot;Jack&quot;);</span></span><br><span class="line"><span class="language-xml">request.setAttribute(&quot;user&quot;,user);</span></span><br><span class="line"><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">&quot;$&#123;empty user&#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    Welcome ,Please Login</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">&quot;$&#123;not empty user&#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  Welcome, $&#123;user.username&#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">  &lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">    &lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo02&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3&gt;普通for循环&lt;/h3&gt;</span><br><span class="line">&lt;c:forEach begin=&quot;1&quot; end=&quot;5&quot; step=&quot;1&quot; var=&quot;i&quot;&gt;    &lt;%--for循环将临时变量存储到pageContext域空间--%&gt;</span><br><span class="line">    $&#123;i&#125;&lt;br&gt;</span><br><span class="line">      &lt;/c:forEach&gt;</span><br><span class="line"></span><br><span class="line">&lt;h3&gt;增强for循环&lt;/h3&gt;</span><br><span class="line">&lt;%</span><br><span class="line">      List list = new ArrayList();</span><br><span class="line">list.add(new User(&quot;A&quot;,1,&quot;F&quot;));</span><br><span class="line">list.add(new User(&quot;B&quot;,1,&quot;F&quot;));</span><br><span class="line">list.add(new User(&quot;C&quot;,1,&quot;M&quot;));</span><br><span class="line">list.add(new User(&quot;D&quot;,1,&quot;M&quot;));</span><br><span class="line">request.setAttribute(&quot;list&quot;,list);</span><br><span class="line">%&gt;&gt;</span><br><span class="line">  $&#123;requestScope.list&#125;</span><br><span class="line"></span><br><span class="line">&lt;c:forEach items=&quot;$&#123;list&#125;&quot; var=&quot;user&quot; varStatus=&quot;vs&quot;&gt;</span><br><span class="line">  索引:$&#123;vs.index&#125;&lt;br&gt;</span><br><span class="line">    计数器:$&#123;vs.count&#125;&lt;br&gt;</span><br><span class="line">      $&#123;user&#125;&lt;br&gt;</span><br><span class="line">        $&#123;user.username&#125;&lt;br&gt;</span><br><span class="line">          &lt;/c:forEach&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line">  &lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</span><br><span class="line">    &lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo03&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3&gt;Choose标签&lt;/h3&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    Integer money=30000;</span><br><span class="line">request.setAttribute(&quot;money&quot;,money);</span><br><span class="line">%&gt;</span><br><span class="line">  &lt;c:choose&gt;</span><br><span class="line">    &lt;c:when test=&quot;$&#123;money==7000&#125;&quot;&gt;AAA&lt;/c:when&gt;</span><br><span class="line">&lt;c:when test=&quot;$&#123;money==8000&#125;&quot;&gt;BBB&lt;/c:when&gt;</span><br><span class="line">&lt;c:when test=&quot;$&#123;money==9000&#125;&quot;&gt;CCC&lt;/c:when&gt;</span><br><span class="line">&lt;c:when test=&quot;$&#123;money==30000&#125;&quot;&gt;DDD&lt;/c:when&gt;</span><br><span class="line">&lt;c:otherwise&gt;</span><br><span class="line">  ZZZZZZ</span><br><span class="line">&lt;/c:otherwise&gt;</span><br><span class="line">&lt;/c:choose&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
三.三层架构<br>3.1 概述<br>通常意义上的三层架构就是将整个业务应用划分为:表示层、业务逻辑层、数据访问层<br>区分层次的目的为了高聚合低耦合思想<br>表示层:称为web层，与浏览器进行数据交互(控制器合视图)<br>业务逻辑层:又称为service层，处理业务数据(if判断，for循环)<br>数据访问(持久)层:称为Dao层，与数据库进行交互(每一条记录与JavaBean实体产生对应关系)</li>
</ol>
<p>包目录结构	<br>com.xxx	基本包(公司域名倒写)<br>com.xxx.dao	持久层<br>com.xxx.service	业务层<br>com.xxx.web	表示层<br>com.xxx.domain	实体(JavaBean)<br>com.xxx.util	工具<br>3.2 案例:用户信息列表显示<br>需求:MVC模式开发代码，完成用户显示列表功能。<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> List&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    list.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;A&quot;</span>,<span class="string">&quot;Male&quot;</span>,<span class="number">18</span>,<span class="string">&quot;NY&quot;</span>,<span class="string">&quot;123&quot;</span>,<span class="string">&quot;sd@qq.com&quot;</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;2&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;Female&quot;</span>,<span class="number">18</span>,<span class="string">&quot;NY&quot;</span>,<span class="string">&quot;234&quot;</span>,<span class="string">&quot;ad@qq.com&quot;</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;3&quot;</span>,<span class="string">&quot;C&quot;</span>,<span class="string">&quot;Male&quot;</span>,<span class="number">18</span>,<span class="string">&quot;NY&quot;</span>,<span class="string">&quot;345&quot;</span>,<span class="string">&quot;sv@qq.com&quot;</span>));</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;&#125;<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String SID;</span><br><span class="line">  <span class="keyword">private</span> String Name;</span><br><span class="line">  <span class="keyword">private</span> String Gender;</span><br><span class="line">  <span class="keyword">private</span> Integer Age;</span><br><span class="line">  <span class="keyword">private</span> String Address;</span><br><span class="line">  <span class="keyword">private</span> String QQ;</span><br><span class="line">  <span class="keyword">private</span> String EMAIL;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//此处省略无参、全参、toString，set/get</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="comment">//调用DAO，查询</span></span><br><span class="line">      <span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDao</span>();</span><br><span class="line">      List&lt;User&gt; list = userDao.findAll();</span><br><span class="line">      <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@WebServlet(&quot;/FindAllServlet&quot;)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FindAllServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">      <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">      <span class="comment">//调用Service查询</span></span><br><span class="line">      <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line">      List&lt;User&gt; list=userService.findAll();</span><br><span class="line">      <span class="comment">//将list存储到request域</span></span><br><span class="line">      req.setAttribute(<span class="string">&quot;list&quot;</span>,list);</span><br><span class="line">      <span class="comment">//转发list.jsp</span></span><br><span class="line">      req.getRequestDispatcher(<span class="string">&quot;/list.jsp&quot;</span>).forward(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;List&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;table border=<span class="string">&quot;1&quot;</span> cellpadding=<span class="string">&quot;0&quot;</span> cellspacing=<span class="string">&quot;0&quot;</span> width=<span class="string">&quot;500px&quot;</span> align=<span class="string">&quot;center&quot;</span>&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;编号&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;性别&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;年龄&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;地址&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;QQ&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;邮箱&lt;/th&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;c:forEach items=<span class="string">&quot;$&#123;list&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;user&quot;</span>&gt;</span><br><span class="line">        &lt;tr align=<span class="string">&quot;center&quot;</span>&gt;</span><br><span class="line">          &lt;td&gt;$&#123;user.SID&#125;&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;$&#123;user.name&#125;&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;$&#123;user.gender&#125;&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;$&#123;user.age&#125;&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;$&#123;user.address&#125;&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;$&#123;user.QQ&#125;&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;$&#123;user.EMAIL&#125;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">      &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/18/Java-Web-Session/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/18/Java-Web-Session/" class="post-title-link" itemprop="url">Java Web - Session</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-18 01:22:35" itemprop="dateCreated datePublished" datetime="2020-04-18T01:22:35+08:00">2020-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.Session<br>1.1 概述<br>1.2 快速入门<br>HttpSession也是一个对象</p>
<p>说明	API<br>存储数据	void setAttribute(String name,Object value)<br>获取数据	Object getAttribute(String name)<br>删除数据	void removeAttribute(String name)<br>步骤分析</p>
<p>将数据存储到session中</p>
<p>说明	API<br>通过request对象，获取session对象	HttpSession session &#x3D; req.getSession();<br>操作session的API，存储数据	session.setAttribute(“username”,”AAABBBCCCC”);<br>从session中获取数据<br>说明	API<br>通过request对象，获取session对象	HttpSession session &#x3D; req.getSession();<br>操作session的API，获取数据	session.getAttribute(“username”);</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/SetSession&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SetSession</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//通过request对象，获取session对象</span></span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">    <span class="comment">//操作session的API，存储数据</span></span><br><span class="line">    session.setAttribute(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;AAABBBCCCC&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/GetSession&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GetSession</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//通过request对象，获取session对象</span></span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">    <span class="comment">//操作session的API，获取数据</span></span><br><span class="line">    <span class="type">String</span>  <span class="variable">username</span> <span class="operator">=</span> (String) session.getAttribute(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;GetSession:&quot;</span>+username);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.3 工作原理<br>Session基于Cookie技术实现<br>HttpSession session &#x3D; req.getSession();<br>如果用户是第一次访问:表示创建Session对象，生成编号<br>如果用户是第N次访问，根据浏览器携带编号找session对象</p>
<p>1.4 Session细节<br>1.4.1 客户端关闭，服务器不关闭，两次获取的Session数据是否相同<br>默认情况下，浏览器关闭再打开，两次获取的Session不同(基于cookie实现，浏览器关闭，cookie销毁)<br>设置cookie的存活时间(JESSIONID)，代替服务器，覆盖JESSIONID，指定持久化时间</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/SessionDemo01&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SessionDemo01</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//指定JESSIONID时间</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//获取session对象</span></span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">    <span class="comment">//向session中存数据</span></span><br><span class="line">    session.setAttribute(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;zZZ&quot;</span>);</span><br><span class="line">    <span class="comment">//获取SESSION 的唯一编号</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> session.getId();</span><br><span class="line">    <span class="comment">//设置cookie时长</span></span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;JESSIONID&quot;</span>, id);</span><br><span class="line">    <span class="comment">//设置存活时间</span></span><br><span class="line">    cookie.setMaxAge(<span class="number">60</span>*<span class="number">2</span>);</span><br><span class="line">    <span class="comment">//当前项目下共享</span></span><br><span class="line">    cookie.setPath(req.getContextPath());</span><br><span class="line">    <span class="comment">//response响应cookie</span></span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.4.2 客户端不关闭，服务器关闭，两次获取的Session数据是否相同<br>当服务器正常关闭，重启后，两次获取的session数据一样<br>Tomcat实现了以下功能<br>钝化(序列化):当服务器正常关闭时,session中当数据，会序列化到磁盘<br>活化(反序列化):当服务器开启后，从磁盘中读取文件，反序列化到内存中<br>1.4.3 生命周期<br>何时创建</p>
<p>用户第一次调用req.getAttribute()时，创建<br>何时销毁</p>
<p>服务器非正常关闭<br>非活跃状态30分钟后销毁(tomcat&#x2F;conf&#x2F;web.xml官方已配置)<br>session.invalidate();立即销毁<br>作用范围</p>
<p>一次会话中，多次请求之间<br>注意:每一个浏览器和服务器之间都是独立的会话<br>1.4.4 URL重写<br>Session基于Cookie技术实现；浏览器Cookie可以禁用，一旦禁用，Session会出现问题<br>开发中，一般不考虑禁用Cookie用户</p>
<p>如果真要处理，可以使用URL重写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/SessionDemo02&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SessionDemo02</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//获取session对象</span></span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">    <span class="comment">//向session中存数据</span></span><br><span class="line">    session.setAttribute(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;SIODJOISDJSO&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义URL</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;/Day37_war_exploded/GetSession&quot;</span>;</span><br><span class="line">    <span class="comment">//重写URL，拼接JESSIONID</span></span><br><span class="line">    url = resp.encodeURL(url);</span><br><span class="line"></span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;&lt;a href&#x27;&quot;</span> + url + <span class="string">&quot;&#x27;&gt;Direct to get Session&lt;/a&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.5 Session特点<br>session存储数据在服务器<br>session存储类型任意(Object)<br>session存储大小和数据没有限制(相对于内存)<br>session存储数据相对安全<br>cookie和session的选择</p>
<p>cookie将数据保存在浏览器端，数据相对不安全，建议敏感数据不要放在cookie中，且数据大小有限制<br>成本低，对服务器要求不高<br>浏览器为了解决该不足，前端使用了localStroage</p>
<p>session将数据保存在服务器端，数据相对安全，数据大小比cookie中灵活<br>成本较高，对服务器压力大</p>
<p>二. 三大域对象总结<br>request,session,ServletContext</p>
<p>2.1 API<br>设置数据	void setAttribute(String name,Object o)<br>获取数据	Object getAttribute(String name)<br>删除数据	void removeAttribute(String name)<br>2.2 生命周期<br>2.2.1 ServleetContext域对象<br>何时创建	服务器正常启动，项目加载时创建<br>何时销毁	服务器关闭或项目卸载时，卸载<br>作用范围	整个web项目(共享数据)<br>2.2.2 HttpSession域对象<br>何时创建	用户第一次调用req.getSession() 方法时创建<br>用户访问携带的JESSIONID与服务器不匹配时创建<br>何时销毁	服务器非正常关闭时<br>未活跃时间30 min<br>session.invalidate();立即销毁<br>作用范围	一次会话中，多次请求间(共享数据)<br>2.2.3 HttpServletRequest域对象<br>何时创建	用户发送请求时创建<br>何时销毁	服务器做出响应后销毁<br>作用范围	一次请求中，多次转发间(共享数据)<br>2.3 小结<br>能用小的不用大的:request&lt;session&lt;servletContext</p>
<p>常用场景</p>
<p>request	一次查询的结果 (servlet转发jsp)<br>session	存放当前会话的私有数据<br>(验证码、购物车、等)<br>servletContext:若需要所有的Servlet都能访问到，才使用这个域对象</p>
<p>三.综合案例<br>3.1 商品购物车<br>3.1.1 需求分析<br>addCatrSetvlet</p>
<p>1.获取请求参数name(product)<br>2.返回:product 商品已加入购物车<br>3.从session中获取购物车<br>4.如果购物车为空，创建cart &#x3D; new HashMap()<br>5.判断，此商品是否存在于购物车<br>6.不存在，添加商品数量1<br>7.存在，在原商品基础上+1<br>8.将购物车重写到session中</p>
<p>cart.jsp</p>
<p>1.从session中获取购物车对象<br>2.判断是否为空<br>3.如果空，显示购物车空<br>4.如果不为空，遍历展示商品和数量</p>
<p>3.1.2 代码实现<br>goods.jsp<br>addCartServlet<br>cart.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;Goods&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">  &lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h3&gt;商品列表&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">    &lt;a href=<span class="string">&quot;/Day37_war_exploded/AddCartServlet?name=TV&quot;</span>&gt;TV,add to cart&lt;/a&gt;&lt;br&gt;</span><br><span class="line">    &lt;a href=<span class="string">&quot;/Day37_war_exploded/AddCartServlet?name=PC&quot;</span>&gt;PC,add to cart&lt;/a&gt;&lt;br&gt;</span><br><span class="line">    &lt;a href=<span class="string">&quot;/Day37_war_exploded/AddCartServlet?name=Phone&quot;</span>&gt;Phone,add to cart&lt;/a&gt;&lt;br&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>





<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/AddCartServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AddCartServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//设置编码</span></span><br><span class="line">    req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取请求参数</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">product</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    resp.getWriter().write(product + <span class="string">&quot;, has add to Cart&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从session中获取购物车</span></span><br><span class="line">    Map&lt;String, Integer&gt; cart = (Map&lt;String, Integer&gt;) req.getSession().getAttribute(<span class="string">&quot;cart&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断购物车是否为空</span></span><br><span class="line">    <span class="keyword">if</span> (cart == <span class="literal">null</span>) &#123;</span><br><span class="line">      cart = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断购物车中是否包含本次商品</span></span><br><span class="line">    <span class="keyword">if</span> (cart.containsKey(product)) &#123;</span><br><span class="line">      <span class="comment">//存在,product++</span></span><br><span class="line">      <span class="type">Integer</span> <span class="variable">oldCount</span> <span class="operator">=</span> cart.get(product);<span class="comment">//之前的数量</span></span><br><span class="line">      cart.put(product, ++oldCount);<span class="comment">//数量加一</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//不存在 ,加入购物车</span></span><br><span class="line">      cart.put(product, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//重新将购物车写入到session中</span></span><br><span class="line">    req.getSession().setAttribute(<span class="string">&quot;cart&quot;</span>, cart);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//继续浏览</span></span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;&lt;br&gt;&lt;a href=&#x27;/Day37_war_exploded/goods.jsp&#x27;&gt;Continue View&lt;/a&gt;&lt;br&gt;&quot;</span>);</span><br><span class="line">    <span class="comment">//查看购物车</span></span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;&lt;br&gt;&lt;a href=&#x27;/Day37_war_exploded/cart.jsp&#x27;&gt;Check Shopping Cart&lt;/a&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>Product<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>Quantity<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  &lt;%</span><br><span class="line">     //从session中获取购物车</span><br><span class="line">     Map&lt;String, Integer&gt; cart = (Map&lt;String, Integer&gt;) request.getSession().getAttribute(&quot;cart&quot;);</span><br><span class="line">  //判断是否为空</span><br><span class="line">  if (cart == null) &#123;</span><br><span class="line">  out.write(&quot;No Product here<span class="tag">&lt;<span class="name">br</span>&gt;</span>&quot;);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">  for (String product : cart.keySet()) &#123;</span><br><span class="line">  out.write(&quot;<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>&quot; + product + &quot;<span class="tag">&lt;/<span class="name">td</span>&gt;</span>  <span class="tag">&lt;<span class="name">td</span>&gt;</span>&quot; + cart.get(product) + &quot;<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>/&gt;</span>&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  %&gt;</span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;/Day37_war_exploded/goods.jsp&#x27;</span>&gt;</span>Continue View<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>3.2 用户登陆(验证码)<br>3.2.1 需求分析<br>3.2.2 代码实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/LoginServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//课下作业实现非空判断</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">    <span class="comment">//获取用户输入验证码</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">checkcode</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;checkcode&quot;</span>);</span><br><span class="line">    <span class="comment">//获取session验证码</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">codeSession</span> <span class="operator">=</span> (String) req.getSession().getAttribute(<span class="string">&quot;code_session&quot;</span>);</span><br><span class="line">    <span class="comment">//校验匹配</span></span><br><span class="line">    <span class="keyword">if</span> (!checkcode.equalsIgnoreCase(codeSession)) &#123;</span><br><span class="line">      <span class="comment">//验证码不匹配提示</span></span><br><span class="line">      req.setAttribute(<span class="string">&quot;Error&quot;</span>, <span class="string">&quot;Check Code Wrong&quot;</span>);</span><br><span class="line">      <span class="comment">//转发到login.jsp</span></span><br><span class="line">      req.getRequestDispatcher(<span class="string">&quot;/login.jsp&quot;</span>).forward(req, resp);</span><br><span class="line">      <span class="comment">//代码不再向下执行</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取用户输入到用户名和密码</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断用户名密码</span></span><br><span class="line">    <span class="keyword">if</span> (!(<span class="string">&quot;jack&quot;</span>.equals(username) &amp;&amp; <span class="string">&quot;123&quot;</span>.equals(password))) &#123;</span><br><span class="line">      <span class="comment">//用户名密码不匹配提示</span></span><br><span class="line">      req.setAttribute(<span class="string">&quot;Error&quot;</span>, <span class="string">&quot;Username or Password Wrong&quot;</span>);</span><br><span class="line">      <span class="comment">//转发到login.jsp</span></span><br><span class="line">      req.getRequestDispatcher(<span class="string">&quot;/login.jsp&quot;</span>).forward(req, resp);</span><br><span class="line">      <span class="comment">//代码不再向下执行</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将用户名存入session</span></span><br><span class="line">    req.getSession().setAttribute(<span class="string">&quot;username&quot;</span>, username);</span><br><span class="line">    <span class="comment">//重定向到Succes.jsp</span></span><br><span class="line">    resp.sendRedirect(req.getContextPath() + <span class="string">&quot;/success.jsp&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;/war_exploded/LoginServlet&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">  <span class="title class_">Name</span>: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="line">    Password: &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="line">      Checkcode: &lt;input type=&quot;text&quot; name=&quot;checkcode&quot;&gt;&lt;img src=&quot;/Day37_war_exploded/CheckCodeServlet&quot; id=&quot;image1&quot;</span><br><span class="line">alt=&quot;&quot;&gt;&lt;br&gt;</span><br><span class="line">  &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;</span><br><span class="line">    &lt;span style=&quot;color: red&quot;&gt;</span><br><span class="line">      &lt;%</span><br><span class="line">      String error = (String) request.getAttribute(&quot;Error&quot;);</span><br><span class="line">if (error != null) &#123;</span><br><span class="line">  out.write(error);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/span&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  document.getElementById(&quot;image1&quot;).onclick = function () &#123;</span><br><span class="line">  this.src = &#x27;/Day37_war_exploded/CheckCodeServlet?&#x27; + new Date().getTime();</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line">  &lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">  &lt;title&gt;Success&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;%</span><br><span class="line">  //获取用户信息</span><br><span class="line">  String username = (String) request.getSession().getAttribute(&quot;username&quot;);</span><br><span class="line">if (username != null)&#123;</span><br><span class="line">  out.write(&quot;Welcome ,&quot;+username);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>总结<br>概述<br>在一次会话的多次请求之间共享数据，将数据保存到服务器端<br>实现原理<br>基于Cookie技术<br>jsessionid&#x3D;xxxx<br>常用方法<br>获取session<br>request.getSession()<br>使用session<br>setAttribute()<br>getAttribute()<br>remomveAttribute()<br>生命周期<br>何时创建<br>用户第一次执行getSession()方法时，创建<br>用户携带的jssionid与服务器不匹配时，创建<br>何时销毁<br>服务器非正常关闭时<br>session.invalidate()<br>session默认销毁时间30分钟</p>
<p>tomcat目录&#x2F;conf&#x2F;web.xm<br>作用范围<br>一次会话中，多次请求之间<br>特点</p>
<ol>
<li>session在服务器端存储数据</li>
<li>session存储数据格式可以是任意类型</li>
<li>session存储数据没有大小限制（相对于内存）</li>
<li>session存储数据相对安全<br>三个域对象<br>ServletContext<br>创建<br>销毁<br>作用域<br>HttpSession<br>创建<br>销毁<br>作用域<br>HttpServletRequest<br>创建<br>销毁<br>作用域<br>综合案例<br>商品购物车<br>用户登录（验证码）</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/18/Cookie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/18/Cookie/" class="post-title-link" itemprop="url">Cookie</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-18 01:21:57" itemprop="dateCreated datePublished" datetime="2020-04-18T01:21:57+08:00">2020-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.会话概述<br>1.1 什么是会话<br>http协议是一个无状态协议，同一会话的多次请求相互独立，会话负责存储浏览器和服务器多次请求之间的数据</p>
<p>1.2 会话技术<br>客户端会话技术:Cookie<br>服务端会话技术:Session</p>
<p>二.Cookie<br>2.1 概述<br>作用:在一次会话的多个请求之间共享数据,将数据保存到客户端</p>
<p>2.2 快速入门<br>2.2.1 设置数据到Cookie中<br>创建cookie对象，设置数据<br>Cookie cookie &#x3D; new Cookie(String name,String value);<br>通过response,响应(返回)cookie<br>response.addCookie(cookie);<br>2.2.2 从cookie中获取数据<br>通过request对象，接收cookie数组<br>Cookie[] cookies &#x3D; request.getCookies()<br>遍历数组<br>for(Cookie cookie:cookies){<br>}</p>
<p>浏览器具有自动存储cookie的能力，也有请求携带cookie的能力</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/SetServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SetServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/GetServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GetServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//通过request对象，接收cookie数组</span></span><br><span class="line">    Cookie[] cookies = req.getCookies();</span><br><span class="line">    <span class="keyword">if</span> (cookies != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="comment">//遍历数组</span></span><br><span class="line">      <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> cookie.getName();</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> cookie.getValue();</span><br><span class="line">        System.out.println(name+<span class="string">&quot;=&quot;</span>+value);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.3 工作原理<br>基于HTTP协议:请求头cookie和响应头set-cookie</p>
<p>2.4 Cookie细节<br>2.4.1 服务器如何发送多个Cookie<br>创建多个cookie对象<br>Cookie cookie1 &#x3D; new Cookie(“name”,”rose”);<br>Cookie cookie2 &#x3D; new Cookie(“age”,”18”);</p>
<p>通过response响应多个cookie<br>response.addCookie(cookie1);<br>response.addCookie(cookie2);</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/MultipleCookie&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MultipleCookie</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;rose&quot;</span>);</span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">age</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;18&quot;</span>);</span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line">    resp.addCookie(age);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>}<br>2.4.2 Cookie在浏览器的保存时间<br>默认情况下，浏览器关闭(会话结束),cookie销毁(浏览器内存中存储)<br>设置Cookie的存活时间<br>cookie.setMaxAge(int second);<br>正数:指定存活时间，持久化浏览器的磁盘中，到期后自动销毁<br>负数:默认浏览器关闭，cookie销毁<br>零:立即销毁</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/MaxAgeCookie&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MaxAgeCookie</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//创建Cookie对象</span></span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;product&quot;</span>, <span class="string">&quot;MI&quot;</span>);</span><br><span class="line">    <span class="comment">//设置Cookie的存活时间,默认值-1，关闭自动销毁</span></span><br><span class="line">    <span class="comment">//        cookie.setMaxAge(-1);</span></span><br><span class="line">    <span class="comment">//设定30s，自动销毁</span></span><br><span class="line">    <span class="comment">//        cookie.setMaxAge(30);</span></span><br><span class="line">    <span class="comment">//立即销毁</span></span><br><span class="line">    cookie.setMaxAge(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">//resp响应Cookie</span></span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.4.3 Cookie是否支持中文存储<br>Tomcat 8版本开始支持中文</p>
<p>但是不支持部分特殊字符，如:分号，空格，逗号等，会触发Rfc6265 CookieProcessor规范错误</p>
<p>建议使用通用方法存储字符<br>URLEncoder 编码<br>URLDecoder 解码</p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/EncodeCookie&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EncodeCookie</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">product</span> <span class="operator">=</span> (<span class="string">&quot;华为 30X,&quot;</span>);</span><br><span class="line">    product= URLEncoder.encode(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;Brand&quot;</span>, <span class="string">&quot;苹果&quot;</span>);</span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;product&quot;</span>, product);</span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line">  &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/GetServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GetServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//通过request对象，接收cookie数组</span></span><br><span class="line">    Cookie[] cookies = req.getCookies();</span><br><span class="line">    <span class="keyword">if</span> (cookies != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="comment">//遍历数组</span></span><br><span class="line">      <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> cookie.getName();</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> cookie.getValue();</span><br><span class="line">        <span class="comment">//解码</span></span><br><span class="line">        value = URLDecoder.decode(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        System.out.println(name + <span class="string">&quot;=&quot;</span> + value);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>2.4.4 Cookie共享数据的范围<br>2.4.4.1 同一个Tomcat服务器中，部署多个web项目，能否共享Cookie<br>默认情况下不可以<br>默认Cookie的携带路径，是当前设置cookie的servlet父路径</p>
<p>设置Cookie:<a target="_blank" rel="noopener" href="http://localhost:8080/Day36_war_exploded/EncodeCookie">http://localhost:8080/Day36_war_exploded/EncodeCookie</a><br>默认携带路径:<a target="_blank" rel="noopener" href="http://localhost:8080/Day36_war_exploded/">http://localhost:8080/Day36_war_exploded/</a></p>
<p>指定Cookie携带路径<br>cookie.setPath(String Path);<br>例:cookie.setPath(“&#x2F;“);</p>
<p>&#x2F; 相当于<a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080/</a></p>
<p>此cookie携带路径</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080/</a></p>
<p>访问:</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/Day36_war_exploded/">http://localhost:8080/Day36_war_exploded/</a><br><a target="_blank" rel="noopener" href="http://localhost:8080/Day35_war_exploded/">http://localhost:8080/Day35_war_exploded/</a></p>
<p>携带路径不同，可以存储同名的cookie</p>
<p>在当前项目下共享cookie方法<br>cookie.setPath(“&#x2F;项目名”);</p>
<p>2.4.4.2 不同Tomcat服务器之间的Cookie能否共享<br>默认情况下不可以<br>多个服务器之间的数据共享cookie，需要在同一个一级域名下<br>cookie.setDomain(“.xx.com”)<br>2.5 Cookie特点<br>Cookie存储的数据都在客户端<br>Cookie存储的数据只能是字符串<br>Cookie单个大学不能超过4kb<br>同一个域名下Cookie的数量不能超过50个<br>Cookie路径不同，可以重名出现<br>Cookie存储数据不太安全<br>三.综合案例<br>3.1 用户上次访问记录<br>需求:访问一个Servlet，如果是第一次访问，则提示:”您好”，如果不是，则提示”上次访问时间”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CookieUtils</span> &#123;</span><br><span class="line">  <span class="comment">//根据指定名称，查找cookie对象</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> Cookie <span class="title function_">findByName</span><span class="params">(String name, Cookie[] cookies)</span> &#123;</span><br><span class="line">    <span class="comment">//非空判断</span></span><br><span class="line">    <span class="keyword">if</span> (cookies != <span class="literal">null</span> &amp;&amp; cookies.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">//遍历</span></span><br><span class="line">      <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">        <span class="comment">//判断是否有指定名称的cookie</span></span><br><span class="line">        <span class="keyword">if</span> (name.equals(cookie.getName())) &#123;</span><br><span class="line">          <span class="keyword">return</span> cookie;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@WebServlet(&quot;/LastTimeServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LastTimeServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">    <span class="comment">//接收cookie数组，取出指定名称cookie对象</span></span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> CookieUtils.findByName(<span class="string">&quot;last_time&quot;</span>, req.getCookies());</span><br><span class="line">    <span class="comment">//判断</span></span><br><span class="line">    <span class="keyword">if</span> (cookie == <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="comment">//不存在</span></span><br><span class="line">      resp.getWriter().write(<span class="string">&quot;Welcome&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//存在</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> cookie.getValue();</span><br><span class="line">      resp.getWriter().write(<span class="string">&quot;Welcome Back,Last Visit Time:&quot;</span> + value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建cookie对象,记录本次访问时间</span></span><br><span class="line">    <span class="type">SimpleDateFormat</span> <span class="variable">simpleDateFormat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyyMMdd-HH:mm:ss&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">currentTime</span> <span class="operator">=</span> simpleDateFormat.format(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    cookie = <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;last_time&quot;</span>, currentTime);</span><br><span class="line">    <span class="comment">//设置cookie存活1年</span></span><br><span class="line">    cookie.setMaxAge(<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">365</span>);</span><br><span class="line">    <span class="comment">//resp响应cookie</span></span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.2 JSP初体验<br>Java服务端页面<br>简单来说:一个特殊的页面，即可定义html标签，又可定义Java代码<br>作用:简化书写，展示动态页面<br>本质:Servlet<br>脚本:JSP通过脚本方式来定义Java代码<br>&lt;% Java代码 %&gt; 就相当于Servlet中service方法</p>
<p>内置对象:在JSP页面中不需要获取和创建，可以直接使用对象<br>request<br>response<br>out<br>在JSP中响应内容，使用out<br>tomcat优先解析response缓冲区内容，再解析out缓冲区内容</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Demo&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h3&gt;I am Title&lt;/h3&gt;</span><br><span class="line">&lt;table border=<span class="string">&quot;1&quot;</span> width=<span class="string">&quot;300&quot;</span> align=<span class="string">&quot;center&quot;</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;I am <span class="keyword">static</span> resource&lt;/td&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;%</span><br><span class="line"><span class="comment">//    response.getWriter().write(&quot;I am JSP&quot;);</span></span><br><span class="line">    System.out.println(<span class="string">&quot;I am jsp&quot;</span>);</span><br><span class="line">    out.write(<span class="string">&quot;Out&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>3.3 商品浏览记录</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">  &lt;h3&gt;List&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">  &lt;a href=<span class="string">&quot;/Day36_war_exploded/GoodsInfoServlet?name=MI&quot;</span>&gt;MI&lt;/a&gt;&lt;br&gt;</span><br><span class="line">  &lt;a href=<span class="string">&quot;/Day36_war_exploded/GoodsInfoServlet?name=HW&quot;</span>&gt;HW&lt;/a&gt;&lt;br&gt;</span><br><span class="line">  &lt;a href=<span class="string">&quot;/Day36_war_exploded/GoodsInfoServlet?name=Apple&quot;</span>&gt;Apple&lt;/a&gt;&lt;br&gt;</span><br><span class="line">  &lt;a href=<span class="string">&quot;/Day36_war_exploded/GoodsInfoServlet?name=TCL&quot;</span>&gt;TCL&lt;/a&gt;&lt;br&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;%</span><br><span class="line">  <span class="comment">//Java Code</span></span><br><span class="line">  <span class="comment">//获取指定名称的Cookie对象</span></span><br><span class="line">  <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> CookieUtils.findByName(<span class="string">&quot;goods_name&quot;</span>, request.getCookies());</span><br><span class="line">  <span class="comment">//判断是否存在浏览记录</span></span><br><span class="line">  <span class="keyword">if</span> (cookie == <span class="literal">null</span>) &#123;</span><br><span class="line">    out.write(<span class="string">&quot;No History&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//格式:MI-Apple..</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> cookie.getValue();</span><br><span class="line">    <span class="keyword">for</span> (String product : value.split(<span class="string">&quot;-&quot;</span>)) &#123;</span><br><span class="line">      out.write(product + <span class="string">&quot;&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  %&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/GoodsInfoServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GoodsInfoServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//设置请求的解码方式</span></span><br><span class="line">    req.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">    <span class="comment">//获取请求参数name</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">product</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    <span class="comment">//展示当前商品详情</span></span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;It&#x27;s &quot;</span> + product);</span><br><span class="line">    <span class="comment">//获取指定名称的Cookie对象</span></span><br><span class="line">    <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> CookieUtils.findByName(<span class="string">&quot;goods_name&quot;</span>, req.getCookies());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cookie == <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="comment">//如果不存在，将当前商品设置到cookie中</span></span><br><span class="line">      cookie = <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;goods_name&quot;</span>, product);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//如果存在，将浏览记录取出</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> cookie.getValue();</span><br><span class="line">      <span class="comment">//判断当前商品是否在此Cookie中</span></span><br><span class="line">      List&lt;String&gt; list = Arrays.asList(value.split(<span class="string">&quot;-&quot;</span>));</span><br><span class="line">      <span class="comment">//如果不包含，追加，如果包含，不操作</span></span><br><span class="line">      <span class="keyword">if</span> (!list.contains(product)) &#123;</span><br><span class="line">        value=value+<span class="string">&quot;-&quot;</span>+product;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//将value重置到Cookie中</span></span><br><span class="line">      cookie = <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;goods_name&quot;</span>, value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//通过response响应到浏览器</span></span><br><span class="line">    cookie.setMaxAge(<span class="number">10</span>);</span><br><span class="line">    resp.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//制作a标签，实现继续浏览商品功能</span></span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;&lt;br/&gt;&lt;a href=&#x27;/Day36_war_exploded/goods.html&#x27;&gt;Continue View&lt;/a&gt;&lt;br/&gt;&quot;</span>);</span><br><span class="line">    <span class="comment">//制作a标签，实现查看浏览记录功能</span></span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;&lt;a href=&#x27;/Day36_war_exploded/history.jsp&#x27;&gt;History&lt;/a&gt;&lt;br/&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/16/Java-Web-ServletContext-Response/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/16/Java-Web-ServletContext-Response/" class="post-title-link" itemprop="url">Java Web - ServletContext & Response</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-16 01:19:47" itemprop="dateCreated datePublished" datetime="2020-04-16T01:19:47+08:00">2020-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.ServletContext<br>1.1 概述<br>ServletContext是一个容器(域对象)可以存储键值对数据(String key,Object value)，保存在ServletContext中的 数据不仅可以提供给所有的servlet使用，而且可以在整个项目范围内使用。</p>
<p>它的主要作用有3个:<br>作为域对象<br>可以获取当前应用下任何路径下的任何资源<br>获取初始化参数<br>获取文件MIME类型</p>
<p>1.2 域对象<br>说明	API<br>往servletcontext容器中存入数据，name为数据名称，object为数据的值	void setAttribute(String name,Object object)<br>从ServletContext中获取数据，根据指定的数据名称	Object getAttribute(String name)<br>从ServletContext中移除数据，根据指定的数据名称	void removeAttribute(String name)<br>生命周期<br>何时创建:项目加载时创建<br>何时销毁:项目卸载时销毁<br>作用范围:整个项目(多个Servlet都可以使用它)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>@WebServlet(“&#x2F;OneServlet”)<br>public class OneServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    //向ServletContext域存储数据
    ServletContext sc1 = req.getServletContext();
    ServletContext sc2 = getServletContext();
    sc1.setAttribute(&quot;user&quot;,&quot;jack&quot;);
    resp.getWriter().write(&quot;Set Message&quot;);
&#125;
</code></pre>
<p>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>@WebServlet(“&#x2F;TwoServlet”)<br>public class TwoServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    //从ServletContext域存储数据
    String user = (String) req.getServletContext().getAttribute(&quot;user&quot;);
    resp.getWriter().write(&quot;Get Message:&quot;+user);
&#125;
</code></pre>
<p>}<br>1.3 获取资源在服务器的真实地址<br>可以实现Web项目的移植性，动态获取文件真实路径<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>@WebServlet(“&#x2F;RealPath”)<br>public class RealPath extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    //获取web.xml文件真实路径
    String realPath = req.getServletContext().getRealPath(&quot;/WEB-INF/web.xml&quot;);
    resp.getWriter().write(realPath);
&#125;
</code></pre>
<p>}<br>1.4 获取全局的配置函数<br>读取web.xml配置文件中<context-param>标签,实现参数和代码的解耦(多个Servlet可以获取)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>@WebServlet(“&#x2F;ContextPath”)<br>public class ContextPath extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</context-param></p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    //获取全局参数
    String value = req.getServletContext().getInitParameter(&quot;encode&quot;);
    System.out.println(value);
    resp.getWriter().write(value);
&#125;
</code></pre>
<p>}<br>1<br>2<br>3<br>4<br>5</p>
<!--   全局配置参数：所有Servlet都可以读取    -->
<context-param>
    <param-name>encode</param-name>
    <param-value>UTF-8</param-value>
</context-param>
1.5 获取文件MIME类型
互联网通信中的一种数据类型
格式:大类型/小类型
例如:text/html image/jpeg

<p>1<br><a href="/Day35_war_exploded/MIMEServlet?filename=a.jpeg">Get MIME</a><br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>@WebServlet(“&#x2F;MIMEServlet”)<br>public class MIMEServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    //获取请求参数
    String filename = req.getParameter(&quot;filename&quot;);
    //获取指定文件的mime类型
    String mimeType = req.getServletContext().getMimeType(filename);
    resp.getWriter().write(filename+&quot;=&quot;+mimeType);
&#125;
</code></pre>
<p>}<br>1.6 案例:统计网站的访问次数<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>@WebServlet(value &#x3D; “&#x2F;CountServlet”,loadOnStartup &#x3D; 4)&#x2F;&#x2F;服务器启动时，创建此servlet对象<br>public class CountServlet extends HttpServlet {<br>    @Override<br>    public void init() throws ServletException {<br>        getServletContext().setAttribute(“count”,0);<br>    }</p>
<pre><code>@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    this.doPost(req, resp);
&#125;

@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    //设置response响应编码
    resp.setContentType(&quot;text/html;charset=utf-8&quot;);
    resp.getWriter().write(&quot;&lt;h1&gt;Welcome&lt;/h1&gt;&quot;);

    //用户每次访问,从域中取出，++再存入
    Integer count = (Integer) req.getServletContext().getAttribute(&quot;count&quot;);
    count++;
    getServletContext().setAttribute(&quot;count&quot;, count);

    resp.getWriter().write(&quot;&lt;div&gt;You are the &quot;+count+&quot; visitor&lt;/div&gt;&quot;);
&#125;
</code></pre>
<p>}<br>二.Response<br>2.1 概述<br>response对象表示web服务器给浏览器返回的响应信息</p>
<p>作用:开发人员可以使用response对象方法,设置要返回给浏览器的响应信息</p>
<p>Response体系结构</p>
<p>ServletResponse<br>⬆<br>HttpServletResponse<br>⬆<br>org.apache.catalina.connector.ResponseFacade 实现类(由Tomcat提供)<br>2.2 设置Http响应消息<br>2.2.1 响应行<br>格式<br>协议&#x2F;版本号 状态码<br>例如<br>HTTP&#x2F;1.1 200<br>API<br>说明	API<br>设置状态码	void setStatus()<br>2.2.2 响应头<br>格式<br>响应头名称:响应头的值<br>例如<br>Location:<a target="_blank" rel="noopener" href="http://www.oracle.com/">http://www.oracle.com</a><br>API<br>说明	API<br>设置指定头名称和对应的值	void setHeader(String name,String vale);<br>2.2.3 响应体<br>API(输出流对象)<br>说明	API<br>字符输出流	PrintWriter getWriter()<br>字节输出流	ServletOutputStream getOutputStream()<br>注意:在同一个Servlet中，不能同时存在两种流，互斥</p>
<p>2.3 响应重定向<br>2.3.1 重定向特点<br>地址栏会发生改变<br>重定向是二次请求<br>重定向是客户端(浏览器)行为,可以跳转到服务器外部资源<br>不能使用request域共享数据<br>2.3.2 方式一<br>说明	API<br>设置状态码	response.setStatus(302)<br>设置响应头Location	response.setHeader(“Location”,”重定向网络地址”);<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>@WebServlet(“&#x2F;AServlet”)<br>public class AServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    System.out.println(&quot;AServlet Run&quot;);
   resp.setStatus(302);
   resp.setHeader(&quot;Location&quot;,&quot;/Day35_war_exploded/BServlet&quot;);
&#125;
</code></pre>
<p>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>@WebServlet(“&#x2F;BServlet”)<br>public class BServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    System.out.println(&quot;Bservlet Run&quot;);
&#125;
</code></pre>
<p>}<br>2.3.3 方式二<br>说明	API<br>response专门处理重定向的方法	response.sendRedirect(“重定向网络地址”)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>@WebServlet(“&#x2F;AServlet”)<br>public class AServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    System.out.println(&quot;AServlet Run&quot;);
    resp.sendRedirect(&quot;http://www.baidu.com&quot;);
&#125;
</code></pre>
<p>}<br>2.3.4 转发与重定向区别<br>哪个对象<br>API<br>转发(request对象的方法)	request.getRequestDispatcher(“&#x2F;bServlet”).forward(request,response);<br>重定向(response对象的方法)	response.sendRedirect(“&#x2F;Day35_war_exploded&#x2F;bServlet”);<br>几次请求<br>转发	重定向<br>地址栏	没有改变	发生了改变<br>浏览器	发了一次请求	发了两次请求<br>服务器	只有一对请求和响应对象	有两对请求和响应对象<br>发生的位置	服务器	浏览器<br>小结<br>写法	说明<br>转发	(“&#x2F;servlet资源路径”) 服务器内部行为<br>重定向	(“&#x2F;虚拟路径(项目名)&#x2F;servlet资源路径”) 浏览器外部行为<br>使用场景</p>
<p>使用场景	说明<br>如果需要传递数据(request域)	使用转发<br>如果不需要传递数据(request域)	使用重定向<br>2.4 响应定时刷新<br>说明	API<br>通过response设置响应头Refresh	response.setHeader(“Refresh”,”间隔时间(秒);跳转页面”)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>@WebServlet(“&#x2F;RefreshServlet”)<br>public class RefreshServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    resp.setHeader(&quot;Refresh&quot;,&quot;3;http://www.baidu.com&quot;);
    resp.setContentType(&quot;text/html;charset=utf-8&quot;);
    resp.getWriter().write(&quot;Success,Redirect After 3 seconds&quot;);
&#125;
</code></pre>
<p>}<br>2.5 响应中文<br>步骤:</p>
<p>说明	API<br>统一服务器编码:指定服务器响应编码方式	resp.setContentType(“text&#x2F;html;charset&#x3D;utf-8”);<br>通过response获取字符输出流	PrintWriter pw &#x3D; response.getWriter();<br>通过字符输出流输出文本	pw.write()<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>@WebServlet(“&#x2F;EncodeServlet”)<br>public class EncodeServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    //可以解决客户端中文乱码，但是编码不统一
</code></pre>
<p>&#x2F;&#x2F;        resp.setCharacterEncoding(“GBK”);<br>        resp.setContentType(“text&#x2F;html;charset&#x3D;utf-8”);<br>&#x2F;&#x2F;        PrintWriter pw &#x3D; resp.getWriter();<br>&#x2F;&#x2F;        pw.write(“中文”);</p>
<pre><code>    //链式编程
    resp.getWriter().write(&quot;中文&quot;);
&#125;
</code></pre>
<p>}<br>综合案例<br>3.1 点击切换验证码<br>在页面展示登陆验证码，点击可以更换新验证码<br>作用:防止表单的恶意提交<br>本质:图片<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br><img src="/2020/04/16/Java-Web-ServletContext-Response/CheckCodeServlet" alt id="image1"></p>
<script>
    document.getElementById("image1").onclick = function () {
        //reset src path
        // new Date().getTime()为了欺骗浏览器使用不同src，强制刷新
        this.src = '/Day35_war_exploded/CheckCodeServlet?' + new Date().getTime();
    }
</script>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>49<br>50<br>51<br>52<br>53<br>54<br>55<br>56<br>57<br>58<br>59<br>60<br>@WebServlet(“&#x2F;CheckCodeServlet”)<br>public class CheckCodeServlet extends HttpServlet {<br>    private static final long serialVersionUID &#x3D; 1L;<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
</code></pre>
<p>&#x2F;&#x2F;  创建画布<br>        int width &#x3D; 120;<br>        int height &#x3D; 40;<br>        BufferedImage bufferedImage &#x3D; new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);<br>        &#x2F;&#x2F;  获得画笔<br>        Graphics g &#x3D; bufferedImage.getGraphics();<br>        &#x2F;&#x2F;  填充背景颜色<br>        g.setColor(Color.white);<br>        g.fillRect(0, 0, width, height);<br>        &#x2F;&#x2F;  绘制边框<br>        g.setColor(Color.red);<br>        g.drawRect(0, 0, width - 1, height - 1);<br>        &#x2F;&#x2F;  生成随机字符<br>        &#x2F;&#x2F;  准备数据<br>        String data &#x3D; “ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890”;<br>        &#x2F;&#x2F;  准备随机对象<br>        Random r &#x3D; new Random();<br>        &#x2F;&#x2F;  声明一个变量 保存验证码<br>        String code &#x3D; “”;<br>        &#x2F;&#x2F;  书写4个随机字符<br>        for (int i &#x3D; 0; i &lt; 4; i++) {<br>            &#x2F;&#x2F;  设置字体<br>            g.setFont(new Font(“宋体”, Font.BOLD, 28));<br>            &#x2F;&#x2F;  设置随机颜色<br>            g.setColor(new Color(r.nextInt(255), r.nextInt(255), r.nextInt(255)));</p>
<pre><code>        String str = data.charAt(r.nextInt(data.length())) + &quot;&quot;;
        g.drawString(str, 10 + i * 28, 30);

        //  将新的字符 保存到验证码中
        code = code + str;
    &#125;
    //  绘制干扰线
    for (int i = 0; i &lt; 6; i++) &#123;
        //  设置随机颜色
        g.setColor(new Color(r.nextInt(255), r.nextInt(255), r.nextInt(255)));

        g.drawLine(r.nextInt(width), r.nextInt(height), r.nextInt(width), r.nextInt(height));
    &#125;

    //  将验证码 打印到控制台
    System.out.println(code);

    //  将验证码放到session中
    req.getSession().setAttribute(&quot;code_session&quot;, code);

    //  将画布显示在浏览器中
    ImageIO.write(bufferedImage, &quot;jpg&quot;, resp.getOutputStream());
&#125;
</code></pre>
<p>}<br>3.2 文件下载<br>用户点击页面的链接，浏览器开始下载文件。<br>3.2.1 使用链接下载文件<br>1<br><a href="/Day35_war_exploded/download/web.xml">Download_XML</a><br><br>缺点<br>浏览器可识别的媒体类型，是直接打开而不是下载<br>不能判断用户是否登录(vip)，进行限制</p>
<p>3.2.2 使用Servlet下载文件<br>二个响应头二个字节流</p>
<p>说明	API<br>被下载文件的字节输入流	FileInputStream<br>response字节输出流	response字节输出流<br>告知客户端下载文件的MIME类型	Content-Type:MIME类型<br>告知浏览器以附件的方式保存	Content-Disposition:attachment;filename&#x3D;文件名<br>1<br><a href="/Day35_war_exploded/DownloadServlet?filename=web.xml">Download_XML</a><br><br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>@WebServlet(“&#x2F;DownloadServlet”)<br>public class DownloadServlet extends HttpServlet {<br>    @Override<br>    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>        this.doPost(req, resp);<br>    }</p>
<pre><code>@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
    //获取文件名
    String filename = req.getParameter(&quot;filename&quot;);
    //获取文件真实路径，封装字节输入流
    ServletContext servletContext = req.getServletContext();
    String realPath = servletContext.getRealPath(&quot;/download/&quot; + filename);
    FileInputStream in = new FileInputStream(realPath);

    //告诉浏览器下载文件MIME类型 Content-Type
    String mimeType = servletContext.getMimeType(filename);
    resp.setContentType(mimeType);

    //告知浏览器以附件的方式保存 Content-Disposition:attachment;filename=文件名
    //解决中文乱码和浏览器兼容性
    String userAgent = req.getHeader(&quot;user-agent&quot;);
    //调用工具处理
    filename=DownLoadUtils.getName(userAgent,filename);
    resp.setHeader(&quot;content-disposition&quot;, &quot;attachment;filename=&quot; + filename);
</code></pre>
<p>&#x2F;&#x2F;        resp.setHeader(“Content-Disposition”, “attachment;filename&#x3D;” + filename);<br>        &#x2F;&#x2F;获取response的字节输出流<br>        ServletOutputStream out &#x3D; resp.getOutputStream();<br>        &#x2F;&#x2F;IO流Copy<br>&#x2F;&#x2F;        byte[] bys &#x3D; new byte[1024];<br>&#x2F;&#x2F;        int len &#x3D; 0;<br>&#x2F;&#x2F;        while ((len &#x3D; in.read(bys)) !&#x3D; -1) {<br>&#x2F;&#x2F;            out.write(bys, 0, len);<br>&#x2F;&#x2F;        }<br>        IoUtil.copy(in,out);<br>        &#x2F;&#x2F;释放资源<br>        out.close();&#x2F;&#x2F;可以交给Tomcat关闭<br>        in.close();<br>    }<br>}<br>中文乱码问题<br>如果该下载文件名是中文的话，会出现乱码…<br>谷歌和绝大多数的浏览器是通过 url编码<br>URLEncode() 编码<br>URLDecode() 解码<br>火狐浏览器 base64编码<br>如下工具包解决乱码问题:<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>public class DownLoadUtils {</p>
<pre><code>public static String getName(String agent, String filename) throws UnsupportedEncodingException &#123;
    if (agent.contains(&quot;Firefox&quot;)) &#123;
        // 火狐浏览器
        BASE64Encoder base64Encoder = new BASE64Encoder();
        filename = &quot;=?utf-8?B?&quot; + base64Encoder.encode(filename.getBytes(&quot;utf-8&quot;)) + &quot;?=&quot;;
    &#125; else &#123;
        // 其它浏览器
        filename = URLEncoder.encode(filename, &quot;utf-8&quot;);
    &#125;
    return filename;
&#125;
</code></pre>
<p>}<br>3.2.2.1 hutool工具包<br>官网:<a target="_blank" rel="noopener" href="https://www.hutool.cn/">https://www.hutool.cn/</a></p>
<p>hutool-all-5.2.3.jar<br>总结<br>一 ServletContext<br>概述<br>代表当前web项目对象<br>主要作用<br>共享数据（域对象）</p>
<p>获取资源文件在服务器上真实路径</p>
<p>获取全局的配置参数</p>
<p>web.xml中配置<br>获取文件MIME类型</p>
<p>互联网传输数据时，识别文件的类型<br>案例：统计网站的访问次数<br>二 Response<br>概述<br>开发人员可以使用response对象的方法，设置要返回给浏览器的响应信息<br>Response设置响应消息<br>设置响应行</p>
<p>void setStatus(int sc)<br>设置响应头</p>
<p>void setHeader(String name, String value)<br>设置响应体</p>
<p>ServletOutputStream getOutputStream() 字节输出流<br>PrintWriter getWriter() 字符输出流<br>响应重定向<br>转发与重定向的区别</p>
<p>转发</p>
<p>地址栏： 没有改变<br>浏览器： 发了一次请求<br>服务器： 只有一对请求和响应对象<br>发生的位置： 服务器<br>重定向</p>
<p>地址栏： 发生了改变<br>浏览器： 发了两次请求<br>服务器： 有两对请求和响应对象<br>发生的位置： 浏览器<br>响应定时刷新<br>响应中文<br>response.setContentType(“text&#x2F;html;charset&#x3D;utf-8”);<br>三 综合案例<br>点击切换验证码<br>随机数欺骗浏览器<br>文件下载<br>解决了中文编码<br>hutool工具包</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/15/Java-Web-Request/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/15/Java-Web-Request/" class="post-title-link" itemprop="url">Java Web - Request</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-15 01:19:16" itemprop="dateCreated datePublished" datetime="2020-04-15T01:19:16+08:00">2020-04-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.Request概述<br>用户通过浏览器访问服务器时,Tomcat将HTTP请求中所有信息封装在Request对象中<br>作用:开发人员可以通过Request对象方法，来获取浏览器发送的所有信息</p>
<p>Request体系结构</p>
<p>ServletRequest<br>⬆<br>HttpServletRequest<br>⬆<br>org.apache.catalina.connector.RequestFacade(由tomcat厂商提供实现类)<br>二.Request获取Http请求信息<br>2.1 获取请求行信息<br>例如:<br>GET &#x2F;Day34_Request_war_exploded&#x2F;RequestDemo01 HTTP&#x2F;1.1<br>相关API:<br>说明<br>API<br>获取请求方式	String getMethod()<br>获取项目虚拟路径名	String getContextPath()<br>获取URI<br>(统一资源标识符)	String getRequestURI()<br>获取URL<br>(统一资源定位符)	StringBuffer getRequestURL()<br>获取协议和版本号	String getProtocol()<br>获取客户端IP	String getRemoteAddr()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/RequestDemo01&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestDemo01</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//        System.out.println(req);</span></span><br><span class="line">    <span class="comment">//1.获取请求方式</span></span><br><span class="line">    System.out.println(<span class="string">&quot;Request Method &quot;</span>+req.getMethod());</span><br><span class="line">    <span class="comment">//2.获取项目路径</span></span><br><span class="line">    System.out.println(<span class="string">&quot;Project Path &quot;</span>+req.getContextPath());</span><br><span class="line">    <span class="comment">//3.获取URI</span></span><br><span class="line">    System.out.println(<span class="string">&quot;URI &quot;</span>+req.getRequestURI());</span><br><span class="line">    <span class="comment">//4.获取URL</span></span><br><span class="line">    System.out.println(<span class="string">&quot;URI &quot;</span>+req.getRequestURL());</span><br><span class="line">    <span class="comment">//5.协议和版本</span></span><br><span class="line">    System.out.println(<span class="string">&quot;Protocol &amp; Version &quot;</span>+ req.getProtocol());</span><br><span class="line">    <span class="comment">//6.客户端IP</span></span><br><span class="line">    System.out.println(<span class="string">&quot;IP &quot;</span>+ req.getRemoteAddr());&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>&#x2F;&#x2F;输出<br>Request Method: GET<br>Project Path: &#x2F;Day34_Request_war_exploded<br>URI: &#x2F;Day34_Request_war_exploded&#x2F;RequestDemo01<br>URL: <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/Day34_Request_war_exploded/RequestDemo01">http://127.0.0.1:8080/Day34_Request_war_exploded/RequestDemo01</a><br>Protocol &amp; Version: HTTP&#x2F;1.1<br>IP: 127.0.0.1<br>2.2 获取请求头信息<br>例如:</p>
<p>Host:locaohost:8080</p>
<p>相关API</p>
<p>说明<br>API<br>获取请求头名称对应的值	String getHeader(String name)<br>获取所有请求头的名称	Enumeration getHeaderNames()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/RequestDemo02&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestDemo02</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//获取所有请求头名称</span></span><br><span class="line">    Enumeration&lt;String&gt; headerNames = req.getHeaderNames();</span><br><span class="line">    <span class="comment">//遍历</span></span><br><span class="line">    <span class="keyword">while</span> (headerNames.hasMoreElements())&#123;</span><br><span class="line">      <span class="comment">//取出元素名(请求头名称)</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> headerNames.nextElement();</span><br><span class="line">      <span class="comment">//根据名称获取值</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> req.getHeader(name);</span><br><span class="line">      System.out.println(value);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>案例:模拟视频防盗链</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/RefereRequest&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RefereRequest</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//0.设置编码，让中文不乱码</span></span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">    <span class="comment">//1.获取请求来源(如果是浏览器地址栏直接访问，referer是Null)</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">referer</span> <span class="operator">=</span> req.getHeader(<span class="string">&quot;referer&quot;</span>);</span><br><span class="line">    <span class="comment">//2.判断是否自己网站发起的请求</span></span><br><span class="line">    <span class="keyword">if</span>(referer != <span class="literal">null</span> &amp;&amp; referer.startsWith(<span class="string">&quot;http://127.0.0.1:8080&quot;</span>))&#123;</span><br><span class="line">      resp.getWriter().write(<span class="string">&quot;Play Video&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      resp.getWriter().write(<span class="string">&quot;Permission Denied&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>案例:浏览器兼容性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/UserAgentRequest&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserAgentRequest</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//0.设置语言编码</span></span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">    <span class="comment">//1.获取浏览器版本信息</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">useragent</span> <span class="operator">=</span> req.getHeader(<span class="string">&quot;user-agent&quot;</span>);</span><br><span class="line">    <span class="comment">//2.判断浏览器版本</span></span><br><span class="line">    System.out.println(useragent);</span><br><span class="line">    <span class="keyword">if</span> (useragent.contains(<span class="string">&quot;Chrome&quot;</span>))&#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Chrome&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (useragent.contains(<span class="string">&quot;Firefox&quot;</span>))&#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Firefox&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Others&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>2.3 获取请求参数(请求体)<br>不论是get还是post请求方式,都可以使用下列方式来获取请求参数<br>参数:<br>username&#x3D;jack&amp;password&#x3D;123<br>说明<br>API<br>获取指定参数名的值	String getParameter(String name);<br>获取指定参数名的值数组	String[] getParameterValues(String name);<br>获取所有参数名和对应值数组	Map&lt;String,String[]&gt; getParameterMap()<br>中文乱码<br>get:在Tomcat 8 及以上版本，内部URL编码(UTF-8)<br>post:编码解码不一致，造成乱码现象<br>客户端(浏览器)编码UTF-8<br>服务器默认解码:ISO-8859-1<br>指定解码:void setCharacterEncoding(String env)<br>注意:指定解码必须在行首</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/RequestDemo03&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestDemo03</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//Get manually</span></span><br><span class="line">    <span class="comment">//        String username = req.getParameter(&quot;username&quot;);</span></span><br><span class="line">    <span class="comment">//        System.out.println(username);</span></span><br><span class="line">    <span class="comment">//        String password = req.getParameter(&quot;password&quot;);</span></span><br><span class="line">    <span class="comment">//        System.out.println(password);</span></span><br><span class="line">    <span class="comment">//        String[] hobbies = req.getParameterValues(&quot;hobby&quot;);</span></span><br><span class="line">    <span class="comment">//        System.out.println(Arrays.toString(hobbies));</span></span><br><span class="line">    <span class="comment">//Automatic acquisition</span></span><br><span class="line">    Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();</span><br><span class="line">    parameterMap.forEach((k, v) -&gt; &#123;</span><br><span class="line">      System.out.println(k + <span class="string">&quot;&quot;</span> + Arrays.toString(v));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    <span class="comment">//使用方法一样，可以直接调用get方法</span></span><br><span class="line">    <span class="built_in">this</span>.doGet(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.4 BeanUtils<br>Apache提供的工具类，简化参数封装，即将前端数据直接封装到想要的JavaBean中</p>
<p>导入Jar包</p>
<p>使用工具类封装数据(要求:map集合的key,必须为JavaBean属性名)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String username;</span><br><span class="line">  <span class="keyword">private</span> String password;</span><br><span class="line">  <span class="keyword">private</span> String[] hobby;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 此处省略getter setter toString</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@WebServlet(&quot;/RequestDemo04&quot;)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestDemo04</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">      <span class="comment">//Get manually</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">      System.out.println(username);</span><br><span class="line">      <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">      System.out.println(password);</span><br><span class="line">      String[] hobbies = req.getParameterValues(<span class="string">&quot;hobby&quot;</span>);</span><br><span class="line">      <span class="comment">//Automatic acquisition</span></span><br><span class="line">      Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();</span><br><span class="line">      parameterMap.forEach((k, v) -&gt; &#123;</span><br><span class="line">        System.out.println(k + <span class="string">&quot;&quot;</span> + Arrays.toString(v));</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">//将前端表单数据赋值到user对象中,保存到数据库</span></span><br><span class="line">      <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">      user.setUsername(username);</span><br><span class="line">      user.setPassword(password);</span><br><span class="line">      user.setHobby(hobbies);</span><br><span class="line">      System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">      req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">      <span class="comment">//使用方法一样，可以直接调用get方法</span></span><br><span class="line">      <span class="built_in">this</span>.doGet(req, resp);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//使用BeanUtils快速封装数据到User对象中</span></span><br><span class="line">      <span class="comment">//map集合的key,必须为JavaBean属性名</span></span><br><span class="line">      Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();</span><br><span class="line">      <span class="comment">//</span></span><br><span class="line">      <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        BeanUtils.populate(user, parameterMap);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">      System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Bean Utils:<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/Day34_Request_war_exploded/RequestDemo04&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  Name:</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  Password:</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  Hobby:</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;smoke&quot;</span>&gt;</span>smoke</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;drink&quot;</span>&gt;</span>drink</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;perm&quot;</span>&gt;</span>perm<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Post Submit Method&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.4.1 变量名是否等于属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//成员变量名username</span></span><br><span class="line"><span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//属性Username，是方法的命名</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> username;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//属性是getter/setter方法截取之后的产物</span></span><br><span class="line"><span class="comment">//通常情况下,使用IDEA自动生成getter&amp;setter时，变量名 equals 属性</span></span><br><span class="line">getUsername-Username-username</span><br><span class="line"></span><br><span class="line">  <span class="comment">//不一样的情况</span></span><br><span class="line">  <span class="comment">//成员变量名</span></span><br><span class="line">  <span class="keyword">private</span> String user;</span><br><span class="line"><span class="comment">//属性名</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>三.Request其他功能<br>3.1 请求转发<br>一种在服务器内部的资源跳转方式<br>说明<br>API<br>通过request对象，获得转发器对象	RequestDispatcher getRequestDispatcher(String path);<br>通过转发器对象，实现转发功能	void forward(ServletRequest request,ServletResponse response);<br>请求转发的特点:<br>浏览器:只发了一次请求<br>地址栏:没有改变<br>只能转发到服务器内部资源</p>
<p>链式编程<br>request.getRequestDispatcher(“&#x2F;bServlet”).forward(reqeust,response)<br>3.2 域对象(共享数据)<br>域对象:一个有作用访问的对象，可以在范围内共享数据</p>
<p>request域:代表一次请求范围,一般用于一次请求中转发的多个资源中共享数据</p>
<p>说明<br>API<br>设置数据	void setAttribute(String name,Object o);<br>获取数据	Object getAttribute(String name)<br>删除数据	void removeAttribute(String name)<br>生命周期</p>
<p>创建时间	用户发送请求时，发送request<br>销毁时间	服务器返回响应时，销毁request<br>作用范围	一次请求，包含多次转发</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/AServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req,resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//转发到BServlet</span></span><br><span class="line">    <span class="comment">//1.获取转发器对象 path=@WebServlet(&quot;/BServlet&quot;)</span></span><br><span class="line">    <span class="comment">//        RequestDispatcher requestDispatcher = req.getRequestDispatcher(&quot;/BServlet&quot;);</span></span><br><span class="line">    <span class="comment">//2.实现转发功能</span></span><br><span class="line">    <span class="comment">//        requestDispatcher.forward(req,resp);</span></span><br><span class="line">    <span class="comment">//AServlet存一个数据</span></span><br><span class="line">    req.setAttribute(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;This is A Object&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//链式编程</span></span><br><span class="line">    req.getRequestDispatcher(<span class="string">&quot;/BServlet&quot;</span>).forward(req,resp);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/BServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req,resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> (String) req.getAttribute(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    resp.getWriter().write(name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.3 获取ServletContext对象<br>应用上下文对象，表示一个web项目<br>通过request，可以获取ServletContext对象<br>public ServletContext getServletContext();</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/RequestDemo05&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestDemo05</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//获取当前web项目对象</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> req.getServletContext();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>四.用户登陆案例<br>实现用户的登录功能<br>登录成功跳转到SuccessServlet展示:登录成功!xxx,欢迎您<br>登录失败跳转到FailServlet展示:登录失败，用户名或密码错误</p>
<p>创建web项目，导入BeanUtils(工具类)<br>编写index.html<br>User实体类<br>创建LoginServlet,SuccessServlet，FailedServlet</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/Day34_Request_war_exploded/loginServlet&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span>Login</span><br><span class="line">  Name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  Password:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Login Submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String username;</span><br><span class="line">  <span class="keyword">private</span> String password;</span><br><span class="line">  <span class="comment">//此处getter &amp; setter ，toString省略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/loginServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//1.设置request解码方式</span></span><br><span class="line">    req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    <span class="comment">//2.获取浏览器参数，map集合</span></span><br><span class="line">    Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();</span><br><span class="line">    <span class="comment">//3.使用BeanUtils工具类，封装到User中</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      BeanUtils.populate(user, parameterMap);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.判断(写一个file文件，存储真实到用户名密码，判断)</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;jack&quot;</span>.equals(user.getUsername()) &amp;&amp; <span class="string">&quot;123&quot;</span>.equals(user.getPassword()))&#123;</span><br><span class="line">      req.setAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">      req.getRequestDispatcher(<span class="string">&quot;/successServlet&quot;</span>).forward(req, resp);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      req.getRequestDispatcher(<span class="string">&quot;/failedServlet&quot;</span>).forward(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/successServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuccessServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//1.从request域获取user对象</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) req.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="comment">//2.提示</span></span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">    resp.getWriter().write(user.getUsername()+<span class="string">&quot;Successful&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@WebServlet(&quot;/failedServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FailedServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;Login Failed,Wrong Username or Password&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>附录:Servlet模版设置<br>IDEA-Settings-Editor-File and Code Templates-Other-Web&gt;Jaava code templates&gt;Servlet Annotated Class.java<br>更改为如下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> ($&#123;PACKAGE_NAME&#125; &amp;&amp; $&#123;PACKAGE_NAME&#125; != <span class="string">&quot;&quot;</span>)<span class="keyword">package</span> $&#123;PACKAGE_NAME&#125;;#end #parse(<span class="string">&quot;File Header.java&quot;</span>) <span class="meta">@javax</span>.servlet.annotation.WebServlet(<span class="string">&quot;/$&#123;Class_Name&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">$</span>&#123;Class_Name&#125; <span class="keyword">extends</span> <span class="title class_">javax</span>.servlet.http.HttpServlet &#123;</span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(javax.servlet.http.HttpServletRequest request, javax.servlet.http.HttpServletResponse response)</span> <span class="keyword">throws</span> javax.servlet.ServletException, java.io.IOException &#123;</span><br><span class="line"><span class="built_in">this</span>.doPost(request,response); &#125;</span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(javax.servlet.http.HttpServletRequest request, javax.servlet.http.HttpServletResponse response)</span> <span class="keyword">throws</span> javax.servlet.ServletException, java.io.IOException &#123;</span><br><span class="line"></span><br><span class="line">&#125; &#125;</span><br></pre></td></tr></table></figure>


<p>总结<br>一 Request概述<br>开发人员可以通过request对象方法，来获取浏览器发送的所有信息.<br>二 Request获取Http请求信息<br>行<br>getMethod()</p>
<p>请求方式</p>
<p>get<br>post<br>getContextPath()</p>
<p>项目名（虚拟路径）<br>getRemoteAddr()</p>
<p>客户端的ip地址<br>头<br>getHeader(String key)</p>
<p>Referer</p>
<p>防盗链<br>User-Agent</p>
<p>浏览器兼容器<br>getHeaderNames()</p>
<p>参数（体）<br>api</p>
<p>getParameter()<br>getParameterValues()<br>getParameterMap()<br>BeanUtils工具类</p>
<p>中文乱码</p>
<p>get：tomcat8及以上版本，解决了get方式乱码问题<br>post：request.setCharacterEncoding(“utf-8”);<br>三 Request其他功能<br>请求转发<br>一种在服务器内部的资源跳转方式</p>
<p>request.getRequestDispatcher(“&#x2F;内部资源”).forward(request,response);</p>
<p>特点</p>
<p>转发是一次请求<br>浏览器地址栏不发生变化<br>只能跳转到服务器内部资源<br>域对象（共享数据）<br>api</p>
<p>void setAttribute(String name, Object o)<br>Object getAttribute(String name)<br>void removeAttribute(String name)<br>生命周期</p>
<p>何时创建</p>
<p>用户发送请求时<br>何时销毁</p>
<p>服务器做出响应后<br>作用范围</p>
<p>一次请求转发中<br>获取ServletContext<br>api</p>
<p>ServletContext getServletContext()</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/04/13/Java-Web-Servlet%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/13/Java-Web-Servlet%E5%85%A5%E9%97%A8/" class="post-title-link" itemprop="url">Java Web - Servlet入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-13 01:18:43" itemprop="dateCreated datePublished" datetime="2020-04-13T01:18:43+08:00">2020-04-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一.Servlet概述<br>Servlet 运行在服务端的Java小程序，是sun公司提供一套规范，用来处理客户端请求、响应给浏览器的动态资源。<br>但servlet的实质就是java代码，通过java的API动态的向客户端输出内容</p>
<p>servlet&#x3D; server+applet 运行在服务器端的java程序。<br>Servlet是一个接口，一个类要想通过浏览器被访问到,那么这个类就必须直接或间接的实现Servlet接口<br>二.Servlet快速入门<br>2.1 代码编写<br>创建web项目</p>
<p>编写普通java类,实现Servlet接口<br>写抽象方法(service方法)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuickServlet</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//对外提供服务</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">request:代表请求</span></span><br><span class="line"><span class="comment">response:代表响应</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//向浏览器写一句话</span></span><br><span class="line">    servletResponse.getWriter().write(<span class="string">&quot;QuickServlet&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//表示当前Servlet对象的描述信息</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getServletInfo</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;快速入门&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>配置web.xml<br>配置servlet网络访问路径</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;3.1&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">把QuickServlet交给tomcat管理</span></span><br><span class="line"><span class="comment">servlet-name:当前servlet的别名(使用类名即可)</span></span><br><span class="line"><span class="comment">servlet-class:全限定类名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>QuickServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>Project.QuickServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">给servlet社长一个网络访问地址(路径)</span></span><br><span class="line"><span class="comment">servlet-name:给指定别名的servlet配置映射</span></span><br><span class="line"><span class="comment">url-pattern:网络访问地址(注意:必须以&quot;/&quot;开头)</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>QuickServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/QuickServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>部署web项目<br>启动测试<br>2.2 执行原理<br>步骤:<br>Step 1: Browser通过 Domain 在网络中Request到该 Server(Tomcat)<br>Step 2: 找到该Server后，通过Project Name查找项目(Day32_Servlet_XML)<br>Step 3: 通过Source Name(QuickServlet)查找web.xml中同名的url-pattern标签<br>Step 4: 找到url-pattern同名标签后，查找其映射的servlet-name<br>Step 5: 通过servlet-name寻找servlet-class<br>Step 6: 通过反射机制创建QuickServlet<br>Step 7: 创建后，自动调用service方法,Response to Browser</p>
<p>三.Servlet相关API<br>3.1 生命周期相关<br>3.1.1 思想介绍<br>生命周期:指的是一个对象从创建到销毁到过程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//servlet对象创建时,调用此方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;LifeServlet Created&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//用户访问servlet时,调用此方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;LifeServlet carried out&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//servlet对象销毁时,调用此方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;LifeServlet destroy&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>创建</p>
<p>1)默认<br>用户第一次访问时,创建servlet,执行init方法<br>2）修改servlet创建时机<br><load-on-startup></load-on-startup></p>
<p>值	说明<br>正数	服务器启动时创建<br>(Tomcat默认1-3，建议4开始)<br>负数(默认值):-1	用户第一次访问时创建<br>运行</p>
<p>第二次开始，都调用执行service方法</p>
<p>销毁</p>
<p>服务器正常关闭时,销毁servlet，执行destroy方法</p>
<p>3.1.2 代码演示<br>LifeServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LifeServlet</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;LifeServlet Created&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;LifeServlet carried out&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getServletInfo</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;LifeServlet destroy&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">servlet生命周期</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LifeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>Project.Demo02.LifeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>4<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LifeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/LifeServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>3.2 拓展:ServletConfig接口<br>Tomcat在Servlet对象创建时,执行init()方法，并创建一个ServletConfig配置对象</p>
<p>主要作用:读取web.xml配置文件Servlet中信息,实现参数和代码的解耦</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EncodingServlet</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span> &#123;</span><br><span class="line">  <span class="comment">//定义全局变量</span></span><br><span class="line">  <span class="keyword">private</span> ServletConfig servletConfig;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    <span class="built_in">this</span>.servletConfig = servletConfig;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> servletConfig;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//用户访问,执行service方法</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//        String encode = &quot;UTF-8&quot;;</span></span><br><span class="line">    <span class="comment">//        servletResponse.getWriter().write(encode);</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">encode</span> <span class="operator">=</span> getServletConfig().getInitParameter(<span class="string">&quot;encode&quot;</span>);</span><br><span class="line">    servletResponse.getWriter().write(encode);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getServletInfo</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--servlet配置对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>EncodingServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>Project.Demo02.EncodingServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encode<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>EncodingServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/EncodingServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>四.Servlet体系结构<br>Servlet<br>顶级接口,提供了5个抽象方法<br>⬆	<br>GenericServlet	抽象类,重写绝大多数的抽象方法，只需要开发者重写service方法<br>⬆	<br>HttpServlet	抽象类，处理Http协议的交互信息(请求，响应),根据不同的请求方式作出不同的处理<br>4.1 GenericServlet<br>编写普通Java类继承GenericServlet抽象类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletDemo01</span> <span class="keyword">extends</span> <span class="title class_">GenericServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ServletDemo01 Created&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="built_in">super</span>.getServletConfig();<span class="comment">//调用父类的配置对象</span></span><br><span class="line">    servletResponse.getWriter().write(<span class="string">&quot;ServletDemo01 extends GenericServlet&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ServletDemo01 Destroyed&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--servlet继承GenericServlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo01<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>Project.Demo03_inherit.ServletDemo01<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encode<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo01<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ServletDemo01<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>4.2 HttpServlet<br>编写前端HTML页面提交表单</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://localhost:8080/Day33_Servlet_war_exploded/ServletDemo02&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Update Form&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>编写普通java类，继承HttpServlet抽象类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletDemo02</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;Get&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;Post&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--servlet继承HttpServlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo02<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>Project.Demo03_inherit.ServletDemo02<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo02<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ServletDemo02<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>4.3 Http错误<br>响应状态码405<br>方法没有重写，父类抛出405<br>例:<br>ServletDemo02 extends HttpServlet 没有重写get方法，而form使用get方法，则抛出父类405错误</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父类方法</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">  <span class="type">String</span> <span class="variable">protocol</span> <span class="operator">=</span> req.getProtocol();</span><br><span class="line">  <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> lStrings.getString(<span class="string">&quot;http.method_get_not_supported&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (protocol.endsWith(<span class="string">&quot;1.1&quot;</span>)) &#123;</span><br><span class="line">    resp.sendError(<span class="number">405</span>, msg);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    resp.sendError(<span class="number">400</span>, msg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>响应状态码500<br>Java代码写错了</p>
<p>五.Servlet路径<br>5.1 url-patterns<br>作用:讲一个请求的网络地址和servlet建立一个映射关系</p>
<p>5.1.1 Servlet映射多个路径</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletDemo03</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;ServletDemo3 Get Method Run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;ServletDemo3 Post Method Run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    一个Servlet类可以映射多个网络访问地址        --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo03<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>Project.Demo04_URL_Partten.ServletDemo03<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    映射地址一   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo03<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/ServletDemo03<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    映射地址二    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo03<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Demo03<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>5.1.2 url映射模式<br>配置<url-pattern>url地址取值可以是:</url-pattern></p>
<p>精确匹配</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletDemo04</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;ServletDemo4 Get Method Run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;ServletDemo4 Post Method Run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--目录的匹配规则</span></span><br><span class="line"><span class="comment">只要浏览器符合规则:/aa/xxx</span></span><br><span class="line"><span class="comment">都访问ServletDemo04</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo04<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.test.Demo04_URL_Partten.ServletDemo04<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo04<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/aa/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>后缀匹配<br>*.xxx</p>
<p>例如:*.do</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletDemo05</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;ServletDemo5 Get Method Run&quot;</span>);</span><br><span class="line">  &#125;<span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;ServletDemo5 Post Method Run&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 只要浏览器符合后缀匹配规则，都可以访问到这个servlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo05<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.test.Demo04_URL_Partten.ServletDemo05<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ServletDemo05<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>5.2 相对&#x2F;绝对路径<br>浏览器的地址栏<br>a标签的href属性<br>form表单的action属性<br>js的location.href属性<br>ajax请求地址</p>
<p>&#x2F;&#x2F;访问地址：<a target="_blank" rel="noopener" href="http://localhost:8080/projectname/static/Path.html">http://localhost:8080/projectname/static/Path.html</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Path<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>Text Interview Path<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>绝对路径<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">在开发时，强烈建议使用绝对路径</span></span><br><span class="line"><span class="comment">完整:protocol://domain:port/project/SourceName</span></span><br><span class="line"><span class="comment">推荐:/项目名/资源名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://localhost:8080/Day33_Servlet_war_exploded/QuickServlet&quot;</span>&gt;</span></span><br><span class="line">      带HTTP协议的绝对路径:QuickServlet</span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/Day33_Servlet_war_exploded/QuickServlet&quot;</span>&gt;</span>不带HTTP协议的绝对路径:QuickServlet<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>相对路径<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">相对路径语法：</span></span><br><span class="line"><span class="comment">./当前目录</span></span><br><span class="line"><span class="comment">../上级目录</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;../QuickServlet&quot;</span>&gt;</span>相对路径:QuickServlet<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>六.Servlet3.0<br>通过注解配置Servlet,简化web.xml配置Servlet复杂性，提高开发效率，集合所有框架都使用注解</p>
<p>创建web项目<br>编写普通Java类继承HttpServlet抽象类<br>配置@WebServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/QuickServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuickServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;Quick Servlet 3.0 Get Method&quot;</span>);</span><br><span class="line">  &#125;<span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().write(<span class="string">&quot;Quick Servlet 3.0 Post Method&quot;</span>);</span><br><span class="line">  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>总结<br>一 Servlet概述<br>运行在服务器端的java程序<br>一个类要想通过浏览器被访问到,那么这个类就必须直接或间接的实现Servlet接口<br>二 Servlet快速入门<br>① 创建web项目<br>② 创建普通的java类，实现servlet接口，重写抽象方法<br>③ 配置web.xml<br>④ 部署web项目<br>⑤ 启动测试<br>三 Servlet相关API<br>生命周期相关<br>创建</p>
<p>1)默认情况下，用户第一次访问时创建，执行init方法，只创建一次<br>2）修改创建时机，在tomcat启动时，创建servlet，执行init方法，只创建一次<br>运行（提供服务）</p>
<p>用户访问servlet资源时，执行service方法<br>销毁</p>
<p>服务器正常关闭，销毁servlet，执行destroy方法<br>ServletConfig接口<br>加载web.xml配置文件信息，实现参数和代码的解耦<br>四 Servlet体系结构<br>Servlet<br>GenericServlet</p>
<p>HttpServlet<br>五 Servlet路径<br>url-pattern<br>Servlet映射多个url</p>
<p>url映射模式</p>
<p>精确匹配<br>目录匹配<br>后缀匹配<br>相对&#x2F;绝对路径<br>绝对路径…<br>六 Servlet3.0<br>@WebServlet(“&#x2F;网络访问地址”)</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">swzxsyh</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">193</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/swzxsyh" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;swzxsyh" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/swzxsyh" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;swzxsyh" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">swzxsyh</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


</body>
</html>
