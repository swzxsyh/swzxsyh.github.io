<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"swzxsyh.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="一.NoSQL1.1 NoSQL介绍NoSQL(Not-Only SQL)，泛指非关系型的数据库，它可以作为关系型数据库的良好补充。 关系型数据库	非关系型数据库特点	数据直接存在关联关系	数据之间没有关联关系所有数据都在磁盘中	所有数据都在内存中总结	存储复杂关系模型，硬盘io速度较慢	只能存储简单数据模型，内存io查询速度快为什么学习NoSQL 高并发、高可用、高性能、海量数据 传统的关系型数">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis &amp; 优化">
<meta property="og:url" content="https://swzxsyh.github.io/2020/05/20/Redis-%E4%BC%98%E5%8C%96/index.html">
<meta property="og:site_name" content="swzxsyh">
<meta property="og:description" content="一.NoSQL1.1 NoSQL介绍NoSQL(Not-Only SQL)，泛指非关系型的数据库，它可以作为关系型数据库的良好补充。 关系型数据库	非关系型数据库特点	数据直接存在关联关系	数据之间没有关联关系所有数据都在磁盘中	所有数据都在内存中总结	存储复杂关系模型，硬盘io速度较慢	只能存储简单数据模型，内存io查询速度快为什么学习NoSQL 高并发、高可用、高性能、海量数据 传统的关系型数">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-05-19T17:39:59.000Z">
<meta property="article:modified_time" content="2022-08-09T20:40:38.136Z">
<meta property="article:author" content="swzxsyh">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://swzxsyh.github.io/2020/05/20/Redis-%E4%BC%98%E5%8C%96/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Redis & 优化 | swzxsyh</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="swzxsyh" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">swzxsyh</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">--笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-rss">

    <a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swzxsyh.github.io/2020/05/20/Redis-%E4%BC%98%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="swzxsyh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="swzxsyh">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Redis & 优化
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-05-20 01:39:59" itemprop="dateCreated datePublished" datetime="2020-05-20T01:39:59+08:00">2020-05-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-08-10 04:40:38" itemprop="dateModified" datetime="2022-08-10T04:40:38+08:00">2022-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>一.NoSQL<br>1.1 NoSQL介绍<br>NoSQL(Not-Only SQL)，泛指非关系型的数据库，它可以作为关系型数据库的良好补充。</p>
<p>关系型数据库	非关系型数据库<br>特点	数据直接存在关联关系	数据之间没有关联关系<br>所有数据都在磁盘中	所有数据都在内存中<br>总结	存储复杂关系模型，硬盘io速度较慢	只能存储简单数据模型，内存io查询速度快<br>为什么学习NoSQL</p>
<p>高并发、高可用、高性能、海量数据</p>
<p>传统的关系型数据库出现了性能和扩展的瓶颈，所以非关系型数据库应时而生，解决了互联网产品的三 高和海量数据的问题</p>
<p>NoSQL和关系型的数据库是互补关系，在各自的应用场景中都有自己的特点，一般情况下我们使用关系 型数据库持久化数据(处理复杂的业务场景)，对一些热点数据通过NoSQL来作为缓存提高效率</p>
<p>使用后</p>
<p>先查找缓存<br>没有数据再查找数据库<br>1.2 NoSQL的主流产品<br>分类	特点	代表产品<br>键值存储	数据一般存在内存中，读写速度快(10w&#x2F;s)，适合作为缓存服务	redis<br>文档型数据库	数据结构要求不严格，适合存储结构不确定或者价值较低的数据	mongodb<br>列存储数据库	查找速度快，更容易进行分布式扩展，适合作为文件存储服务	Hbase<br>图形数据库	使用“图结构”进行存储，适合做社交网络计算等等	Neo4j<br>图形数据库介绍</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xlgen157387/article/details/79085901">https://blog.csdn.net/xlgen157387/article/details/79085901</a></p>
<p>二.Redis<br>2.1 Redis介绍<br>Redis(Remote Dictionary Server)是用C语言开发的一个开源的高性能键值对数据库。它的所有数据 都是保存在内存中的,这也就决定了其读写速度之快,是其它硬盘保存数据的系统所无法匹敌的。</p>
<p>官方曾经给出过一组测试数据，50个并发执行100000个请求: 读的速度是110000次&#x2F;s,写的速度是 81000次&#x2F;s</p>
<p>2.2 Redis安装和使用<br>下载</p>
<p>Reids官网地址:<a target="_blank" rel="noopener" href="http://redis.io/">http://redis.io</a></p>
<p>中文网地址:<a target="_blank" rel="noopener" href="https://www.redis.net.cn/">https://www.redis.net.cn/</a></p>
<p>docker</p>
<p>docker pull redis</p>
<p>Linux</p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>$ wget <a target="_blank" rel="noopener" href="http://download.redis.io/releases/redis-6.0.3.tar.gz">http://download.redis.io/releases/redis-6.0.3.tar.gz</a><br>$ tar xzf redis-6.0.3.tar.gz<br>$ cd redis-6.0.3<br>$ make</p>
<p>$ src&#x2F;redis-server</p>
<p>$ src&#x2F;redis-cli<br>redis&gt; set foo bar<br>OK<br>redis&gt; get foo<br>“bar”<br>目录</p>
<p>redis.conf:配置文件</p>
<p>2.3 Redis客户端图形化工具<br>Redis Client 、Redis Desktop Manager 、Redis Studio.</p>
<p>2.4 Redis数据结构<br>Redis采用的键值对存储数据，键(key)的类型只能为字符串，值(value)支持五种数据类型:</p>
<p>K-V类型	key(字符串)	value(支持5种类型)<br>字符串：String	mystr	stringcode<br>哈希：HashMap	myhash	map集合(key:0),(value:100)<br>双向链表：LinkedList	mylist	左压栈—A-A–B–右压栈(有序且可重复)<br>无序集合：HashSet	myset	A|C|B|E|D (无序但不可重复)<br>有序集合：LinkedHashSet	myzset	A|B|C|D|E (有序但不可重复)<br>2.5 Redis命令操作<br>Redis命令是用来操作Redis数据库的, 就相当于操作MySql数据库时的SQL语句。</p>
<p>Redis的命令根据要操作的值(value)的数据结构的不同而不同, 每种数据类型都有自己的操作命令</p>
<p>2.5.1 String字符串<br>字符串类型是Redis中最为基础的数据存储类型。</p>
<p>在Redis中字符串类型的Value最多可以容纳的数据长度是512MB。</p>
<p>用法<br>新增	set key value [EX seconds | PX milliseconds] [NX | XX] [KEEPTTL]<br>查询	get key<br>删除	del key [key …]<br>新增并指定存活时间	setex key seconds value<br>ttl key 查看存活时间<br>主键自增器	incr key (value默认加1)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>127.0.0.1:6379&gt; set mystr stringcode<br>OK<br>127.0.0.1:6379&gt; get mystr<br>“stringcode”<br>127.0.0.1:6379&gt; set mystr new_stringcode<br>OK<br>127.0.0.1:6379&gt; get mystr<br>“new_stringcode”<br>127.0.0.1:6379&gt; setex testcount 10 test10seconds<br>OK<br>127.0.0.1:6379&gt; ttl testcount<br>(integer) 5<br>127.0.0.1:6379&gt; get testcount<br>“test10seconds”<br>127.0.0.1:6379&gt; ttl testcount<br>(integer) -2<br>127.0.0.1:6379&gt; get testcount<br>(nil)<br>127.0.0.1:6379&gt;<br>2.5.2 Hash哈希<br>Hash类型极其类似于java中的Map,值里面可以存放一组组的键值对</p>
<p>该类型非常适合于存储java中对象的信息</p>
<p>用法<br>新增	hset key field value [field value …]<br>查询	hget key field<br>hgetall key<br>删除	hdel key field [field …]<br>del key [key …]<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>127.0.0.1:6379&gt; hset user_1 name Jack<br>(integer) 1<br>127.0.0.1:6379&gt; hset user_1 age 18<br>(integer) 1<br>127.0.0.1:6379&gt; hget user_1 name<br>“Jack”<br>127.0.0.1:6379&gt; hgetall user_1</p>
<ol>
<li>“name”</li>
<li>“Jack”</li>
<li>“age”</li>
<li>“18”<br>127.0.0.1:6379&gt; hdel user_1 age<br>(integer) 1<br>127.0.0.1:6379&gt; hgetall user_1</li>
<li>“name”</li>
<li>“Jack”<br>127.0.0.1:6379&gt; del user_1<br>(integer) 1<br>127.0.0.1:6379&gt; keys *</li>
<li>“mystr”<br>127.0.0.1:6379&gt;<br>2.5.3 List列表<br>List类型底层是一个双向字符串链表。里面的元素是有序的，可重复的</li>
</ol>
<p>我们可以从链表的任何一端进行元素的增删</p>
<h1 id="redis的list是一个双向列表"><a href="#redis的list是一个双向列表" class="headerlink" title="redis的list是一个双向列表"></a>redis的list是一个双向列表</h1><p>b	<br>a<br>c<br>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>用法	<br>新增	lpush key element [element …]	将元素压入左侧顶端<br>rpush key element [element …]	将元素压入右侧顶端<br>查询	lrange key start stop	从左向右查询<br>0 -1 查看所有<br>删除	lpop key	将左侧顶端元素弹出<br>rpop key	将右侧顶端元素弹出<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>127.0.0.1:6379&gt; lpush mylist a<br>(integer) 1<br>127.0.0.1:6379&gt; lpush mylist b<br>(integer) 2<br>127.0.0.1:6379&gt; lpush mylist c<br>(integer) 3<br>127.0.0.1:6379&gt; lrange mylist 0 -1</p>
<ol>
<li>“c”</li>
<li>“b”</li>
<li>“a”<br>127.0.0.1:6379&gt; rpush mylist a<br>(integer) 4<br>127.0.0.1:6379&gt; lrange mylist 0 -1</li>
<li>“c”</li>
<li>“b”</li>
<li>“a”</li>
<li>“a”<br>127.0.0.1:6379&gt; lpop mylist<br>“c”<br>127.0.0.1:6379&gt; rpop mylist<br>“a”<br>127.0.0.1:6379&gt; lrange mylist 0 -1</li>
<li>“b”</li>
<li>“a”<br>127.0.0.1:6379&gt;<br>2.5.4 Set集合（无序）<br>Set类型底层是一张hash表。里面的元素是无序的，不可重复的</li>
</ol>
<p>用法	<br>新增	sadd key member [member …]	新增指定key元素<br>查询	smembers key	查询指定key元素<br>删除	srem key member [member …]	删除指定元素<br>del key [key …]	删除整个set集合<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>127.0.0.1:6379&gt; sadd myset a<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset b<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset c<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset f<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset e<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset d<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset a<br>(integer) 0<br>127.0.0.1:6379&gt; smembers myset</p>
<ol>
<li>“c”</li>
<li>“f”</li>
<li>“b”</li>
<li>“e”</li>
<li>“a”</li>
<li>“d”<br>127.0.0.1:6379&gt; srem myset a<br>(integer) 1<br>127.0.0.1:6379&gt; smembers myset</li>
<li>“c”</li>
<li>“f”</li>
<li>“b”</li>
<li>“e”</li>
<li>“d”<br>127.0.0.1:6379&gt; del myset<br>(integer) 1<br>127.0.0.1:6379&gt; smembers myset<br>(empty array)<br>127.0.0.1:6379&gt;<br>2.5.5 ZSet集合（有序）<br>Zset,也称sortedSet, 在Set的基础上，加入了有序功能，在添加元素的时候，允许指定一个分数，它会 按照这个分数排序</li>
</ol>
<p>用法	<br>新增	zadd key [NX | XX] [CH] [INCR] score member [score member …]	新增指定key元素<br>查询	zrange key start stop [WITHSCORES]	升序<br>zrevrange key start stop [WITHSCORES]	降序<br>删除	zrem key member [member …]	删除指定元素<br>del key [key …]	删除整个zset集合<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>127.0.0.1:6379&gt; zadd myzset 10 aaaaa<br>(integer) 1<br>127.0.0.1:6379&gt; zadd myzset 30 bbbbb<br>(integer) 1<br>127.0.0.1:6379&gt; zadd myzset 20 ccccc<br>(integer) 1<br>127.0.0.1:6379&gt; zrange myzset 0 100</p>
<ol>
<li>“aaaaa”</li>
<li>“ccccc”</li>
<li>“bbbbb”<br>127.0.0.1:6379&gt; zrange myzset 0 100 withscores</li>
<li>“aaaaa”</li>
<li>“10”</li>
<li>“ccccc”</li>
<li>“20”</li>
<li>“bbbbb”</li>
<li>“30”<br>127.0.0.1:6379&gt; zrevrange myzset 0 100</li>
<li>“bbbbb”</li>
<li>“ccccc”</li>
<li>“aaaaa”<br>127.0.0.1:6379&gt; zrevrange myzset 0 100 withscores</li>
<li>“bbbbb”</li>
<li>“30”</li>
<li>“ccccc”</li>
<li>“20”</li>
<li>“aaaaa”</li>
<li>“10”<br>127.0.0.1:6379&gt; zrem myzset aaaaa<br>(integer) 1<br>127.0.0.1:6379&gt; zrevrange myzset 0 100</li>
<li>“bbbbb”</li>
<li>“ccccc”<br>127.0.0.1:6379&gt; del myzset<br>(integer) 1<br>127.0.0.1:6379&gt; zrevrange myzset 0 100<br>(empty array)<br>127.0.0.1:6379&gt;<br>2.5.6 通用命令<br>命令<br>模糊查询键	keys *<br>删除多个键	del key [key …]<br>根据键判断记录是否存在	exists key[key …]<br>根据键判断值类型	type key<br>选择数据库	select index (0~15)<br>清空当前数据库	flushdb [ASYNC]<br>清空所有数据库	flushall [ASYNC]<br>2.6 Redis持久化<br>Redis的数据都是存在在内存之中的，那么这样一旦出现宕机，势必会导致数据的丢失，这就需要持久化操作，也就是要将redis在内存中的数据写到硬盘上保存。</li>
</ol>
<p>注意，redis虽然有持久化操作，但是其全部数据依旧都在内存中存在,也就是说硬盘上的只是为了安全和备份。</p>
<p>Redis提供了两种数据持久化的方式，分别是 RDB 和 AOF</p>
<p>RDB:默认开启</p>
<p>在redis运行期间，根据指定时间节点对内存的数据进行快照拍摄，持久化到磁盘文件(dump.rdb文件) 指定时间规则拍摄快照</p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>cat redis.conf | tail -n +265 | head -n 25    </p>
<p>################################ SNAPSHOTTING  ################################<br>#</p>
<h1 id="Save-the-DB-on-disk"><a href="#Save-the-DB-on-disk" class="headerlink" title="Save the DB on disk:"></a>Save the DB on disk:</h1><h1 id><a href="#" class="headerlink" title></a></h1><h1 id="save"><a href="#save" class="headerlink" title="save  "></a>save <seconds> <changes></changes></seconds></h1><h1 id="-1"><a href="#-1" class="headerlink" title></a></h1><h1 id="Will-save-the-DB-if-both-the-given-number-of-seconds-and-the-given"><a href="#Will-save-the-DB-if-both-the-given-number-of-seconds-and-the-given" class="headerlink" title="Will save the DB if both the given number of seconds and the given"></a>Will save the DB if both the given number of seconds and the given</h1><h1 id="number-of-write-operations-against-the-DB-occurred"><a href="#number-of-write-operations-against-the-DB-occurred" class="headerlink" title="number of write operations against the DB occurred."></a>number of write operations against the DB occurred.</h1><h1 id="-2"><a href="#-2" class="headerlink" title></a></h1><h1 id="In-the-example-below-the-behaviour-will-be-to-save"><a href="#In-the-example-below-the-behaviour-will-be-to-save" class="headerlink" title="In the example below the behaviour will be to save:"></a>In the example below the behaviour will be to save:</h1><h1 id="after-900-sec-15-min-if-at-least-1-key-changed"><a href="#after-900-sec-15-min-if-at-least-1-key-changed" class="headerlink" title="after 900 sec (15 min) if at least 1 key changed"></a>after 900 sec (15 min) if at least 1 key changed</h1><h1 id="after-300-sec-5-min-if-at-least-10-keys-changed"><a href="#after-300-sec-5-min-if-at-least-10-keys-changed" class="headerlink" title="after 300 sec (5 min) if at least 10 keys changed"></a>after 300 sec (5 min) if at least 10 keys changed</h1><h1 id="after-60-sec-if-at-least-10000-keys-changed"><a href="#after-60-sec-if-at-least-10000-keys-changed" class="headerlink" title="after 60 sec if at least 10000 keys changed"></a>after 60 sec if at least 10000 keys changed</h1><h1 id="-3"><a href="#-3" class="headerlink" title></a></h1><h1 id="Note-you-can-disable-saving-completely-by-commenting-out-all-“save”-lines"><a href="#Note-you-can-disable-saving-completely-by-commenting-out-all-“save”-lines" class="headerlink" title="Note: you can disable saving completely by commenting out all “save” lines."></a>Note: you can disable saving completely by commenting out all “save” lines.</h1><h1 id="-4"><a href="#-4" class="headerlink" title></a></h1><h1 id="It-is-also-possible-to-remove-all-the-previously-configured-save"><a href="#It-is-also-possible-to-remove-all-the-previously-configured-save" class="headerlink" title="It is also possible to remove all the previously configured save"></a>It is also possible to remove all the previously configured save</h1><h1 id="points-by-adding-a-save-directive-with-a-single-empty-string-argument"><a href="#points-by-adding-a-save-directive-with-a-single-empty-string-argument" class="headerlink" title="points by adding a save directive with a single empty string argument"></a>points by adding a save directive with a single empty string argument</h1><h1 id="like-in-the-following-example"><a href="#like-in-the-following-example" class="headerlink" title="like in the following example:"></a>like in the following example:</h1><h1 id="-5"><a href="#-5" class="headerlink" title></a></h1><h1 id="save-“”"><a href="#save-“”" class="headerlink" title="save “”"></a>save “”</h1><p>#1个key修改，15min后拍摄一次快照<br>save 900 1<br>#10个key修改，5min后拍摄一次快照<br>save 300 10<br>#10000个key修改，1min后拍摄一次快照<br>save 60 10000<br>AOF:默认关闭，需要手动开启</p>
<p>在redis运行期间，以日志记录的方式监听set操作，持久化到磁盘文件(appendonly.aof)</p>
<p>开启AOF:修改 redis.conf配置</p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>cat redis.conf | tail -n +1018 | head -n 53          </p>
<p>############################## APPEND ONLY MODE ###############################</p>
<p>……</p>
<h1 id="Please-check-http-redis-io-topics-persistence-for-more-information"><a href="#Please-check-http-redis-io-topics-persistence-for-more-information" class="headerlink" title="Please check http://redis.io/topics/persistence for more information."></a>Please check <a target="_blank" rel="noopener" href="http://redis.io/topics/persistence">http://redis.io/topics/persistence</a> for more information.</h1><p>#若开启设置为yes<br>appendonly no</p>
<h1 id="The-name-of-the-append-only-file-default-“appendonly-aof”"><a href="#The-name-of-the-append-only-file-default-“appendonly-aof”" class="headerlink" title="The name of the append only file (default: “appendonly.aof”)"></a>The name of the append only file (default: “appendonly.aof”)</h1><p>appendfilename “appendonly.aof”</p>
<h1 id="The-fsync-call-tells-the-Operating-System-to-actually-write-data-on-disk"><a href="#The-fsync-call-tells-the-Operating-System-to-actually-write-data-on-disk" class="headerlink" title="The fsync() call tells the Operating System to actually write data on disk"></a>The fsync() call tells the Operating System to actually write data on disk</h1><h1 id="instead-of-waiting-for-more-data-in-the-output-buffer-Some-OS-will-really-flush"><a href="#instead-of-waiting-for-more-data-in-the-output-buffer-Some-OS-will-really-flush" class="headerlink" title="instead of waiting for more data in the output buffer. Some OS will really flush"></a>instead of waiting for more data in the output buffer. Some OS will really flush</h1><h1 id="data-on-disk-some-other-OS-will-just-try-to-do-it-ASAP"><a href="#data-on-disk-some-other-OS-will-just-try-to-do-it-ASAP" class="headerlink" title="data on disk, some other OS will just try to do it ASAP."></a>data on disk, some other OS will just try to do it ASAP.</h1><h1 id="-6"><a href="#-6" class="headerlink" title></a></h1><p>……</p>
<p>#日志持久化机制</p>
<p>#每次执行set操作时都会持久化一次</p>
<h1 id="appendfsync-always"><a href="#appendfsync-always" class="headerlink" title="appendfsync always"></a>appendfsync always</h1><p>#每秒持久化一次<br>appendfsync everysec</p>
<p>#根据服务器，cpu处于idle情况，持久化一次</p>
<h1 id="appendfsync-no"><a href="#appendfsync-no" class="headerlink" title="appendfsync no"></a>appendfsync no</h1><p>2.6.1 知识小结<br>这二种持久化机制可以共存</p>
<p>RDB:把redis作为缓存来用	AOF:把redis作为独立数据库<br>优点	性能高	几乎不会丢失数据<br>缺点	可能会丢失部分数据	性能较差<br>2.7 应用场景<br>2.7.1 缓存<br>将一些经常访问但又不会经常修改的数据，进行缓存，提高查询效率</p>
<p>2.7.2 秒杀<br>浏览器	➡秒杀	redis服务器	➡同步	MySQL<br>商品		扣库存		同步数据<br>生成订单		<br>支付发货		<br>2.7.3 微博热搜<br>微博app	➡	redis<br>微博热搜		ZSet评分有序集合<br>2.7.4 分布式session<br>User	➡	Tomcat服务器	➡	redis<br>第一次访问	Server_1	设置	<br>User				User<br>第二次访问	Server_2	查询	<br>2.7.5 验证码存储<br>网站	➡	redis<br>发送短信		手机号:6位随机验证码<br>精准控制session只有5min<br>三.Jedis<br>3.1 Jedis使用<br>Redis作为一款优秀的缓存服务器存在，大多数语言都提供了连接Redis的驱动包，在java中，比较出名</p>
<p>的是Jedis和Redisson，我们今天以Jedis为例学习，看看如何是用程序操作redis。</p>
<p>常用API</p>
<p>方法	解释<br>new Jedis(host, port)	创建jedis对象，参数host是redis服务器地址，参数port是redis服务端口<br>set(key,value)	设置字符串类型的数据<br>get(key)	获得字符串类型的数据<br>hset(key,field,value)	设置哈希类型的数据<br>hget(key,field)	获得哈希类型的数据<br>lpush(key,values)	设置列表类型的数据<br>lpop(key)	列表左面弹栈<br>rpop(key)	列表右面弹栈<br>del(key)	删除指定的key<br>快速入门</p>
<p>导入相关坐标</p>
<p>1<br>2<br>3<br>4<br>5<br>6</p>
<!--jedis-->
<dependency>
  <groupId>redis.clients</groupId>
  <artifactId>jedis</artifactId>
  <version>2.9.0</version>
</dependency>
编写代码

<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>public class JedisTest {</p>
<p>  &#x2F;&#x2F; 快速入门之，向redis设置string类型的数据<br>  @Test<br>  public void testSet() throws Exception{<br>    &#x2F;&#x2F; 1.创建连接对象<br>    &#x2F;&#x2F; 默认连接 127.0.0.1 主机 和 6379 端口<br>    Jedis jedis &#x3D; new Jedis();<br>    &#x2F;&#x2F; 2.调用set方法设置数据<br>    jedis.set(“Java”, “Hello,World”);<br>    &#x2F;&#x2F; 3.释放资源<br>    jedis.close();<br>  }</p>
<p>  &#x2F;&#x2F; 快速入门之，查询string类型数据<br>  @Test<br>  public void testQuery() throws Exception{<br>    &#x2F;&#x2F; 1.创建连接对象<br>    Jedis jedis &#x3D; new Jedis();<br>    &#x2F;&#x2F; 2.调用get方法获取<br>    String java &#x3D; jedis.get(“Java”);<br>    System.out.println(java);<br>    &#x2F;&#x2F; 3.释放资源<br>    jedis.close();<br>  }<br>}<br>3.2 Jedis连接池<br>jedis连接资源的创建与销毁是非常消耗性能的，所以我们不希望频繁的创建和销毁它.基于这样的需求,就有了JedisPool技术。</p>
<p>快速入门</p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>public class JedisPoolTest {<br>  &#x2F;&#x2F; 测试jedis内置的连接池<br>  @Test<br>  public void testJedisPool() throws Exception {</p>
<pre><code>// 0.连接池配置对象
JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
// 最大连接数
jedisPoolConfig.setMaxTotal(100);
// 最大等待时间，单位是毫秒
jedisPoolConfig.setMaxWaitMillis(3000);
// 最大空闲连接数
jedisPoolConfig.setMaxIdle(10);

// 1.创建连接池对象
JedisPool jedisPool = new JedisPool();

// 2.从池中获取连接
Jedis jedis = jedisPool.getResource();

// 3.操作api
jedis.hset(&quot;myhash&quot;, &quot;id&quot;, &quot;1&quot;);

// 4.归还到连接池
jedis.close();
</code></pre>
<p>  }<br>}<br>抽取为连接池工具类</p>
<p>1<br>2<br>3<br>4<br>jedis.host&#x3D;localhost<br>jedis.port&#x3D;6379<br>jedis.maxTotal&#x3D;20<br>jedis.maxIdle&#x3D;10<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>public class JedisUtils {</p>
<p>  private static JedisPool jedisPool;</p>
<p>  private static String host;<br>  private static Integer port;<br>  private static Integer maxTotal;<br>  private static Integer maxIdle;</p>
<p>  &#x2F;&#x2F; 初始化连接池<br>  static {<br>    try {</p>
<pre><code>  ResourceBundle jedis = ResourceBundle.getBundle(&quot;jedis&quot;);

  // 读取配置文件给变量赋值
  // 获取类加载读取 jedis.properties 获取io流
  InputStream is = JedisUtils.class.getClassLoader().getResourceAsStream(&quot;jedis.properties&quot;);
  // 创建properties对象 加载io流
  Properties properties = new Properties();
  properties.load(is);
  // 给变量赋值
  host = properties.getProperty(&quot;jedis.host&quot;);
  port = Integer.parseInt(properties.getProperty(&quot;jedis.port&quot;));
  maxTotal = Integer.parseInt(properties.getProperty(&quot;jedis.maxTotal&quot;));
  maxIdle = Integer.parseInt(properties.getProperty(&quot;jedis.maxIdle&quot;));

  // 创建连接池配置对象
  JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
  jedisPoolConfig.setMaxTotal(maxTotal);
  jedisPoolConfig.setMaxIdle(maxIdle);
  // 创建连接池对象
  jedisPool = new JedisPool(jedisPoolConfig, host, port);
&#125; catch (IOException e) &#123;
  e.printStackTrace();
&#125;
</code></pre>
<p>  }</p>
<p>  &#x2F;&#x2F; 提供获取jedis连接的方法<br>  public static Jedis getJedis() {<br>    return jedisPool.getResource();<br>  }<br>}<br>四.<br>4.1 缓存：导航条分类<br>4.1.1 需求分析<br>前端页面	➡	JavaServer	➡	SQL<br>首页 门票 周边游		CategroyService	➡	NoSQL<br>先查询缓存(redis)，有就直接返回		redis<br>没有，再查MySQL，先同步到redis再返回	➡	MySQL<br>List<Categroy> list;<br>将list转为json数组字符串返回		<br>4.1.2 代码实现<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>public class CategoryServiceImpl implements CategoryService {<br>  @Override<br>  public List<Category> findAll() {</Category></Categroy></p>
<pre><code>//        SqlSession sqlSession = MyBatisUtils.openSession();
//        CategoryDao categoryDao = sqlSession.getMapper(CategoryDao.class);
//
//        List&lt;Category&gt; categoryList = categoryDao.findAll();
//
//        MyBatisUtils.close(sqlSession);

List&lt;Category&gt; categoryList = null;
ObjectMapper objectMapper = new ObjectMapper();

Jedis jedis = JedisUtils.getJedis();

if (jedis.exists(&quot;travel_category&quot;)) &#123;
  String json = jedis.get(&quot;travel_category&quot;);

  try &#123;
    categoryList = objectMapper.readValue(json, List.class);
    System.out.println(&quot;Find In Redis&quot;);
  &#125; catch (IOException e) &#123;
    e.printStackTrace();
  &#125;
&#125; else &#123;
  SqlSession sqlSession = MyBatisUtils.openSession();
  CategoryDao categoryDao = sqlSession.getMapper(CategoryDao.class);

  categoryList = categoryDao.findAll();

  MyBatisUtils.close(sqlSession);

  try &#123;
    String json = objectMapper.writeValueAsString(categoryList);
    jedis.set(&quot;travel_category&quot;, json);
  &#125; catch (IOException e) &#123;
    e.printStackTrace();
  &#125;

&#125;
jedis.close();


return categoryList;
</code></pre>
<p>  }<br>}<br>4.2 短信验证码存活时间5分钟<br>4.2.1 需求分析</p>
<p>4.2.2 代码实现<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>protected void sendSms(HttpServletRequest req, HttpServletResponse resp) throws IOException, ServletException {<br>  &#x2F;&#x2F; 1.获取请求参数<br>  String telephone &#x3D; req.getParameter(“telephone”);<br>  &#x2F;&#x2F; 2.生成6位随机数(apache提供的)<br>  String smsCode &#x3D; RandomStringUtils.randomNumeric(6);<br>  &#x2F;&#x2F; 3.调用service完成短信发送，返回resultInfo<br>  ResultInfo resultInfo &#x3D; userService.sendSms(telephone, smsCode);</p>
<p>  &#x2F;&#x2F; 4.如果发送成功，将验证码写入到session中<br>  &#x2F;&#x2F;        if (resultInfo.getSuccess()) {<br>  &#x2F;&#x2F;            req.getSession().setAttribute(“smsCode_” + telephone, smsCode);<br>  &#x2F;&#x2F;            System.out.println(“smsCode: “ + smsCode);<br>  &#x2F;&#x2F;        }</p>
<p>  &#x2F;&#x2F; 4.如果发送成功，将验证码写入到session中<br>  if (resultInfo.getSuccess()) {</p>
<pre><code>// a.获取jedis连接
Jedis jedis = JedisUtils.getJedis();

// b.将验证码设置到jedis中，存活1分钟
jedis.setex(&quot;smsCode_&quot; + telephone, 60, smsCode);

// c.释放资源
jedis.close();
System.out.println(&quot;smsCode: &quot; + smsCode);
</code></pre>
<p>  }<br>  javaToJsonWriteClient(resultInfo, resp);</p>
<p>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>41<br>42<br>43<br>44<br>45<br>46<br>47<br>48<br>protected void register(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {</p>
<p>  &#x2F;&#x2F; a.获取请求参数<br>  String telephone &#x3D; req.getParameter(“telephone”);<br>  String smsCode &#x3D; req.getParameter(“smsCode”);</p>
<p>  &#x2F;&#x2F; b.获取session中验证码<br>  &#x2F;&#x2F;        String sessionCode &#x3D; (String) req.getSession().getAttribute(“smsCode_” + telephone);</p>
<p>  Jedis jedis &#x3D; JedisUtils.getJedis();<br>  String sessionCode &#x3D; jedis.get(“smsCode_” + telephone);</p>
<p>  &#x2F;&#x2F; c.进行校验<br>  if (sessionCode &#x3D;&#x3D; null || (!sessionCode.equals(smsCode))) {</p>
<pre><code>// 验证码不正确
req.setAttribute(&quot;resultInfo&quot;, new ResultInfo(false, &quot;SMS Code not correct&quot;));
req.getRequestDispatcher(&quot;/register.jsp&quot;).forward(req, resp);
return;
</code></pre>
<p>  }</p>
<p>  &#x2F;&#x2F;获取请求参数<br>  Map&lt;String, String[]&gt; parameterMap &#x3D; req.getParameterMap();</p>
<p>  &#x2F;&#x2F;封装User中<br>  User param &#x3D; new User();</p>
<p>  try {<br>    BeanUtils.populate(param, parameterMap);<br>  } catch (Exception e) {<br>    throw new RuntimeException(“Entity class encapsulation failed”);<br>  }</p>
<p>  &#x2F;&#x2F;调用service，实现注册<br>  ResultInfo resultInfo &#x3D; userService.register(param);</p>
<p>  if (resultInfo.getSuccess()) {<br>    resp.sendRedirect(req.getContextPath() + “&#x2F;register_ok.jsp”);<br>    &#x2F;&#x2F;            req.getSession().removeAttribute(“smsCode_” + telephone);<br>    &#x2F;&#x2F; d.升级为，清除redis<br>    jedis.del(“smsCode” + telephone);<br>  } else {<br>    req.setAttribute(“resultInfo”, resultInfo);<br>    req.getRequestDispatcher(“&#x2F;register.jsp”).forward(req, resp);<br>  }<br>  jedis.close();<br>}</p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35<br>36<br>37<br>38<br>39<br>40<br>protected void telLogin(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br>  &#x2F;&#x2F; 1.接收请求参数telephone<br>  String telephone &#x3D; req.getParameter(“telephone”);</p>
<p>  &#x2F;&#x2F; 2.调用service查询<br>  User currentUser &#x3D; userService.findByTelephone(telephone);</p>
<p>  &#x2F;&#x2F; 3.校验手机号<br>  ResultInfo resultInfo &#x3D; null;</p>
<p>  &#x2F;&#x2F; 4.3 校验<br>  if (currentUser &#x3D;&#x3D; null) {<br>    resultInfo &#x3D; new ResultInfo(false, “Phone Number not Registered”);<br>  } else {<br>    &#x2F;&#x2F;成功<br>    String smsCode &#x3D; req.getParameter(“smsCode”);</p>
<pre><code>//            String sessionCode = (String) req.getSession().getAttribute(&quot;smsCode_&quot; + telephone);

// 升级为从redis中获取
Jedis jedis = JedisUtils.getJedis();
String sessionCode = jedis.get(&quot;smsCode_&quot; + telephone);

if (sessionCode == null || (!sessionCode.equals(smsCode))) &#123;
  resultInfo = new ResultInfo(false, &quot;Wrong SMS Code&quot;);
&#125; else &#123;
  req.getSession().setAttribute(&quot;currentUser&quot;, currentUser);
  // 清除session中验证码
  resultInfo = new ResultInfo(true, &quot;Login Success&quot;);

  //req.getSession().removeAttribute(&quot;smsCode_&quot; + telephone);
  // 清除redis中验证码
  jedis.del(&quot;smsCode_&quot; + telephone);
&#125;
// 释放资源
jedis.close();
</code></pre>
<p>  }<br>  &#x2F;&#x2F;将resultInfo转为Json响应到客户端<br>  javaToJsonWriteClient(resultInfo, resp);<br>}<br>总结</p>
<h2 id="一-NoSQL"><a href="#一-NoSQL" class="headerlink" title="一 NoSQL"></a>一 NoSQL</h2><h3 id="非关系型数据库，not-only-sql，弥补关系型数据库一些不足"><a href="#非关系型数据库，not-only-sql，弥补关系型数据库一些不足" class="headerlink" title="非关系型数据库，not only sql，弥补关系型数据库一些不足"></a>非关系型数据库，not only sql，弥补关系型数据库一些不足</h3><h3 id="特点："><a href="#特点：" class="headerlink" title="特点："></a>特点：</h3><ul>
<li>关系性</li>
</ul>
<p>​ - 1）数据之间存在关联关系</p>
<p>​ - 2）数据存储在硬盘</p>
<ul>
<li>非关系型</li>
</ul>
<p>​ - 1）数据之间不存在关联关系</p>
<p>​ - 2）数据存储在内存</p>
<h3 id="解决：互联和行业特点"><a href="#解决：互联和行业特点" class="headerlink" title="解决：互联和行业特点"></a>解决：互联和行业特点</h3><ul>
<li><p>高并发</p>
</li>
<li><p>高性能</p>
</li>
<li><p>高可用</p>
</li>
<li><p>海量数据</p>
</li>
</ul>
<h3 id="nosql分类"><a href="#nosql分类" class="headerlink" title="nosql分类"></a>nosql分类</h3><ul>
<li>键值对</li>
</ul>
<p>​ - redis</p>
<ul>
<li>文档类型（json）</li>
</ul>
<p>​ - mongoDB</p>
<ul>
<li>列存储</li>
</ul>
<p>​ - hbase</p>
<ul>
<li>图形（关系结构）</li>
</ul>
<h2 id="二-Redis"><a href="#二-Redis" class="headerlink" title="二 Redis"></a>二 Redis</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><ul>
<li>C语言编写高性能键值对数据库</li>
</ul>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><ul>
<li><p>string</p>
</li>
<li><p>hash</p>
</li>
<li><p>linkedList</p>
</li>
<li><p>hashset</p>
</li>
<li><p>linkedHashSet</p>
</li>
</ul>
<h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><ul>
<li>字符串</li>
</ul>
<p>​ - set key value</p>
<p>​ - get key</p>
<p>​ - del key</p>
<p>​ - setex key 存活时间 value</p>
<p>​ - incr key</p>
<p>​ - value+1</p>
<ul>
<li>哈希</li>
</ul>
<p>​ - hset key hkey hvalue</p>
<p>​ - hget key hkey</p>
<p>​ - hgetall key</p>
<p>​ - hrem key hkey</p>
<p>​ - del key</p>
<ul>
<li>列表</li>
</ul>
<p>​ - lpush key value</p>
<p>​ - rpush key value</p>
<p>​ - lrange key 0 -1</p>
<p>​ - lpop key</p>
<p>​ - rpop key</p>
<p>​ - del key</p>
<ul>
<li>集合</li>
</ul>
<p>​ - sadd key value</p>
<p>​ - smembers key</p>
<p>​ - srem key value</p>
<ul>
<li>有序集合</li>
</ul>
<p>​ - zadd key score value</p>
<p>​ - zrange key 0 -1 withscores</p>
<p>​ - zrevrange key 0 -1 withscores</p>
<p>​ - zrem key value</p>
<ul>
<li>通用命令</li>
</ul>
<p>​ - keys *</p>
<p>​ - del key1 key2 key3</p>
<p>​ - exists key</p>
<p>​ - type key</p>
<p>​ - select 0~15</p>
<p>​ - flushdb</p>
<p>​ - flushal</p>
<h3 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h3><ul>
<li>RDB</li>
</ul>
<p>​ - 默认开启，在指定间隔时间将内存的数据拍摄快照，持久化到磁盘</p>
<p>​ - 1）优点：性能高</p>
<p>​ - 2）缺点：丢失数据</p>
<ul>
<li>AOF</li>
</ul>
<p>​ - 手动开启，根据日志记录方式监听redis的写（set）操作，持久化到磁盘</p>
<p>​ - 1）优点：保证数据的安全</p>
<p>​ - 2）缺点：性能稍差</p>
<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><ul>
<li><p>1）缓存</p>
</li>
<li><p>2）秒杀</p>
</li>
<li><p>3）微博热搜</p>
</li>
<li><p>4）验证码存储</p>
</li>
<li><p>5）分布式session</p>
</li>
</ul>
<h2 id="三-Jedis"><a href="#三-Jedis" class="headerlink" title="三 Jedis"></a>三 Jedis</h2><h3 id="通过java语言操作redis，api与redis命令相似"><a href="#通过java语言操作redis，api与redis命令相似" class="headerlink" title="通过java语言操作redis，api与redis命令相似"></a>通过java语言操作redis，api与redis命令相似</h3><h3 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h3><ul>
<li><p>1）导入jar坐标</p>
</li>
<li><p>2）编写代码</p>
</li>
</ul>
<p>​ - &#x2F;&#x2F;1.创建连接对象</p>
<p>​ - &#x2F;&#x2F;2.操作api</p>
<p>​ - &#x2F;&#x2F;3.关闭连接</p>
<h3 id="Jedis连接池"><a href="#Jedis连接池" class="headerlink" title="Jedis连接池"></a>Jedis连接池</h3>
    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/05/14/Maven%E5%9F%BA%E7%A1%80/" rel="prev" title="Maven基础">
      <i class="fa fa-chevron-left"></i> Maven基础
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/05/25/Linux-Nginx/" rel="next" title="Linux & Nginx">
      Linux & Nginx <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#redis%E7%9A%84list%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8F%8C%E5%90%91%E5%88%97%E8%A1%A8"><span class="nav-number">1.</span> <span class="nav-text">redis的list是一个双向列表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Save-the-DB-on-disk"><span class="nav-number">2.</span> <span class="nav-text">Save the DB on disk:</span></a></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">3.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#save"><span class="nav-number">4.</span> <span class="nav-text">save  </span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#-1"><span class="nav-number">5.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Will-save-the-DB-if-both-the-given-number-of-seconds-and-the-given"><span class="nav-number">6.</span> <span class="nav-text">Will save the DB if both the given number of seconds and the given</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#number-of-write-operations-against-the-DB-occurred"><span class="nav-number">7.</span> <span class="nav-text">number of write operations against the DB occurred.</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#-2"><span class="nav-number">8.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#In-the-example-below-the-behaviour-will-be-to-save"><span class="nav-number">9.</span> <span class="nav-text">In the example below the behaviour will be to save:</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#after-900-sec-15-min-if-at-least-1-key-changed"><span class="nav-number">10.</span> <span class="nav-text">after 900 sec (15 min) if at least 1 key changed</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#after-300-sec-5-min-if-at-least-10-keys-changed"><span class="nav-number">11.</span> <span class="nav-text">after 300 sec (5 min) if at least 10 keys changed</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#after-60-sec-if-at-least-10000-keys-changed"><span class="nav-number">12.</span> <span class="nav-text">after 60 sec if at least 10000 keys changed</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#-3"><span class="nav-number">13.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Note-you-can-disable-saving-completely-by-commenting-out-all-%E2%80%9Csave%E2%80%9D-lines"><span class="nav-number">14.</span> <span class="nav-text">Note: you can disable saving completely by commenting out all “save” lines.</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#-4"><span class="nav-number">15.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#It-is-also-possible-to-remove-all-the-previously-configured-save"><span class="nav-number">16.</span> <span class="nav-text">It is also possible to remove all the previously configured save</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#points-by-adding-a-save-directive-with-a-single-empty-string-argument"><span class="nav-number">17.</span> <span class="nav-text">points by adding a save directive with a single empty string argument</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#like-in-the-following-example"><span class="nav-number">18.</span> <span class="nav-text">like in the following example:</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#-5"><span class="nav-number">19.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#save-%E2%80%9C%E2%80%9D"><span class="nav-number">20.</span> <span class="nav-text">save “”</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Please-check-http-redis-io-topics-persistence-for-more-information"><span class="nav-number">21.</span> <span class="nav-text">Please check http:&#x2F;&#x2F;redis.io&#x2F;topics&#x2F;persistence for more information.</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-name-of-the-append-only-file-default-%E2%80%9Cappendonly-aof%E2%80%9D"><span class="nav-number">22.</span> <span class="nav-text">The name of the append only file (default: “appendonly.aof”)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-fsync-call-tells-the-Operating-System-to-actually-write-data-on-disk"><span class="nav-number">23.</span> <span class="nav-text">The fsync() call tells the Operating System to actually write data on disk</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#instead-of-waiting-for-more-data-in-the-output-buffer-Some-OS-will-really-flush"><span class="nav-number">24.</span> <span class="nav-text">instead of waiting for more data in the output buffer. Some OS will really flush</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#data-on-disk-some-other-OS-will-just-try-to-do-it-ASAP"><span class="nav-number">25.</span> <span class="nav-text">data on disk, some other OS will just try to do it ASAP.</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#-6"><span class="nav-number">26.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#appendfsync-always"><span class="nav-number">27.</span> <span class="nav-text">appendfsync always</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#appendfsync-no"><span class="nav-number">28.</span> <span class="nav-text">appendfsync no</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80-NoSQL"><span class="nav-number">28.1.</span> <span class="nav-text">一 NoSQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8Cnot-only-sql%EF%BC%8C%E5%BC%A5%E8%A1%A5%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%80%E4%BA%9B%E4%B8%8D%E8%B6%B3"><span class="nav-number">28.1.1.</span> <span class="nav-text">非关系型数据库，not only sql，弥补关系型数据库一些不足</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="nav-number">28.1.2.</span> <span class="nav-text">特点：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%EF%BC%9A%E4%BA%92%E8%81%94%E5%92%8C%E8%A1%8C%E4%B8%9A%E7%89%B9%E7%82%B9"><span class="nav-number">28.1.3.</span> <span class="nav-text">解决：互联和行业特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nosql%E5%88%86%E7%B1%BB"><span class="nav-number">28.1.4.</span> <span class="nav-text">nosql分类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-Redis"><span class="nav-number">28.2.</span> <span class="nav-text">二 Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">28.2.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">28.2.2.</span> <span class="nav-text">数据类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4"><span class="nav-number">28.2.3.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96"><span class="nav-number">28.2.4.</span> <span class="nav-text">持久化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">28.2.5.</span> <span class="nav-text">应用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89-Jedis"><span class="nav-number">28.3.</span> <span class="nav-text">三 Jedis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87java%E8%AF%AD%E8%A8%80%E6%93%8D%E4%BD%9Credis%EF%BC%8Capi%E4%B8%8Eredis%E5%91%BD%E4%BB%A4%E7%9B%B8%E4%BC%BC"><span class="nav-number">28.3.1.</span> <span class="nav-text">通过java语言操作redis，api与redis命令相似</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="nav-number">28.3.2.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Jedis%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">28.3.3.</span> <span class="nav-text">Jedis连接池</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">swzxsyh</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">199</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/swzxsyh" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;swzxsyh" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/swzxsyh" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;swzxsyh" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">swzxsyh</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
