<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="入门 &amp; 版本控制 配置文件与框架集成，单元测试 自动配置，切换Jetty，自定义starter Listener &amp; Monitor 打包">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringBoot入门">
<meta property="og:url" content="http://yoursite.com/2020/07/11/SpringBoot%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="Swzxsyh">
<meta property="og:description" content="入门 &amp; 版本控制 配置文件与框架集成，单元测试 自动配置，切换Jetty，自定义starter Listener &amp; Monitor 打包">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-07-11T09:19:40.000Z">
<meta property="article:modified_time" content="2020-08-03T14:10:12.412Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2020/07/11/SpringBoot%E5%85%A5%E9%97%A8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SpringBoot入门 | Swzxsyh</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Swzxsyh</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">--学习笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/11/SpringBoot%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="学习笔记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Swzxsyh">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SpringBoot入门
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-07-11 17:19:40" itemprop="dateCreated datePublished" datetime="2020-07-11T17:19:40+08:00">2020-07-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-08-03 22:10:12" itemprop="dateModified" datetime="2020-08-03T22:10:12+08:00">2020-08-03</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <ul>
<li>入门 &amp; 版本控制</li>
<li>配置文件与框架集成，单元测试</li>
<li>自动配置，切换Jetty，自定义starter</li>
<li>Listener &amp; Monitor</li>
<li>打包</li>
</ul>
<a id="more"></a>

<h1 id="一-SpringBoot简介"><a href="#一-SpringBoot简介" class="headerlink" title="一.SpringBoot简介"></a>一.SpringBoot简介</h1><h4 id="1-1-Spring-Boot-整合了所有的框架以及中间件"><a href="#1-1-Spring-Boot-整合了所有的框架以及中间件" class="headerlink" title="1.1 Spring Boot 整合了所有的框架以及中间件"></a>1.1 Spring Boot 整合了所有的框架以及中间件</h4><p>SpringBoot不是对Spring功能的增强，而是提供一种快速使用Spring的开发方式。</p>
<ul>
<li>springboot与第三方框架以及MOM（中间件  MQ、Redis）进行了集成（整合）</li>
<li>开发过程中简化开发:<ul>
<li>无需编写框架相关以及框架整合配置文件了</li>
<li>jar无需管理</li>
</ul>
</li>
<li>springboot开发的程序：<ul>
<li>只需要“run”一下就能发布一个应用（项目启动起来）—内嵌tomcat</li>
<li>建议打jar包</li>
</ul>
</li>
</ul>
<h4 id="1-2-小结："><a href="#1-2-小结：" class="headerlink" title="1.2 小结："></a>1.2 小结：</h4><ul>
<li>快速构建项目（引入jar依赖）</li>
<li>对主流开发框架的无配置集成（开箱即用）</li>
<li>项目可独立运行，无需依赖外部的servlet容器（tomcat）</li>
<li>提供运行时的应用监控【dubbo  admin】</li>
<li>极大的提高了开发效率、部署效率</li>
</ul>
<h1 id="二-SpringBoot快速入门"><a href="#二-SpringBoot快速入门" class="headerlink" title="二.SpringBoot快速入门"></a>二.SpringBoot快速入门</h1><h4 id="2-1-需求"><a href="#2-1-需求" class="headerlink" title="2.1 需求"></a>2.1 需求</h4><p>开发一个web应用并完成字符串“hello boot”在浏览器显示。</p>
<h4 id="2-2-步骤"><a href="#2-2-步骤" class="headerlink" title="2.2 步骤"></a>2.2 步骤</h4><ul>
<li>创建jar工程</li>
<li>添加依赖<ul>
<li>添加starter-parent</li>
<li>添加web依赖（加载springmvc相关依赖）</li>
</ul>
</li>
<li>编写启动类</li>
<li>编写Controller</li>
</ul>
<h4 id="2-3-SpringBoot实现"><a href="#2-3-SpringBoot实现" class="headerlink" title="2.3 SpringBoot实现"></a>2.3 SpringBoot实现</h4><h5 id="2-3-1-构建工程方式一"><a href="#2-3-1-构建工程方式一" class="headerlink" title="2.3.1 构建工程方式一"></a>2.3.1 构建工程方式一</h5><h6 id="2-3-1-1-创建maven工程"><a href="#2-3-1-1-创建maven工程" class="headerlink" title="2.3.1.1 创建maven工程"></a>2.3.1.1 创建maven工程</h6><p>创建maven工程 springboot_day01_demo1_quickstart</p>
<ul>
<li><p>添加起步依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加起步依赖--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--该依赖中包含了集成主流框架的jar的版本--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加web依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加web依赖--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--该依赖中已包含了springmvc需要常见jar包--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="2-3-1-2-工程jar依赖情况"><a href="#2-3-1-2-工程jar依赖情况" class="headerlink" title="2.3.1.2 工程jar依赖情况"></a>2.3.1.2 工程jar依赖情况</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line">spring-boot-starter-2.1.4.RELEASE.jar</span><br><span class="line"><span class="comment">#springboot程序启动需要</span></span><br><span class="line">spring-boot-starter-web-2.1.4.RELEASE.jar</span><br><span class="line"><span class="comment">#Jackson解析</span></span><br><span class="line">spring-boot-starter-json-2.1.4.RELEASE.jar</span><br><span class="line"><span class="comment">#内嵌Tomcat服务器</span></span><br><span class="line">spring-boot-starter-tomcat-2.1.4.RELEASE.jar</span><br><span class="line"><span class="comment">#服务器数据校验</span></span><br><span class="line">hibernate-validator-6.0.16.Final.jar</span><br><span class="line"><span class="comment">#Springmvc相关依赖</span></span><br><span class="line">spring-web-5.1.6.RELEASE.jar</span><br><span class="line">spring-webmvc-5.1.6.RELEASE.jar</span><br></pre></td></tr></table></figure>

<h6 id="2-3-1-3-编写启动类"><a href="#2-3-1-3-编写启动类" class="headerlink" title="2.3.1.3 编写启动类"></a>2.3.1.3 编写启动类</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只需要run一下，就能发布一个springboot应用</span></span><br><span class="line"><span class="comment">// 相当于之前将web工程发布到tomcat服务器，只是在springboot中集成了tomcat插件</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickStartApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SpringApplication.run(QuickStartApplication<span class="class">.<span class="keyword">class</span>,<span class="title">args</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="2-3-1-4-编写HelloController"><a href="#2-3-1-4-编写HelloController" class="headerlink" title="2.3.1.4 编写HelloController"></a>2.3.1.4 编写HelloController</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/HelloController"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Done"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"AAA"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="2-3-1-5-测试"><a href="#2-3-1-5-测试" class="headerlink" title="2.3.1.5 测试"></a>2.3.1.5 测试</h6><p>运行main方法，访问 localhost:8080/springboot/hello</p>
<h4 id="2-4-总结"><a href="#2-4-总结" class="headerlink" title="2.4 总结"></a>2.4 总结</h4><p>springboot入门程序：</p>
<ul>
<li>创建工程</li>
<li>编写启动类</li>
<li>编写配置文件（application.properties/yml/yaml）</li>
<li>编写相关业务代码</li>
</ul>
<p>如有页面和静态资源：在resources目录下创建：<br>templates：存放HTML页面<br>static：存放静态资源</p>
<h1 id="三-SpringBoot版本控制原理"><a href="#三-SpringBoot版本控制原理" class="headerlink" title="三.SpringBoot版本控制原理"></a>三.SpringBoot版本控制原理</h1><p>版本控制（添加了parent工程   spring-boot-starter-parent    规定了jar的版本）</p>
<h4 id="3-1-spring-boot-starter-parent"><a href="#3-1-spring-boot-starter-parent" class="headerlink" title="3.1 spring-boot-starter-parent"></a>3.1 spring-boot-starter-parent</h4><p>起步依赖：SpringBoot工程继承Spring-boot-starter-parent后，已经锁定了版本等配置。起步依赖的作用是进行依赖传递 。</p>
<h4 id="3-2-SpringBootApplication"><a href="#3-2-SpringBootApplication" class="headerlink" title="3.2 @SpringBootApplication"></a>3.2 @SpringBootApplication</h4><p>复合注解,内部如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="comment">//与之前@Configuration注解一样，声明为一个配置类</span></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="comment">/**自动配置</span></span><br><span class="line"><span class="comment">*自动将相关的bean注册到spring IoC容器中</span></span><br><span class="line"><span class="comment">*开发人员可以直接使用jedis/jedispool/jediscluster/RedisTemplate/JdbcTemplate</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="comment">//spring IoC容器的扫描包，默认扫描引导程序下的包以及子包，如果我们写的程序不在该包范围内，可以通过该注解指定。</span></span><br><span class="line"><span class="meta">@ComponentScan</span>(</span><br><span class="line">  excludeFilters = &#123;<span class="meta">@Filter</span>(</span><br><span class="line">    type = FilterType.CUSTOM,</span><br><span class="line">    classes = &#123;TypeExcludeFilter<span class="class">.<span class="keyword">class</span>&#125;</span></span><br><span class="line"><span class="class">  ), @<span class="title">Filter</span>(</span></span><br><span class="line"><span class="class">    <span class="title">type</span> </span>= FilterType.CUSTOM,</span><br><span class="line">    classes = &#123;AutoConfigurationExcludeFilter<span class="class">.<span class="keyword">class</span>&#125;</span></span><br><span class="line"><span class="class">  )&#125;</span></span><br><span class="line"><span class="class">)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>自动装配：最好不配置，默认的配置都给配好了。</li>
</ul>
<h1 id="四-SpringBoot配置文件使用"><a href="#四-SpringBoot配置文件使用" class="headerlink" title="四.SpringBoot配置文件使用"></a>四.SpringBoot配置文件使用</h1><p>springboot应用配置文件格式：两种     </p>
<ul>
<li>系统级别<ul>
<li>bootstrap.properites</li>
</ul>
</li>
<li>应用级别<ul>
<li>application.properties/application.yml/yaml</li>
</ul>
</li>
</ul>
<h4 id="4-1-application-properties"><a href="#4-1-application-properties" class="headerlink" title="4.1 application.properties"></a>4.1 application.properties</h4><h5 id="4-1-1-语法"><a href="#4-1-1-语法" class="headerlink" title="4.1.1 语法"></a>4.1.1 语法</h5><ul>
<li><p>格式：key=value</p>
</li>
<li><p>如果是修改SpringBoot中的默认配置，那么key则不能任意编写，必须参考SpringBoot官方文档。</p>
</li>
<li><p>application.properties官方文档</p>
<p>docs.spring.io/spring-boot/docs/2.1.14.RELEASE/reference/html</p>
</li>
</ul>
<h5 id="4-1-2-案例"><a href="#4-1-2-案例" class="headerlink" title="4.1.2 案例"></a>4.1.2 案例</h5><p>在springboot-day01-demo1-quickstart工程的resources目录下添加application.properties文件</p>
<ul>
<li><p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#tomcat port</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8081</span></span><br><span class="line"><span class="comment">#app context</span></span><br><span class="line"><span class="meta">server.servlet.context-path</span>=<span class="string">/demo</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>启动后地址更改为 localhost:8081/demo/springboot/hello</p>
<h4 id="4-2-application-yml-yaml"><a href="#4-2-application-yml-yaml" class="headerlink" title="4.2 application.yml/yaml"></a>4.2 application.yml/yaml</h4><h5 id="4-2-1-语法"><a href="#4-2-1-语法" class="headerlink" title="4.2.1 语法"></a>4.2.1 语法</h5><ul>
<li>要求：<ul>
<li>区分大小写</li>
<li>数据值前必须有空格，作为分隔符</li>
<li>缩进的空格数目不重要，只需要对齐即可</li>
</ul>
</li>
</ul>
<h4 id="4-2-2-案例"><a href="#4-2-2-案例" class="headerlink" title="4.2.2 案例"></a>4.2.2 案例</h4><p><strong>首先</strong>删除application.properties文件，properties优先级高于yml/yaml，会被覆盖</p>
<ul>
<li><p>application.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8082</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/testYaml</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="4-3-获取配置文件中的值"><a href="#4-3-获取配置文件中的值" class="headerlink" title="4.3 获取配置文件中的值"></a>4.3 获取配置文件中的值</h4><ul>
<li>获取值的方式：<ul>
<li>@Value注解的方式</li>
<li>注入Environment的方式</li>
<li>@ConfigurationProperties</li>
</ul>
</li>
</ul>
<h5 id="4-3-1-在yml文件中配置如下内容"><a href="#4-3-1-在yml文件中配置如下内容" class="headerlink" title="4.3.1 在yml文件中配置如下内容"></a>4.3.1 在yml文件中配置如下内容</h5><ul>
<li><p>application.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本格式 key: value</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">A</span></span><br><span class="line"><span class="comment"># 数组   - 用于区分</span></span><br><span class="line"><span class="attr">city:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">B</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">C</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">D</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">E</span></span><br><span class="line"><span class="comment"># 集合中的元素是对象形式</span></span><br><span class="line"><span class="attr">students:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">F</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">18</span></span><br><span class="line">    <span class="attr">score:</span> <span class="number">99.99</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">G</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">19</span></span><br><span class="line">    <span class="attr">score:</span> <span class="number">88</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">H</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">20</span></span><br><span class="line">    <span class="attr">score:</span> <span class="number">90</span></span><br><span class="line"><span class="comment"># map集合形式</span></span><br><span class="line"><span class="attr">maps:</span> <span class="string">&#123;"name":"I",</span> <span class="attr">"age":</span> <span class="number">21</span><span class="string">&#125;</span></span><br><span class="line"><span class="comment"># 参数引用</span></span><br><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">$&#123;name&#125;</span> <span class="comment"># 该值可以获取到上边的name定义的值</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="4-3-2-通过-Value取值"><a href="#4-3-2-通过-Value取值" class="headerlink" title="4.3.2 通过@Value取值"></a>4.3.2 通过@Value取值</h5><ul>
<li><p>HelloController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/HelloController"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"$&#123;name&#125;"</span>)</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"$&#123;city[0]&#125;"</span>)</span><br><span class="line">  <span class="keyword">private</span> String city0;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"$&#123;students[1].name&#125;"</span>)</span><br><span class="line">  <span class="keyword">private</span> String student1Name;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"$&#123;maps.age&#125;"</span>)</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Value</span>(<span class="string">"$&#123;person.name&#125;"</span>)</span><br><span class="line">  <span class="keyword">private</span> String personName;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Done"</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(name);</span><br><span class="line">    System.out.println(city0);</span><br><span class="line">    System.out.println(student1Name);</span><br><span class="line">    System.out.println(age);</span><br><span class="line">    System.out.println(personName);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"AAA"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="4-3-3-通过Environment取值"><a href="#4-3-3-通过Environment取值" class="headerlink" title="4.3.3 通过Environment取值"></a>4.3.3 通过Environment取值</h5><ul>
<li><p>HelloController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/HelloController"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 通过注入Environment取值</span></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> Environment env;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@RequestMapping</span>(<span class="string">"/hello2"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Done"</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(env.getProperty(<span class="string">"name"</span>));</span><br><span class="line">    System.out.println(env.getProperty(<span class="string">"city[0]"</span>));</span><br><span class="line">    System.out.println(env.getProperty(<span class="string">"students[1].name"</span>));</span><br><span class="line">    System.out.println(env.getProperty(<span class="string">"maps.age"</span>));</span><br><span class="line">    System.out.println(env.getProperty(<span class="string">"person.name"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"BBB"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="4-3-4-ConfigurationProperties取值"><a href="#4-3-4-ConfigurationProperties取值" class="headerlink" title="4.3.4@ConfigurationProperties取值"></a>4.3.4@ConfigurationProperties取值</h5><ul>
<li><p>作用：前缀定义了哪些外部属性将绑定到指定类的字段上</p>
</li>
<li><p>使用场景：</p>
<ul>
<li>如果只是某个业务中需要获取配置文件中的某项值或者设置具体值，可以使用@Value或Environment；</li>
<li>如果一个JavaBean中大量属性值要和配置文件进行映射，可以使用@ConfigurationProperties；</li>
</ul>
</li>
</ul>
<h6 id="4-3-4-1-在yml文件中添加如下内容"><a href="#4-3-4-1-在yml文件中添加如下内容" class="headerlink" title="4.3.4.1 在yml文件中添加如下内容"></a>4.3.4.1 在yml文件中添加如下内容</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">myapp:</span></span><br><span class="line">  <span class="attr">mail:</span></span><br><span class="line">    <span class="attr">address:</span> <span class="string">abc@test.com</span></span><br><span class="line">    <span class="attr">message:</span> <span class="string">This</span> <span class="string">is</span> <span class="string">test</span></span><br></pre></td></tr></table></figure>

<h6 id="4-3-4-2-创建一个pojo"><a href="#4-3-4-2-创建一个pojo" class="headerlink" title="4.3.4.2 创建一个pojo"></a>4.3.4.2 创建一个pojo</h6><ul>
<li><p>Mail.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"myapp.mail"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mail</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String address;</span><br><span class="line">  <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line"><span class="comment">//TODO getter &amp; setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="4-3-4-3-取值"><a href="#4-3-4-3-取值" class="headerlink" title="4.3.4.3 取值"></a>4.3.4.3 取值</h6><ul>
<li><p>HelloController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/HelloController"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> Mail mail;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@RequestMapping</span>(<span class="string">"/hello3"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">hello3</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Done"</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(mail.getAddress());</span><br><span class="line">    System.out.println(mail.getMessage());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"CCC"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="4-4-spring-profiles-active指定开发环境"><a href="#4-4-spring-profiles-active指定开发环境" class="headerlink" title="4.4 spring.profiles.active指定开发环境"></a>4.4 spring.profiles.active指定开发环境</h4><ul>
<li>spring.profiles.active=test/dev/pro<ul>
<li>test，测试环境</li>
<li>dev，开发环境</li>
<li>pro，生产环境</li>
</ul>
</li>
</ul>
<h5 id="4-4-1-properties文件"><a href="#4-4-1-properties文件" class="headerlink" title="4.4.1 properties文件"></a>4.4.1 properties文件</h5><ul>
<li><p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定开发环境 test：测试环境  dev：开发环境  pro：生产环境</span></span><br><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">test</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application-dev.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8082</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application-pro.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8081</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application-test.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8080</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="五-SpringBoot与其他框架集成"><a href="#五-SpringBoot与其他框架集成" class="headerlink" title="五.SpringBoot与其他框架集成"></a>五.SpringBoot与其他框架集成</h1><h4 id="5-1-集成mybatis"><a href="#5-1-集成mybatis" class="headerlink" title="5.1 集成mybatis"></a>5.1 集成mybatis</h4><h5 id="5-1-1-需求"><a href="#5-1-1-需求" class="headerlink" title="5.1.1 需求"></a>5.1.1 需求</h5><p>查询所有用户列表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">create database springboot_quickstart;</span><br><span class="line">use springboot_quickstart;</span><br><span class="line"></span><br><span class="line">DROP TABLE IF EXISTS &#96;user&#96;;</span><br><span class="line">CREATE TABLE &#96;user&#96; (</span><br><span class="line">  &#96;id&#96; int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  &#96;username&#96; varchar(50) DEFAULT NULL,</span><br><span class="line">  &#96;password&#96; varchar(50) DEFAULT NULL,</span><br><span class="line">  &#96;address&#96; varchar(50) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;id&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8;</span><br><span class="line"></span><br><span class="line">INSERT INTO &#96;user&#96; VALUES (&#39;1&#39;, &#39;zhangsan&#39;, &#39;123&#39;, &#39;北京&#39;);</span><br><span class="line">INSERT INTO &#96;user&#96; VALUES (&#39;2&#39;, &#39;lisi&#39;, &#39;123&#39;, &#39;上海&#39;);</span><br></pre></td></tr></table></figure>

<h5 id="5-1-2-创建Maven工程并添加依赖"><a href="#5-1-2-创建Maven工程并添加依赖" class="headerlink" title="5.1.2 创建Maven工程并添加依赖"></a>5.1.2 创建Maven工程并添加依赖</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="5-1-3-编写启动类"><a href="#5-1-3-编写启动类" class="headerlink" title="5.1.3 编写启动类"></a>5.1.3 编写启动类</h5><ul>
<li><p>MybatisApplication</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SpringApplication.run(MybatisApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-1-4-添加application-properties文件"><a href="#5-1-4-添加application-properties文件" class="headerlink" title="5.1.4 添加application.properties文件"></a>5.1.4 添加application.properties文件</h5><ul>
<li><p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#连接数据库</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost/springboot_quickstart?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">root</span></span><br><span class="line"><span class="comment">#mybatis别名</span></span><br><span class="line"><span class="meta">mybatis.type-aliases-package</span>=<span class="string">com.test.pojo</span></span><br><span class="line"><span class="comment">#加载映射文件</span></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:mapper/*.xml</span></span><br><span class="line"><span class="comment">#设置日志，com.test：只查看该包下程序的日志</span></span><br><span class="line"><span class="meta">logging.level.com.test</span>=<span class="string">debug</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-1-5-编写pojo"><a href="#5-1-5-编写pojo" class="headerlink" title="5.1.5 编写pojo"></a>5.1.5 编写pojo</h5><ul>
<li><p>User.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="comment">// TODO getters、setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-1-6-编写mapper接口以及映射文件"><a href="#5-1-6-编写mapper接口以及映射文件" class="headerlink" title="5.1.6 编写mapper接口以及映射文件"></a>5.1.6 编写mapper接口以及映射文件</h5><ul>
<li><p>在接口中添加<strong>@Mapper</strong>注解（标记该类是一个Mapper接口，可以被SpringBoot自动扫描）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findUsers</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写映射文件：在工程的resources/mapper目录下创建UserDao.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.test.dao.UserDao"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUsers"</span> <span class="attr">resultType</span>=<span class="string">"com.test.pojo.User"</span>&gt;</span></span><br><span class="line">    SELECT * FROM user</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-1-7-编写service接口以及实现类"><a href="#5-1-7-编写service接口以及实现类" class="headerlink" title="5.1.7 编写service接口以及实现类"></a>5.1.7 编写service接口以及实现类</h5><ul>
<li><p>UserService.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findUsers</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>UserServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span>(required = <span class="keyword">false</span>)</span><br><span class="line">  <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> userDao.findUsers();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-1-8-编写controller"><a href="#5-1-8-编写controller" class="headerlink" title="5.1.8 编写controller"></a>5.1.8 编写controller</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@RequestMapping</span>(<span class="string">"/findUsers"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUsers</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"AAAAA"</span>);</span><br><span class="line">    List&lt;User&gt; users = userService.findUsers();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> users;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-集成Spring-Data-Redis"><a href="#5-2-集成Spring-Data-Redis" class="headerlink" title="5.2 集成Spring Data Redis"></a>5.2 集成Spring Data Redis</h4><ul>
<li><p>Spring Data</p>
<p>Spring 的一个子项目。用于简化数据库访问，支持NoSQL和关系数据库存储。其主要目标是使数据库的访问变得方便快捷。 </p>
</li>
</ul>
<h5 id="5-2-1-在同一工程Maven文件中配置Redis启动器"><a href="#5-2-1-在同一工程Maven文件中配置Redis启动器" class="headerlink" title="5.2.1 在同一工程Maven文件中配置Redis启动器"></a>5.2.1 在同一工程Maven文件中配置Redis启动器</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--redis--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--json解析--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.51<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="5-2-2-配置application-properties"><a href="#5-2-2-配置application-properties" class="headerlink" title="5.2.2 配置application.properties"></a>5.2.2 配置application.properties</h5><ul>
<li><p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#redis，本地可以不配置，默认配置</span></span><br><span class="line"><span class="meta">spring.redis.host</span>=<span class="string">localhost</span></span><br><span class="line"><span class="meta">spring.redis.port</span>=<span class="string">6379</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-2-3-更新UserServiceImpl"><a href="#5-2-3-更新UserServiceImpl" class="headerlink" title="5.2.3 更新UserServiceImpl"></a>5.2.3 更新UserServiceImpl</h5><ul>
<li><p>UserServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span>(required = <span class="keyword">false</span>)</span><br><span class="line">  <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 首先判断缓存中是否有数据</span></span><br><span class="line">    String text = stringRedisTemplate.boundValueOps(<span class="string">"A:springboot:user:id:1"</span>).get();</span><br><span class="line">    List&lt;User&gt; users = JSON.parseArray(text, User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="keyword">if</span> (users == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="comment">// 从数据库中查询</span></span><br><span class="line">      users = userDao.findUsers();</span><br><span class="line">      <span class="comment">// 放入缓存      		</span></span><br><span class="line">      stringRedisTemplate.boundValueOps(<span class="string">"A:springboot:user:id:1"</span>).set(JSON.toJSONString(users));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> users;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="5-2-5-扩展-了解"><a href="#5-2-5-扩展-了解" class="headerlink" title="5.2.5 扩展-了解"></a>5.2.5 扩展-了解</h5><ul>
<li><p>使用RedisTemplate对象操作Redis服务，代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;User&gt; users = (List&lt;User&gt;) redisTemplate.boundValueOps(<span class="string">"A:springboot:user:id:1"</span>).get();</span><br><span class="line">    <span class="keyword">if</span> (users == <span class="keyword">null</span>) &#123;</span><br><span class="line">        users = userDao.findUsers();</span><br><span class="line">        redisTemplate.boundValueOps(<span class="string">"A:springboot:user:id:1"</span>).set(users);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> users;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>需要对User实现序列化接口，否则报未序列化错误，同时清除缓存，否则报序列号错误</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Integer id;</span><br><span class="line">  <span class="keyword">private</span> String username;</span><br><span class="line">  <span class="keyword">private</span> String password;</span><br><span class="line">  <span class="keyword">private</span> String address;</span><br><span class="line">  <span class="comment">//TODO getter/setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>RedisTemplate 和 StringRedisTemplate的区别</p>
<ul>
<li><p>RedisTemplate 的序列化采用的是 JdkSerializationRedisSerializer,在存储到 Redis 的时候会将 对象 序列化为 字节数组</p>
</li>
<li><p>StringRedisTemplate 的序列化采用的是 StringRedisSerializer,适用于存储的 value 为 String 的情况</p>
</li>
<li><p>结论：<br>Redis 中存储对象使用 RedisTemplate ，存储字符串使用 StringRedisTemplate</p>
<p>JdkSerializationRedisSerializer 和 StringRedisSerializer</p>
<ul>
<li><p>JdkSerializationRedisSerializer底层还是通过调用JDK的IO操作ObjectInputStream和ObjectOutputStream类实现POJO的序列化和反序列化，优点是反序列化时不需要提供类型信息(class)，但缺点是需要实现Serializable接口，还有序列化后的结果非常庞大，是JSON格式的5倍左右，这样就会消耗redis服务器的大量内存。</p>
</li>
<li><p>使用Jackson库将对象序列化为JSON字符串。优点是速度快，序列化后的字符串短小精悍，不需要实现Serializable接口。但缺点也非常致命，那就是此类的构造函数中有一个类型参数，必须提供要序列化对象的类型信息(.class对象)</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="5-3-集成定时器"><a href="#5-3-集成定时器" class="headerlink" title="5.3 集成定时器"></a>5.3 集成定时器</h4><ul>
<li><p>在SpringBoot启动类中添加开启定时任务注解：@EnableScheduling</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableScheduling</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SpringApplication.run(MybatisApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>TimeProgarm.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeProgarm</span> </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 掌握：cron表达式是一个字符串，字符串以5或6个空格隔开，分开共6或7个域，每一个域代表一个含义</span></span><br><span class="line"><span class="comment">     *  [秒] [分] [小时] [日] [月] [周] [年]</span></span><br><span class="line"><span class="comment">     *  [年]不是必须的域，可以省略[年]，则一共7个域</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 了解：</span></span><br><span class="line"><span class="comment">     *  fixedDelay：上一次执行完毕时间点之后多长时间再执行（单位：毫秒）</span></span><br><span class="line"><span class="comment">     *  fixedDelayString：同等，唯一不同的是支持占位符，在配置文件中必须有time.fixedDelay=5000</span></span><br><span class="line"><span class="comment">     *  fixedRate：上一次开始执行时间点之后多长时间再执行</span></span><br><span class="line"><span class="comment">     *  fixedRateString：同等，唯一不同的是支持占位符</span></span><br><span class="line"><span class="comment">     *  initialDelay：第一次延迟多长时间后再执行</span></span><br><span class="line"><span class="comment">     *  initialDelayString：同等，唯一不同的是支持占位符</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">  <span class="comment">//    @Scheduled(fixedDelay = 5000)</span></span><br><span class="line">  <span class="comment">//    @Scheduled(fixedDelayString = "5000")</span></span><br><span class="line">  <span class="comment">//    @Scheduled(fixedDelayString = "$&#123;time.fixedDelay&#125;")</span></span><br><span class="line">  <span class="comment">//    @Scheduled(fixedRate = 5000)</span></span><br><span class="line">  <span class="comment">//    // 第一次延迟1秒后执行，之后按fixedRate的规则每5秒执行一次</span></span><br><span class="line">  <span class="comment">//    @Scheduled(initialDelay=1000, fixedRate=5000)</span></span><br><span class="line">  <span class="meta">@Scheduled</span>(cron = <span class="string">"30 45 15 08 07 *"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myTask</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"DDD"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="5-4-集成单元测试"><a href="#5-4-集成单元测试" class="headerlink" title="5.4 集成单元测试"></a>5.4 集成单元测试</h4><h5 id="5-4-1-添加依赖"><a href="#5-4-1-添加依赖" class="headerlink" title="5.4.1 添加依赖"></a>5.4.1 添加依赖</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="5-4-2-编写单元测试"><a href="#5-4-2-编写单元测试" class="headerlink" title="5.4.2 编写单元测试"></a>5.4.2 编写单元测试</h5><ul>
<li><p>单元测试类需要在启动类包或者子包下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoad</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userService.findUsers();</span><br><span class="line">        <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="六-SpringBoot自动配置使用"><a href="#六-SpringBoot自动配置使用" class="headerlink" title="六.SpringBoot自动配置使用"></a>六.SpringBoot自动配置使用</h1><h4 id="6-1-自动注入RedisTemplate"><a href="#6-1-自动注入RedisTemplate" class="headerlink" title="6.1 自动注入RedisTemplate"></a>6.1 自动注入RedisTemplate</h4><h5 id="6-1-1-需求"><a href="#6-1-1-需求" class="headerlink" title="6.1.1 需求"></a>6.1.1 需求</h5><h5 id="6-1-2-代码实现"><a href="#6-1-2-代码实现" class="headerlink" title="6.1.2 代码实现"></a>6.1.2 代码实现</h5><h6 id="6-1-2-1-创建maven工程并添加依赖"><a href="#6-1-2-1-创建maven工程并添加依赖" class="headerlink" title="6.1.2.1 创建maven工程并添加依赖"></a>6.1.2.1 创建maven工程并添加依赖</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--加入springboot的starter起步依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Redis依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="6-1-2-2-创建启动类"><a href="#6-1-2-2-创建启动类" class="headerlink" title="6.1.2.2 创建启动类"></a>6.1.2.2 创建启动类</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoConfigApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 获取Spring IoC容器</span></span><br><span class="line">        ConfigurableApplicationContext context = SpringApplication.run(AutoConfigApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">        <span class="comment">// 获取容器中的bean</span></span><br><span class="line">        Object redisTemplate = context.getBean(<span class="string">"redisTemplate"</span>);</span><br><span class="line">        System.out.println(redisTemplate);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-1-2-3-启动服务并测试"><a href="#6-1-2-3-启动服务并测试" class="headerlink" title="6.1.2.3 启动服务并测试"></a>6.1.2.3 启动服务并测试</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.data.redis.core.RedisTemplate@5d1b9c3d</span><br></pre></td></tr></table></figure>

<p>如果将pom文件中的redis启动器的依赖给注释掉，我们在启动服务则报错</p>
<h5 id="6-1-3-总结"><a href="#6-1-3-总结" class="headerlink" title="6.1.3 总结"></a>6.1.3 总结</h5><p>通过SpringBoot开发程序，需要获取Spring容器中注册的Bean，那么我们只需要在pom文件中添加相关的启动器即可。如果没有该启动器，我们可以自定义。</p>
<h5 id="6-2-Spring之Conditional条件注解"><a href="#6-2-Spring之Conditional条件注解" class="headerlink" title="6.2 Spring之Conditional条件注解"></a>6.2 Spring之Conditional条件注解</h5><blockquote>
<p>Conditional 是在spring4.0 增加的条件注解，当你注册bean时，可以对这个bean添加一定的自定义条件，当满足这个条件时，注册这个bean，否则不注册。</p>
</blockquote>
<h5 id="6-2-1-需求"><a href="#6-2-1-需求" class="headerlink" title="6.2.1 需求"></a>6.2.1 需求</h5><p>在Spring的IoC容器中注入User的Bean，但是要求如下：</p>
<ul>
<li>如果pom文件中依赖了Jedis则创建该User实例</li>
<li>如果pom文件中没有依赖了Jedis则不创建该User实例</li>
</ul>
<h5 id="6-2-2-代码实现"><a href="#6-2-2-代码实现" class="headerlink" title="6.2.2 代码实现"></a>6.2.2 代码实现</h5><h6 id="6-2-2-1-添加依赖"><a href="#6-2-2-1-添加依赖" class="headerlink" title="6.2.2.1 添加依赖"></a>6.2.2.1 添加依赖</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Jedis依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="6-2-2-2-创建User对象"><a href="#6-2-2-2-创建User对象" class="headerlink" title="6.2.2.2 创建User对象"></a>6.2.2.2 创建User对象</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-2-2-3-创建ClassCondition"><a href="#6-2-2-3-创建ClassCondition" class="headerlink" title="6.2.2.3 创建ClassCondition"></a>6.2.2.3 创建ClassCondition</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassCondition</span> <span class="keyword">implements</span> <span class="title">Condition</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(ConditionContext conditionContext, AnnotatedTypeMetadata annotatedTypeMetadata)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="comment">// 判断是否有该jedis字节码</span></span><br><span class="line">      Class&lt;?&gt; aClass = Class.forName(<span class="string">"redis.clients.jedis.Jedis"</span>);</span><br><span class="line">      flag=<span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-2-2-3-创建配置类"><a href="#6-2-2-3-创建配置类" class="headerlink" title="6.2.2.3 创建配置类"></a>6.2.2.3 创建配置类</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="comment">// 判断ClassCondition中内容是否成立，如果成立则创建user的bean，否则不创建</span></span><br><span class="line">  <span class="meta">@Conditional</span>(value = &#123;ClassCondition<span class="class">.<span class="keyword">class</span>&#125;)</span></span><br><span class="line"><span class="class">  <span class="title">public</span> <span class="title">User</span> <span class="title">user</span>() </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6-2-3-代码优化"><a href="#6-2-3-代码优化" class="headerlink" title="6.2.3 代码优化"></a>6.2.3 代码优化</h5><p>在ClassCondition类中，只能判断是否有jedis依赖，我们的代码硬编码了。因此我们可以对该程序优化。</p>
<h6 id="6-2-3-1-分析"><a href="#6-2-3-1-分析" class="headerlink" title="6.2.3.1 分析"></a>6.2.3.1 分析</h6><p>在实现类ClassCondition的matches方法中有个annotationTypeMetadata参数，而该参数的作用是获取注解中的属性值的。那么我们可以从这里下手。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**     </span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> conditionContext      上下文对象，获取属性值、获取类加载器、获取BeanFactory</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> annotatedTypeMetadata 元数据对象，获取注解属性</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(ConditionContext conditionContext, AnnotatedTypeMetadata annotatedTypeMetadata)</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-2-3-2-自定义Conditional注解"><a href="#6-2-3-2-自定义Conditional注解" class="headerlink" title="6.2.3.2 自定义Conditional注解"></a>6.2.3.2 自定义Conditional注解</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注解的作用目标</span></span><br><span class="line"><span class="comment">//@Target(ElementType.TYPE)——接口、类、枚举、注解</span></span><br><span class="line"><span class="comment">//@Target(ElementType.METHOD)——方法</span></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE, ElementType.METHOD&#125;)</span><br><span class="line"><span class="comment">//@Retention作用是定义被它所注解的注解声明周期</span></span><br><span class="line"><span class="comment">//注解不仅被保存到class文件中，jvm加载class文件之后，仍然存在</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="comment">//生成接口文档带有注释</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Conditional</span>(value = &#123;ClassCondition<span class="class">.<span class="keyword">class</span>&#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> @<span class="title">interface</span> <span class="title">ConditionOnClass</span> </span>&#123;</span><br><span class="line">    String[] value() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-2-3-3-修改UserConfig"><a href="#6-2-3-3-修改UserConfig" class="headerlink" title="6.2.3.3 修改UserConfig"></a>6.2.3.3 修改UserConfig</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="comment">// 判断ClassCondition中内容是否成立，如果成立则创建user的bean，否则不创建</span></span><br><span class="line">  <span class="meta">@ConditionOnClass</span>(value = &#123;<span class="string">"redis.clients.jedis.Jedis"</span>&#125;)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-2-3-4-修改ClassCondition"><a href="#6-2-3-4-修改ClassCondition" class="headerlink" title="6.2.3.4 修改ClassCondition"></a>6.2.3.4 修改ClassCondition</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassCondition</span> <span class="keyword">implements</span> <span class="title">Condition</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(ConditionContext conditionContext, AnnotatedTypeMetadata annotatedTypeMetadata)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Map&lt;String, Object&gt; map = annotatedTypeMetadata.getAnnotationAttributes(ConditionOnClass<span class="class">.<span class="keyword">class</span>.<span class="title">getName</span>())</span>;</span><br><span class="line">      <span class="comment">//获取该注解中的属性值</span></span><br><span class="line">      String[] values = (String[]) map.get(<span class="string">"value"</span>);</span><br><span class="line">      <span class="keyword">for</span> (String className : values) &#123;</span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(className);</span><br><span class="line">      &#125;</span><br><span class="line">      flag=<span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="七-SpringBoot自动配置原理"><a href="#七-SpringBoot自动配置原理" class="headerlink" title="七.SpringBoot自动配置原理"></a>七.SpringBoot自动配置原理</h1><h4 id="7-1-SpringBoot常用条件注解"><a href="#7-1-SpringBoot常用条件注解" class="headerlink" title="7.1 SpringBoot常用条件注解"></a>7.1 SpringBoot常用条件注解</h4><table>
<thead>
<tr>
<th>ConditionalOnBean</th>
<th>判断spring容器中有某个bean时初始化该Bean</th>
</tr>
</thead>
<tbody><tr>
<td>ConditionalOnClass</td>
<td>判断程序中有某个class字节码文件时初始化该Bean</td>
</tr>
<tr>
<td>ConditionalOnMissingBean</td>
<td>判断spring容器中没有该Bean时会初始化该Bean</td>
</tr>
<tr>
<td>ConditionalOnMissingClass</td>
<td>判断程序中没有某个class字节码文件时初始化该Bean</td>
</tr>
<tr>
<td>ConditionalOnProperty</td>
<td>判断配置文件中是否有对应的属性和值才初始化该bean</td>
</tr>
</tbody></table>
<ul>
<li><p>spring-boot-autoconfigure</p>
<table>
<thead>
<tr>
<th><center>org.springframework.boot:spring-boot-autoconfigure:2.1.4.RELEASE</th>
</tr>
</thead>
<tbody><tr>
<td><center>⬇</td>
</tr>
<tr>
<td><center>org.springframework.boot.autoconfigure</td>
</tr>
<tr>
<td><center>⬇</td>
</tr>
<tr>
<td><center>condition</td>
</tr>
<tr>
<td><center>⬇</td>
</tr>
<tr>
<td><center>ConditionalOnClass<br/><center>ConditionalOnMissingClass<br/><center>ConditionalOnBean<br/><center>ConditionalOnMissingBean<br/><center>ConditionalOnProperty</td>
</tr>
</tbody></table>
</li>
</ul>
<h4 id="7-2-如何初始化RedisTemplate"><a href="#7-2-如何初始化RedisTemplate" class="headerlink" title="7.2 如何初始化RedisTemplate"></a>7.2 如何初始化RedisTemplate</h4><p>查看spring-boot-autoconfigure源码</p>
<p>org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(RedisOperations<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableConfigurationProperties</span>(<span class="title">RedisProperties</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">Import</span>(</span>&#123; LettuceConnectionConfiguration<span class="class">.<span class="keyword">class</span>, <span class="title">JedisConnectionConfiguration</span>.<span class="title">class</span> &#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">RedisAutoConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="comment">// 如果spring的IoC容器中没有该对象，则实例化RedisTemplate对象</span></span><br><span class="line">  <span class="meta">@ConditionalOnMissingBean</span>(name = <span class="string">"redisTemplate"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object, Object&gt; <span class="title">redisTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    RedisConnectionFactory redisConnectionFactory)</span> <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">    RedisTemplate&lt;Object, Object&gt; template = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">    template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">    <span class="keyword">return</span> template;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> StringRedisTemplate <span class="title">stringRedisTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    RedisConnectionFactory redisConnectionFactory)</span> <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">    StringRedisTemplate template = <span class="keyword">new</span> StringRedisTemplate();</span><br><span class="line">    template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">    <span class="keyword">return</span> template;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="八-SpringBoot切换内置服务器"><a href="#八-SpringBoot切换内置服务器" class="headerlink" title="八.SpringBoot切换内置服务器"></a>八.SpringBoot切换内置服务器</h1><p>SpringBoot提供了4种内置服务器供我们选择，我们可以很方便的进行切换。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Tomcat</td>
<td>默认使用tomcat作为内置服务器</td>
</tr>
<tr>
<td>Tomcat</td>
<td>一个开源的servlet容器，它为基于Java的web容器</td>
</tr>
<tr>
<td>Netty</td>
<td>Netty是由JBOSS提供的一个java开源框架。Netty 是一个基于NIO的客户、服务器端的编程框架，使用Netty 可以确保你快速和简单的开发出一个网络应用，例如实现了某种协议的客户、服务端应用。Netty相当于简化和流线化了网络应用的编程开发过程，例如：基于TCP和UDP的socket服务开发。</td>
</tr>
<tr>
<td>Undertow</td>
<td>红帽公司开发的一款基于 NIO 的高性能 Web 嵌入式服务器</td>
</tr>
<tr>
<td>jboss</td>
<td></td>
</tr>
</tbody></table>
<p>org/springframework/boot/autoconfigure/web/embedded</p>
<p>UndertowWebServerFactoryCustomizer<br>JettyWebServerFactoryCustomizer<br>TomcatWebServerFactoryCustomizer<br>NettyWebServerFactoryCustomizer</p>
<h4 id="8-1-默认使用"><a href="#8-1-默认使用" class="headerlink" title="8.1 默认使用"></a>8.1 默认使用</h4><p>springBoot的web环境默认使用tomcat作为内置服务器。我们只需要在工程中的pom文件中添加如下依赖即可</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加web依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="8-2-切换其他服务器"><a href="#8-2-切换其他服务器" class="headerlink" title="8.2 切换其他服务器"></a>8.2 切换其他服务器</h4><ul>
<li><p>在pom文件中，排除掉tomcat依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加web依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--排除掉tomcat依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在pom文件中添加jetty依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加jetty依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>思考：打成war包，properties配置文件是否还生效？</p>
<ul>
<li>如果打成了war包，放到外部的tomcat中运行。</li>
<li>使用的端口是tomcat中配置文件中的端口（server.xml文件）</li>
</ul>
</li>
</ul>
<h1 id="九-SpringBootApplication注解"><a href="#九-SpringBootApplication注解" class="headerlink" title="九.@SpringBootApplication注解"></a>九.@SpringBootApplication注解</h1><h4 id="9-1-注册第三方Bean的三种方式"><a href="#9-1-注册第三方Bean的三种方式" class="headerlink" title="9.1 注册第三方Bean的三种方式"></a>9.1 注册第三方Bean的三种方式</h4><ul>
<li>@ComponentScan(basePackages = {“扫描的包”})</li>
<li>@Import(T.class)</li>
<li>@EnableUser：自定义注解</li>
</ul>
<h5 id="9-1-1-需求"><a href="#9-1-1-需求" class="headerlink" title="9.1.1 需求"></a>9.1.1 需求</h5><p>SpringBoot工程是否可以直接获取第三方jar包中的bean</p>
<h5 id="9-1-2-代码实现"><a href="#9-1-2-代码实现" class="headerlink" title="9.1.2 代码实现"></a>9.1.2 代码实现</h5><h6 id="9-1-2-1-创建maven工程springboot-enable-other"><a href="#9-1-2-1-创建maven工程springboot-enable-other" class="headerlink" title="9.1.2.1 创建maven工程springboot_enable_other"></a>9.1.2.1 创建maven工程springboot_enable_other</h6><ul>
<li><p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建User</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建UserConfig配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="9-1-2-2-创建maven工程springboot-enable"><a href="#9-1-2-2-创建maven工程springboot-enable" class="headerlink" title="9.1.2.2 创建maven工程springboot_enable"></a>9.1.2.2 创建maven工程springboot_enable</h6><ul>
<li><p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--依赖第三方jar包--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot_enable_other<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建SpringBootEnableApplication启动类获取该bean的实例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootEnableApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ConfigurableApplicationContext context = SpringApplication.run(SpringBootEnableApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    Object user = context.getBean(<span class="string">"user"</span>);</span><br><span class="line">    <span class="comment">// 可以查看Spring IoC容器中的内容</span></span><br><span class="line">    <span class="comment">// Map&lt;String, User&gt; map = context.getBeansOfType(User.class);</span></span><br><span class="line">    System.out.println(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="9-1-2-3-启动服务并测试"><a href="#9-1-2-3-启动服务并测试" class="headerlink" title="9.1.2.3 启动服务并测试"></a>9.1.2.3 启动服务并测试</h6><p>无法获取该bean的实例</p>
<h6 id="9-1-2-4-ComponentScan注解"><a href="#9-1-2-4-ComponentScan注解" class="headerlink" title="9.1.2.4 @ComponentScan注解"></a>9.1.2.4 @ComponentScan注解</h6><p>无法获取该bean的实例原因是，启动类默认加载当前包以及子包下的类。而我们的User/UserConfig与启动类并不在同一个包下，因此我们可以通过@ComponentScan指定扫描的包。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ComponentScan</span>(basePackages = &#123;<span class="string">"org.example"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootEnableApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ConfigurableApplicationContext context = SpringApplication.run(SpringBootEnableApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line"></span><br><span class="line">    Object user = context.getBean(<span class="string">"user"</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(map);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>即可获取</p>
<h6 id="9-1-2-5-Import注解"><a href="#9-1-2-5-Import注解" class="headerlink" title="9.1.2.5 @Import注解"></a>9.1.2.5 @Import注解</h6><p>可以通过@Import注解，直接指定UserConfig.class字节码文件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@Import</span>(UserConfig<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SpringBootEnableApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ConfigurableApplicationContext context = SpringApplication.run(SpringBootEnableApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line"></span><br><span class="line">    Object user = context.getBean(<span class="string">"user"</span>);</span><br><span class="line"></span><br><span class="line">    Map&lt;String, User&gt; map = context.getBeansOfType(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(map);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="9-1-2-6-自定注解-EnableUser"><a href="#9-1-2-6-自定注解-EnableUser" class="headerlink" title="9.1.2.6 自定注解@EnableUser"></a>9.1.2.6 自定注解@EnableUser</h6><p>我们可以自定义注解，本质上就是封装@Import注解而已。</p>
<ul>
<li><p>enable-other工程：在annotation包下自定注解EnableUser</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Import</span>(UserConfig<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> @<span class="title">interface</span> <span class="title">EnableUser</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>enable工程：在启动类上开启该注解@EnableUser</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableUser</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootEnableApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ConfigurableApplicationContext context = SpringApplication.run(SpringBootEnableApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line"></span><br><span class="line">     Object user = context.getBean(<span class="string">"user"</span>);</span><br><span class="line"></span><br><span class="line">    Map&lt;String, User&gt; map = context.getBeansOfType(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(map);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="9-2-Import注解使用方式"><a href="#9-2-Import注解使用方式" class="headerlink" title="9.2 @Import注解使用方式"></a>9.2 @Import注解使用方式</h4><h5 id="9-2-1-直接注入Bean"><a href="#9-2-1-直接注入Bean" class="headerlink" title="9.2.1 直接注入Bean"></a>9.2.1 直接注入Bean</h5><p><strong>注意</strong>：如果直接注入Bean，那么Spring Ioc容器中的bean的名称则为该类的全限定名称。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@Import</span>(User<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SpringBootEnableApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ConfigurableApplicationContext context = SpringApplication.run(SpringBootEnableApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过@Import直接导入Bean，那么Spring IoC容器中的bean的名称则为该类的全限定名称</span></span><br><span class="line">    <span class="comment">//        Object user = context.getBean("com.test.pojo.User");</span></span><br><span class="line">    <span class="comment">// 也可以通过类型获取该Bean</span></span><br><span class="line">    User user = context.getBean(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="comment">// 可以查看Spring IoC容器中的内容</span></span><br><span class="line">    Map&lt;String, User&gt; map = context.getBeansOfType(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(map);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-2-2-导入配置类"><a href="#9-2-2-导入配置类" class="headerlink" title="9.2.2 导入配置类"></a>9.2.2 导入配置类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@Import</span>(UserConfig<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SpringBootEnableApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ConfigurableApplicationContext context = SpringApplication.run(SpringBootEnableApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line"></span><br><span class="line">    User user = context.getBean(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(user);</span><br><span class="line"></span><br><span class="line">    Map&lt;String, User&gt; map = context.getBeansOfType(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(map);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-2-3-导入ImportSelector实现类"><a href="#9-2-3-导入ImportSelector实现类" class="headerlink" title="9.2.3 导入ImportSelector实现类"></a>9.2.3 导入ImportSelector实现类</h5><p>ImportSelector接口只定义了一个selectImports()，用于指定需要注册为bean的Class名称（类的权限定名称，然后进行反射进行实例化）。然后在启动类上使用@Import引入了一个ImportSelector实现类后，会把实现类中返回的Class名称都定义为bean。</p>
<h6 id="9-2-3-1-创建MyImportSelector"><a href="#9-2-3-1-创建MyImportSelector" class="headerlink" title="9.2.3.1 创建MyImportSelector"></a>9.2.3.1 创建MyImportSelector</h6><ul>
<li><p>在enable-other工程中创建MyImportSelector</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyImportSelector</span> <span class="keyword">implements</span> <span class="title">ImportSelector</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> String[] selectImports(AnnotationMetadata annotationMetadata) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> String[]&#123;<span class="string">"com.test.pojo.User"</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="9-2-3-2-更新启动类"><a href="#9-2-3-2-更新启动类" class="headerlink" title="9.2.3.2 更新启动类"></a>9.2.3.2 更新启动类</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@Import</span>(MyImportSelector<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SpringBootEnableApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ConfigurableApplicationContext context = SpringApplication.run(SpringBootEnableApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line"></span><br><span class="line">        User user = context.getBean(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">        Map&lt;String, User&gt; map = context.getBeansOfType(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        System.out.println(map);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-2-4-导入ImportBeanDefinitionRegistrar实现类"><a href="#9-2-4-导入ImportBeanDefinitionRegistrar实现类" class="headerlink" title="9.2.4 导入ImportBeanDefinitionRegistrar实现类"></a>9.2.4 导入ImportBeanDefinitionRegistrar实现类</h5><p>ImportBeanDefinitionRegistrar的实现类，则会调用接口方法，将其中要注册的类注册成bean</p>
<h6 id="9-2-4-1创建MyImportBeanDefinitionRegistrar"><a href="#9-2-4-1创建MyImportBeanDefinitionRegistrar" class="headerlink" title="9.2.4.1创建MyImportBeanDefinitionRegistrar"></a>9.2.4.1创建MyImportBeanDefinitionRegistrar</h6><ul>
<li><p>enable-other工程中创建MyImportBeanDefinitionRegistrar</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyImportBeanDefinitionRegistrar</span> <span class="keyword">implements</span> <span class="title">ImportBeanDefinitionRegistrar</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerBeanDefinitions</span><span class="params">(AnnotationMetadata annotationMetadata, BeanDefinitionRegistry beanDefinitionRegistry)</span> </span>&#123;</span><br><span class="line">    AbstractBeanDefinition beanDefinition = BeanDefinitionBuilder.rootBeanDefinition(User<span class="class">.<span class="keyword">class</span>).<span class="title">getBeanDefinition</span>()</span>;</span><br><span class="line">    beanDefinitionRegistry.registerBeanDefinition(<span class="string">"user"</span>,beanDefinition);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="9-2-4-2-更新启动类"><a href="#9-2-4-2-更新启动类" class="headerlink" title="9.2.4.2 更新启动类"></a>9.2.4.2 更新启动类</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@Import</span>(MyImportBeanDefinitionRegistrar<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SpringBootEnableApplication</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ConfigurableApplicationContext context = SpringApplication.run(SpringBootEnableApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line"></span><br><span class="line">    User user = context.getBean(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(user);</span><br><span class="line"></span><br><span class="line">    Map&lt;String, User&gt; map = context.getBeansOfType(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(map);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="9-3-EnableAutoConfiguration注解详解"><a href="#9-3-EnableAutoConfiguration注解详解" class="headerlink" title="9.3 @EnableAutoConfiguration注解详解"></a>9.3 @EnableAutoConfiguration注解详解</h4><p>SpringBoot中提供了很多以@Enable<em>开头的注解，这些*</em>注解都是用于启动某些功能的**。而其底层是使用@Import注解导入了一些配置类，实现Bean的动态加载。</p>
<p>例如，@EnableAutoConfiguration。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@AutoConfigurationPackage</span></span><br><span class="line"><span class="meta">@Import</span>(&#123;AutoConfigurationImportSelector<span class="class">.<span class="keyword">class</span>&#125;)</span></span><br><span class="line"><span class="class"><span class="title">public</span> @<span class="title">interface</span> <span class="title">EnableAutoConfiguration</span> </span>&#123;</span><br><span class="line">  String ENABLED_OVERRIDE_PROPERTY = <span class="string">"spring.boot.enableautoconfiguration"</span>;</span><br><span class="line"></span><br><span class="line">  Class&lt;?&gt;[] exclude() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  String[] excludeName() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以继续查看AutoConfigurationImportSelector的源码</p>
<ul>
<li><p>selectImport方法：选择导入的配置类并转成一个数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String[] selectImports(AnnotationMetadata annotationMetadata) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>.isEnabled(annotationMetadata)) &#123;</span><br><span class="line">    <span class="keyword">return</span> NO_IMPORTS;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    AutoConfigurationMetadata autoConfigurationMetadata = AutoConfigurationMetadataLoader.loadMetadata(<span class="keyword">this</span>.beanClassLoader);</span><br><span class="line">    AutoConfigurationImportSelector.AutoConfigurationEntry autoConfigurationEntry = <span class="keyword">this</span>.getAutoConfigurationEntry(autoConfigurationMetadata, annotationMetadata);</span><br><span class="line">    <span class="keyword">return</span> StringUtils.toStringArray(autoConfigurationEntry.getConfigurations());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>getAutoConfigurationEntry方法：获取配置类实体对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> AutoConfigurationImportSelector.<span class="function">AutoConfigurationEntry <span class="title">getAutoConfigurationEntry</span><span class="params">(AutoConfigurationMetadata autoConfigurationMetadata, AnnotationMetadata annotationMetadata)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>.isEnabled(annotationMetadata)) &#123;</span><br><span class="line">    <span class="keyword">return</span> EMPTY_ENTRY;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    AnnotationAttributes attributes = <span class="keyword">this</span>.getAttributes(annotationMetadata);</span><br><span class="line">    List&lt;String&gt; configurations = <span class="keyword">this</span>.getCandidateConfigurations(annotationMetadata, attributes);</span><br><span class="line">    configurations = <span class="keyword">this</span>.removeDuplicates(configurations);</span><br><span class="line">    Set&lt;String&gt; exclusions = <span class="keyword">this</span>.getExclusions(annotationMetadata, attributes);</span><br><span class="line">    <span class="keyword">this</span>.checkExcludedClasses(configurations, exclusions);</span><br><span class="line">    configurations.removeAll(exclusions);</span><br><span class="line">    configurations = <span class="keyword">this</span>.filter(configurations, autoConfigurationMetadata);</span><br><span class="line">    <span class="keyword">this</span>.fireAutoConfigurationImportEvents(configurations, exclusions);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> AutoConfigurationImportSelector.AutoConfigurationEntry(configurations, exclusions);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>getCandidateConfigurations：获取配置文件中的需要加载的类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> List&lt;String&gt; <span class="title">getCandidateConfigurations</span><span class="params">(AnnotationMetadata metadata, AnnotationAttributes attributes)</span> </span>&#123;</span><br><span class="line">  List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(<span class="keyword">this</span>.getSpringFactoriesLoaderFactoryClass(), <span class="keyword">this</span>.getBeanClassLoader());</span><br><span class="line">  Assert.notEmpty(configurations, <span class="string">"No auto configuration classes found in META-INF/spring.factories. If you are using a custom packaging, make sure that file is correct."</span>);</span><br><span class="line">  <span class="keyword">return</span> configurations;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>SpringFactoriesLoader.loadFactoryNames，加载META-INF/spring.factories文件中所有bean的名称，并且放入map中（IoC容器就是一个map）</p>
</li>
<li><p>META-INF/spring.factories文件内容如下</p>
</li>
<li><p>查看Redis</p>
</li>
<li><p>当服务启动时，就会自动注册RedisTemplate的bean到Spring的IoC容器中</p>
</li>
</ul>
<h1 id="十-SpringBoot自定义第三方starter"><a href="#十-SpringBoot自定义第三方starter" class="headerlink" title="十.SpringBoot自定义第三方starter"></a>十.SpringBoot自定义第三方starter</h1><h4 id="10-1-思路分析"><a href="#10-1-思路分析" class="headerlink" title="10.1 思路分析"></a>10.1 思路分析</h4><p>SpringBoot启动器starter命名规则：</p>
<ul>
<li>自带的：spring-boot-starter-xxx，例如Redis启动器：spring-boot-starter-data-redis</li>
<li>第三方：xxx-spring-boot-starter，例如mybatis启动器：mybatis-spring-boot-starter</li>
</ul>
<p>参考第三方的mybatis的starter。我们可以在任意一个SpringBoot工程中添加mybatis启动器依赖。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--mybatis启动器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="10-1-1-myredis-spring-boot-starter"><a href="#10-1-1-myredis-spring-boot-starter" class="headerlink" title="10.1.1 myredis_spring_boot_starter"></a>10.1.1 myredis_spring_boot_starter</h5><p>该工程就是pom文件，负责定义规范，指定mybatis需要依赖的jar包，不需要编码。</p>
<h5 id="10-1-2-myredis-spring-boot-starter-autoconfigure"><a href="#10-1-2-myredis-spring-boot-starter-autoconfigure" class="headerlink" title="10.1.2 myredis_spring_boot_starter_autoconfigure"></a>10.1.2 myredis_spring_boot_starter_autoconfigure</h5><ul>
<li>spring.factories文件：指定需要加载的Bean</li>
<li>MyRedisAutoConfiguration：自动创建redis的相关的Bean（例如：SqlSessionFactoryBean）</li>
<li>MyRedisProperties：连接redis信息</li>
</ul>
<h4 id="10-2-结论"><a href="#10-2-结论" class="headerlink" title="10.2 结论"></a>10.2 结论</h4><p>如果我们想要自定义第三方的starter，例如我们本次创建自定义的Redis的starter。因此我们需要实现的步骤如下</p>
<ul>
<li><p>创建myredis-spring-boot-starter-autoconfigure工程</p>
<ul>
<li><p>创建META-INF/spring.factories文件</p>
</li>
<li><p>创建MyRedisAutoConfiguration</p>
</li>
<li><p>创建MyRedisProperties</p>
</li>
</ul>
</li>
<li><p>创建myredis-spring-boot-starter工程，并且需要依赖autoconfigure工程</p>
</li>
<li><p>在测试工程中引入myredis-spring-boot-starter依赖，并且进行测试</p>
</li>
</ul>
<h4 id="10-3-代码实现"><a href="#10-3-代码实现" class="headerlink" title="10.3 代码实现"></a>10.3 代码实现</h4><h5 id="10-3-1-创建myredis-spring-boot-starter-autoconfigure工程"><a href="#10-3-1-创建myredis-spring-boot-starter-autoconfigure工程" class="headerlink" title="10.3.1 创建myredis-spring-boot-starter-autoconfigure工程"></a>10.3.1 创建myredis-spring-boot-starter-autoconfigure工程</h5><h6 id="10-3-1-1-创建工程并且添加依赖"><a href="#10-3-1-1-创建工程并且添加依赖" class="headerlink" title="10.3.1.1 创建工程并且添加依赖"></a>10.3.1.1 创建工程并且添加依赖</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--springboot的starter--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--redis的依赖jedis--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="10-3-1-2-创建MyRedisProperties"><a href="#10-3-1-2-创建MyRedisProperties" class="headerlink" title="10.3.1.2 创建MyRedisProperties"></a>10.3.1.2 创建MyRedisProperties</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"myredis"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRedisProperties</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String host = <span class="string">"localhost"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> port = <span class="number">6379</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO setter/getter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="10-3-1-3-创建MyRedisAutoConfiguration"><a href="#10-3-1-3-创建MyRedisAutoConfiguration" class="headerlink" title="10.3.1.3 创建MyRedisAutoConfiguration"></a>10.3.1.3 创建MyRedisAutoConfiguration</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置类</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">// 加载Redis配置</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(MyRedisProperties<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">MyRedisAutoConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span>(name = <span class="string">"myJedis"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Jedis <span class="title">myJedis</span><span class="params">(MyRedisProperties myRedisProperties)</span></span>&#123;</span><br><span class="line">        System.out.println(myRedisProperties.getHost());</span><br><span class="line">        System.out.println(myRedisProperties.getPort());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Jedis(myRedisProperties.getHost(),myRedisProperties.getPort());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="10-3-1-4-创建spring-factories文件"><a href="#10-3-1-4-创建spring-factories文件" class="headerlink" title="10.3.1.4 创建spring.factories文件"></a>10.3.1.4 创建spring.factories文件</h6><p>在工程的resources下创建`&lt;META-INF/spring.factories文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Auto Configure</span></span><br><span class="line"><span class="meta">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class="string">\</span></span><br><span class="line"><span class="attr">com.test.spring.boot.autoconfigure.MyRedisAutoConfiguration</span></span><br></pre></td></tr></table></figure>

<h5 id="10-3-2-创建myredis-spring-boot-starter工程"><a href="#10-3-2-创建myredis-spring-boot-starter工程" class="headerlink" title="10.3.2 创建myredis-spring-boot-starter工程"></a>10.3.2 创建myredis-spring-boot-starter工程</h5><p>创建该工程，什么都不用写，我们只需要在pom文件中添加相关依赖即可。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--springboot的starter--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--依赖myredis autoconfigure工程--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot_day02_demo03_myredis_spring_boot_starter_autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="10-4-测试"><a href="#10-4-测试" class="headerlink" title="10.4 测试"></a>10.4 测试</h4><h5 id="10-4-1-创建测试工程"><a href="#10-4-1-创建测试工程" class="headerlink" title="10.4.1 创建测试工程"></a>10.4.1 创建测试工程</h5><ul>
<li><p>创建测试工程myredis-test工程，并且添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot_day02_demo03_myredis_test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--springboot的starter--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--依赖自定义的myredis的starter--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot_day02_demo03_myredis_spring_boot_starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="10-4-2-测试bean是否自动配置"><a href="#10-4-2-测试bean是否自动配置" class="headerlink" title="10.4.2 测试bean是否自动配置"></a>10.4.2 测试bean是否自动配置</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRedisApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ConfigurableApplicationContext context = SpringApplication.run(MyRedisApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">        Jedis myJedis = (Jedis) context.getBean(<span class="string">"myJedis"</span>);</span><br><span class="line"></span><br><span class="line">        myJedis.set(<span class="string">"A"</span>,<span class="string">"B"</span>);</span><br><span class="line">        System.out.println(myJedis.get(<span class="string">"A"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10-4-3-测试配置文件是否生效"><a href="#10-4-3-测试配置文件是否生效" class="headerlink" title="10.4.3 测试配置文件是否生效"></a>10.4.3 测试配置文件是否生效</h5><p>myredis-test工程中创建application.properties文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">myredis.port</span>=<span class="string">6666</span></span><br></pre></td></tr></table></figure>

<p>结果证明：可以获取配置文件中的属性信息。后期可以根据redis环境不同配置不同的地址以及端口。</p>
<h1 id="十一-SpringBoot事件监听"><a href="#十一-SpringBoot事件监听" class="headerlink" title="十一.SpringBoot事件监听"></a>十一.SpringBoot事件监听</h1><h4 id="11-1-介绍"><a href="#11-1-介绍" class="headerlink" title="11.1 介绍"></a>11.1 介绍</h4><p>在实际的场景中，在服务启动时经常会加载一些数据和执行一些应用的初始化动作，如：删除临时文件，清除缓存信息，读取配置文件信息，数据库连接等等。而SpringBoot提供了了4个常见的监听器接口，我们可以实现这些接口在项目启动时完成一些初始化工作。该4个接口如下：CommandLineRunner、ApplicationRunner、ApplicationContextInitializer、SpringApplicationRunListener</p>
<h4 id="11-2-CommandLineRunner和ApplicationRunner使用"><a href="#11-2-CommandLineRunner和ApplicationRunner使用" class="headerlink" title="11.2 CommandLineRunner和ApplicationRunner使用"></a>11.2 CommandLineRunner和ApplicationRunner使用</h4><h5 id="11-2-1-创建maven工程"><a href="#11-2-1-创建maven工程" class="headerlink" title="11.2.1 创建maven工程"></a>11.2.1 创建maven工程</h5><ul>
<li><p>创建springboot-listener工程，并且添加pom依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="11-2-2-编写启动类"><a href="#11-2-2-编写启动类" class="headerlink" title="11.2.2 编写启动类"></a>11.2.2 编写启动类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListenerDemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ListenerDemoApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="11-2-3-自定义监听器"><a href="#11-2-3-自定义监听器" class="headerlink" title="11.2.3 自定义监听器"></a>11.2.3 自定义监听器</h5><ul>
<li><p>MyCommandLineRunner</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCommandLineRunner</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"MyCommandLineRunner"</span>);</span><br><span class="line">        System.out.println(Arrays.asList(args));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>MyApplicationRunner</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplicationRunner</span> <span class="keyword">implements</span> <span class="title">ApplicationRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ApplicationArguments args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"MyApplicationRunner"</span>);</span><br><span class="line">        String[] sourceArgs = args.getSourceArgs();</span><br><span class="line">        System.out.println(Arrays.asList(sourceArgs));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="11-2-4-启动测试可以看到控制台打印信息"><a href="#11-2-4-启动测试可以看到控制台打印信息" class="headerlink" title="11.2.4 启动测试可以看到控制台打印信息"></a>11.2.4 启动测试可以看到控制台打印信息</h5><h4 id="11-3-SpringApplicationRunListenerer和ApplicationContextInitializ使用"><a href="#11-3-SpringApplicationRunListenerer和ApplicationContextInitializ使用" class="headerlink" title="11.3 SpringApplicationRunListenerer和ApplicationContextInitializ使用"></a>11.3 SpringApplicationRunListenerer和ApplicationContextInitializ使用</h4><h5 id="11-3-1-自定义监听器"><a href="#11-3-1-自定义监听器" class="headerlink" title="11.3.1 自定义监听器"></a>11.3.1 自定义监听器</h5><p>创建MyApplicationContextInitializer、MySpringApplicationRunListener两个监听器</p>
<ul>
<li><p>MyApplicationContextInitializer</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplicationContextInitializer</span> <span class="keyword">implements</span> <span class="title">ApplicationContextInitializer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">(ConfigurableApplicationContext configurableApplicationContext)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"MyApplicationContextInitializer"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>MySpringApplicationRunListener</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySpringApplicationRunListener</span> <span class="keyword">implements</span> <span class="title">SpringApplicationRunListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 需要提供该构造方法，否则该方法无法运行</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MySpringApplicationRunListener</span><span class="params">(SpringApplication springApplication, String[] args)</span></span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">starting</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"MySpringApplicationRunListener ... starting"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">environmentPrepared</span><span class="params">(ConfigurableEnvironment environment)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"MySpringApplicationRunListener ... environmentPrepared"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextPrepared</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"MySpringApplicationRunListener ... contextPrepared"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoaded</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"MySpringApplicationRunListener ... contextLoaded"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">started</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"MySpringApplicationRunListener ... started"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">running</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"MySpringApplicationRunListener ... running"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">failed</span><span class="params">(ConfigurableApplicationContext context, Throwable exception)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"MySpringApplicationRunListener ... failed"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="11-3-2-创建spring-factories文件"><a href="#11-3-2-创建spring-factories文件" class="headerlink" title="11.3.2 创建spring.factories文件"></a>11.3.2 创建spring.factories文件</h5><p>在resources目录下创建META-INF/spring.factories文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">org.springframework.boot.SpringApplicationRunListener</span>=<span class="string">com.test.listener.MySpringApplicationRunListener</span></span><br><span class="line"><span class="meta">org.springframework.context.ApplicationContextInitializer</span>=<span class="string">com.test.listener.MyApplicationContextInitializer</span></span><br></pre></td></tr></table></figure>

<h5 id="11-3-3-启动服务并测试，可以发现控制台打印信息包含Listener输出"><a href="#11-3-3-启动服务并测试，可以发现控制台打印信息包含Listener输出" class="headerlink" title="11.3.3 启动服务并测试，可以发现控制台打印信息包含Listener输出"></a>11.3.3 启动服务并测试，可以发现控制台打印信息包含Listener输出</h5><h4 id="11-4-总结"><a href="#11-4-总结" class="headerlink" title="11.4 总结"></a>11.4 总结</h4><ul>
<li><p>CommandLineRunner和ApplicationRunner</p>
<p>外部资源的一些初始化工作(例如：缓存预热、清除缓存、清除临时文件等等—应用级别)</p>
</li>
<li><p>SpringApplicationRunListenerer和ApplicationContextInitializ</p>
<p>系统级别的应用初始化工作（判断是否为web环境、初始化Spring工厂等等—系统/框架级别）</p>
</li>
</ul>
<h1 id="十二-SpringBoot监控"><a href="#十二-SpringBoot监控" class="headerlink" title="十二.SpringBoot监控"></a>十二.SpringBoot监控</h1><h4 id="12-1-介绍"><a href="#12-1-介绍" class="headerlink" title="12.1 介绍"></a>12.1 介绍</h4><p>SpringBoot自带监控功能Actuator，可以帮助实现对程序内部运行情况监控，比如监控状况、Bean加载情况、环境变量、日志信息、线程信息等。</p>
<h4 id="12-2-Actuator入门"><a href="#12-2-Actuator入门" class="headerlink" title="12.2 Actuator入门"></a>12.2 Actuator入门</h4><h5 id="12-2-1-创建maven工程"><a href="#12-2-1-创建maven工程" class="headerlink" title="12.2.1 创建maven工程"></a>12.2.1 创建maven工程</h5><p>创建 springboot-actuator工程，添加依赖并且编写启动类。</p>
<ul>
<li><p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--起步依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--web依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--springboot监控--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ActuatorApplication</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActuatorApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SpringApplication.run(ActuatorApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="12-2-2-启动服务并访问-localhost-8080-actuator"><a href="#12-2-2-启动服务并访问-localhost-8080-actuator" class="headerlink" title="12.2.2 启动服务并访问 localhost:8080/actuator"></a>12.2.2 启动服务并访问 localhost:8080/actuator</h5><p>可以看到页面中有应用信息</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_links"</span>: &#123;</span><br><span class="line">    <span class="attr">"self"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"auditevents"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/auditevents"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"beans"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/beans"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"caches-cache"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/caches/&#123;cache&#125;"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"caches"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/caches"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//应用的健康状态信息</span></span><br><span class="line">    <span class="attr">"health"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/health"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"health-component"</span>: &#123;</span><br><span class="line">      <span class="comment">//应用中其他组件的健康信息</span></span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/health/&#123;component&#125;"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"health-component-instance"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/health/&#123;component&#125;/&#123;instance&#125;"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"conditions"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/conditions"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"configprops"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/configprops"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"env-toMatch"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/env/&#123;toMatch&#125;"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"env"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/env"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//配置文件中info相关信息</span></span><br><span class="line">    <span class="attr">"info"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/info"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"loggers-name"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/loggers/&#123;name&#125;"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"loggers"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/loggers"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"heapdump"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/heapdump"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"threaddump"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/threaddump"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"metrics-requiredMetricName"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/metrics/&#123;requiredMetricName&#125;"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"metrics"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/metrics"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"scheduledtasks"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/scheduledtasks"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"httptrace"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/httptrace"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"mappings"</span>: &#123;</span><br><span class="line">      <span class="attr">"href"</span>: <span class="string">"http://localhost:8080/actuator/mappings"</span>,</span><br><span class="line">      <span class="attr">"templated"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12-3-Actuator使用说明"><a href="#12-3-Actuator使用说明" class="headerlink" title="12.3 Actuator使用说明"></a>12.3 Actuator使用说明</h4><h5 id="12-3-1-info信息"><a href="#12-3-1-info信息" class="headerlink" title="12.3.1 info信息"></a>12.3.1 info信息</h5><p>info配置相关信息 localhost:8080/actuator/info，在application.properties文件中配置内容</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># info相关配置</span></span><br><span class="line"><span class="meta">info.name</span>=<span class="string">test</span></span><br><span class="line"><span class="meta">info.age</span>=<span class="string">18</span></span><br></pre></td></tr></table></figure>

<h5 id="12-3-2-健康信息"><a href="#12-3-2-健康信息" class="headerlink" title="12.3.2 健康信息"></a>12.3.2 健康信息</h5><p>应用以及组件健康状态信息 localhost:8080/actuator/health,在application.peroperties文件中开启端点详情</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示暴露的端点详情</span></span><br><span class="line"><span class="meta">management.endpoint.health.show-details</span>=<span class="string">always</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">还可以在pom文件中添加redis依赖，然后再去查看健康状态信息。</span><br><span class="line"><span class="comment">&lt;!--Redis依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="12-3-3-开放web相关端点信息"><a href="#12-3-3-开放web相关端点信息" class="headerlink" title="12.3.3 开放web相关端点信息"></a>12.3.3 开放web相关端点信息</h5><p>在application.properties文件中配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开放web相关的端点信息</span></span><br><span class="line"><span class="meta">management.endpoints.web.exposure.include</span>=<span class="string">*</span></span><br></pre></td></tr></table></figure>

<h5 id="12-3-4-Actuator暴露的端点说明"><a href="#12-3-4-Actuator暴露的端点说明" class="headerlink" title="12.3.4 Actuator暴露的端点说明"></a>12.3.4 Actuator暴露的端点说明</h5><p>Actuator提供了以下端点，默认除了/shutdown都是Enabled。使用时需要加/actuator前缀，</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Description</th>
<th>Enabled by default</th>
</tr>
</thead>
<tbody><tr>
<td>auditevents</td>
<td>显示当前应用程序的审计事件信息</td>
<td>Yes</td>
</tr>
<tr>
<td>beans</td>
<td>显示应用上下文中创建的所有Bean</td>
<td>Yes</td>
</tr>
<tr>
<td>caches</td>
<td>获取缓存信息</td>
<td>Yes</td>
</tr>
<tr>
<td>conditions</td>
<td>显示配置类和自动配置类(configuration and auto-configuration classes) 的状态及它们被应用或未被应用的原因</td>
<td>Yes</td>
</tr>
<tr>
<td>configprops</td>
<td>该端点用来获取应用中配置的属性信息报告 （所有@ConfigurationProperties的集合列表）</td>
<td>Yes</td>
</tr>
<tr>
<td>env</td>
<td>获取应用所有可用的环境属性报告。包括： 环境变量、JVM属性、应用的配置配置、命令行中的参数</td>
<td>Yes</td>
</tr>
<tr>
<td>flyway</td>
<td>显示数据库迁移路径（如果有）</td>
<td>Yes</td>
</tr>
<tr>
<td>health</td>
<td>显示应用的健康信息</td>
<td>Yes</td>
</tr>
<tr>
<td>httptrace</td>
<td>返回基本的HTTP跟踪信息。 (默认最多100 HTTP request-response exchanges).</td>
<td>Yes</td>
</tr>
<tr>
<td>info</td>
<td>返回一些应用自定义的信息，我们可以在application.properties 配置文件中通过info前缀来设置这些属性：info.app.name=spring-boot-hello</td>
<td>Yes</td>
</tr>
<tr>
<td>integrationgraph</td>
<td>Shows the Spring Integration graph.</td>
<td>Yes</td>
</tr>
<tr>
<td>loggers</td>
<td>Shows and modifies the configuration of loggers in the application.</td>
<td>Yes</td>
</tr>
<tr>
<td>liquibase</td>
<td>Shows any Liquibase database migrations that have been applied.</td>
<td>Yes</td>
</tr>
<tr>
<td>metrics</td>
<td>返回当前应用的各类重要度量指标，比如：内存信息、线程信息、垃圾回收信息等</td>
<td>Yes</td>
</tr>
<tr>
<td>mappings</td>
<td>返回所有Spring MVC的控制器映射关系报告 （所有@RequestMapping路径的集合列表）</td>
<td>Yes</td>
</tr>
<tr>
<td>scheduledtasks</td>
<td>显示应用程序中的计划任务</td>
<td>Yes</td>
</tr>
<tr>
<td>sessions</td>
<td>允许从Spring会话支持的会话存储中检索和删除(retrieval and deletion) 用户会话。使用Spring Session对反应性Web应用程序的支持时不可用</td>
<td>Yes</td>
</tr>
<tr>
<td>shutdown</td>
<td>允许应用以优雅的方式关闭（默认情况下不启用）</td>
<td>No</td>
</tr>
<tr>
<td>threaddump</td>
<td>执行一个线程dump</td>
<td>Yes</td>
</tr>
</tbody></table>
<p>如果使用web应用(Spring MVC, Spring WebFlux, 或者 Jersey)，还可以使用以下端点：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Description</th>
<th>Enabled by default</th>
</tr>
</thead>
<tbody><tr>
<td>heapdump</td>
<td>返回一个GZip压缩的hprof堆dump文件</td>
<td>Yes</td>
</tr>
<tr>
<td>jolokia</td>
<td>通过HTTP暴露JMX beans（当Jolokia在类路径上时，WebFlux不可用）</td>
<td>Yes</td>
</tr>
<tr>
<td>logfile</td>
<td>返回日志文件内容（如果设置了logging.file或logging.path属性的话）， 支持使用HTTP Range头接收日志文件内容的部分信息</td>
<td>Yes</td>
</tr>
<tr>
<td>prometheus</td>
<td>以可以被Prometheus服务器抓取的格式显示metrics信息</td>
<td>Yes</td>
</tr>
</tbody></table>
<h4 id="12-4-Spring-Boot-Admin"><a href="#12-4-Spring-Boot-Admin" class="headerlink" title="12.4 Spring Boot Admin"></a>12.4 Spring Boot Admin</h4><h5 id="12-4-1-介绍"><a href="#12-4-1-介绍" class="headerlink" title="12.4.1 介绍"></a>12.4.1 介绍</h5><p>类似dubbo admin，用于管理和监控SpringBoot应用程序。 </p>
<p>应用程序作为Spring Boot Admin Client向为Spring Boot Admin Server注册（通过HTTP）或使用SpringCloud注册中心（例如Eureka，Consul）发现。 UI是的AngularJs应用程序，展示Spring Boot Admin Client的Actuator端点上的一些监控。 </p>
<h5 id="12-4-2-入门程序"><a href="#12-4-2-入门程序" class="headerlink" title="12.4.2 入门程序"></a>12.4.2 入门程序</h5><h6 id="12-4-2-1-创建admin-server工程"><a href="#12-4-2-1-创建admin-server工程" class="headerlink" title="12.4.2.1 创建admin server工程"></a>12.4.2.1 创建admin server工程</h6><p>创建工程springboot-admin-server并且添加依赖</p>
<ul>
<li><p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--spring boot启动器--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--web依赖--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--admin server--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-starter-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写AdminServerApplication</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableAdminServer</span>      <span class="comment">// 开启admin服务</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AdminServerApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SpringApplication.run(AdminServerApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tomcat端口</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">9090</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="12-4-2-2-创建admin-client工程"><a href="#12-4-2-2-创建admin-client工程" class="headerlink" title="12.4.2.2 创建admin client工程"></a>12.4.2.2 创建admin client工程</h6><p>创建工程 springboot-admin-client 并且添加依赖</p>
<ul>
<li><p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--spring boot启动器--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--web依赖--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--admin client--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-starter-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置注册到的admin server的地址</span></span><br><span class="line"><span class="meta">spring.boot.admin.client.url</span>=<span class="string">http://localhost:9090</span></span><br><span class="line"><span class="comment"># 启用健康检查 默认就是true</span></span><br><span class="line"><span class="meta">management.endpoint.health.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># 配置显示所有的监控详情</span></span><br><span class="line"><span class="meta">management.endpoint.health.show-details</span>=<span class="string">always</span></span><br><span class="line"><span class="comment"># 开放所有端点</span></span><br><span class="line"><span class="meta">management.endpoints.web.exposure.include</span>=<span class="string">*</span></span><br><span class="line"><span class="comment"># 设置应用的名称</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">test</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写启动类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AdminClientApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(AdminClientApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写HelloController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/show"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="12-4-3-测试"><a href="#12-4-3-测试" class="headerlink" title="12.4.3 测试"></a>12.4.3 测试</h5><ul>
<li>启动SpringBoot Admin Server</li>
<li>启动SpringBoot Admin Client</li>
<li>访问  localhost:9090</li>
<li>先点击【应用名称】—&gt;在点击【实例id】即可查看到详细信息</li>
</ul>

    </div>

    
    
    
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/06/20/%E5%B0%B1%E4%B8%9A%E7%8F%AD%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%83%E5%8D%81%E4%BA%94%EF%BC%89/" rel="prev" title="就业班学习笔记（七十五）">
      <i class="fa fa-chevron-left"></i> 就业班学习笔记（七十五）
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/07/13/SpringCloud%E5%85%A5%E9%97%A8/" rel="next" title="SpringCloud入门">
      SpringCloud入门 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一-SpringBoot简介"><span class="nav-number">1.</span> <span class="nav-text">一.SpringBoot简介</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-Spring-Boot-整合了所有的框架以及中间件"><span class="nav-number">1.0.0.1.</span> <span class="nav-text">1.1 Spring Boot 整合了所有的框架以及中间件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-小结："><span class="nav-number">1.0.0.2.</span> <span class="nav-text">1.2 小结：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二-SpringBoot快速入门"><span class="nav-number">2.</span> <span class="nav-text">二.SpringBoot快速入门</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-需求"><span class="nav-number">2.0.0.1.</span> <span class="nav-text">2.1 需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-步骤"><span class="nav-number">2.0.0.2.</span> <span class="nav-text">2.2 步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-SpringBoot实现"><span class="nav-number">2.0.0.3.</span> <span class="nav-text">2.3 SpringBoot实现</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3-1-构建工程方式一"><span class="nav-number">2.0.0.3.1.</span> <span class="nav-text">2.3.1 构建工程方式一</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#2-3-1-1-创建maven工程"><span class="nav-number">2.0.0.3.1.1.</span> <span class="nav-text">2.3.1.1 创建maven工程</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-3-1-2-工程jar依赖情况"><span class="nav-number">2.0.0.3.1.2.</span> <span class="nav-text">2.3.1.2 工程jar依赖情况</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-3-1-3-编写启动类"><span class="nav-number">2.0.0.3.1.3.</span> <span class="nav-text">2.3.1.3 编写启动类</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-3-1-4-编写HelloController"><span class="nav-number">2.0.0.3.1.4.</span> <span class="nav-text">2.3.1.4 编写HelloController</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-3-1-5-测试"><span class="nav-number">2.0.0.3.1.5.</span> <span class="nav-text">2.3.1.5 测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-总结"><span class="nav-number">2.0.0.4.</span> <span class="nav-text">2.4 总结</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三-SpringBoot版本控制原理"><span class="nav-number">3.</span> <span class="nav-text">三.SpringBoot版本控制原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-spring-boot-starter-parent"><span class="nav-number">3.0.0.1.</span> <span class="nav-text">3.1 spring-boot-starter-parent</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-SpringBootApplication"><span class="nav-number">3.0.0.2.</span> <span class="nav-text">3.2 @SpringBootApplication</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四-SpringBoot配置文件使用"><span class="nav-number">4.</span> <span class="nav-text">四.SpringBoot配置文件使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-application-properties"><span class="nav-number">4.0.0.1.</span> <span class="nav-text">4.1 application.properties</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-1-1-语法"><span class="nav-number">4.0.0.1.1.</span> <span class="nav-text">4.1.1 语法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-1-2-案例"><span class="nav-number">4.0.0.1.2.</span> <span class="nav-text">4.1.2 案例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-application-yml-yaml"><span class="nav-number">4.0.0.2.</span> <span class="nav-text">4.2 application.yml&#x2F;yaml</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-2-1-语法"><span class="nav-number">4.0.0.2.1.</span> <span class="nav-text">4.2.1 语法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-2-案例"><span class="nav-number">4.0.0.3.</span> <span class="nav-text">4.2.2 案例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-获取配置文件中的值"><span class="nav-number">4.0.0.4.</span> <span class="nav-text">4.3 获取配置文件中的值</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-3-1-在yml文件中配置如下内容"><span class="nav-number">4.0.0.4.1.</span> <span class="nav-text">4.3.1 在yml文件中配置如下内容</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-3-2-通过-Value取值"><span class="nav-number">4.0.0.4.2.</span> <span class="nav-text">4.3.2 通过@Value取值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-3-3-通过Environment取值"><span class="nav-number">4.0.0.4.3.</span> <span class="nav-text">4.3.3 通过Environment取值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-3-4-ConfigurationProperties取值"><span class="nav-number">4.0.0.4.4.</span> <span class="nav-text">4.3.4@ConfigurationProperties取值</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#4-3-4-1-在yml文件中添加如下内容"><span class="nav-number">4.0.0.4.4.1.</span> <span class="nav-text">4.3.4.1 在yml文件中添加如下内容</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-3-4-2-创建一个pojo"><span class="nav-number">4.0.0.4.4.2.</span> <span class="nav-text">4.3.4.2 创建一个pojo</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#4-3-4-3-取值"><span class="nav-number">4.0.0.4.4.3.</span> <span class="nav-text">4.3.4.3 取值</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-spring-profiles-active指定开发环境"><span class="nav-number">4.0.0.5.</span> <span class="nav-text">4.4 spring.profiles.active指定开发环境</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-4-1-properties文件"><span class="nav-number">4.0.0.5.1.</span> <span class="nav-text">4.4.1 properties文件</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五-SpringBoot与其他框架集成"><span class="nav-number">5.</span> <span class="nav-text">五.SpringBoot与其他框架集成</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-集成mybatis"><span class="nav-number">5.0.0.1.</span> <span class="nav-text">5.1 集成mybatis</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-1-需求"><span class="nav-number">5.0.0.1.1.</span> <span class="nav-text">5.1.1 需求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-2-创建Maven工程并添加依赖"><span class="nav-number">5.0.0.1.2.</span> <span class="nav-text">5.1.2 创建Maven工程并添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-3-编写启动类"><span class="nav-number">5.0.0.1.3.</span> <span class="nav-text">5.1.3 编写启动类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-4-添加application-properties文件"><span class="nav-number">5.0.0.1.4.</span> <span class="nav-text">5.1.4 添加application.properties文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-5-编写pojo"><span class="nav-number">5.0.0.1.5.</span> <span class="nav-text">5.1.5 编写pojo</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-6-编写mapper接口以及映射文件"><span class="nav-number">5.0.0.1.6.</span> <span class="nav-text">5.1.6 编写mapper接口以及映射文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-7-编写service接口以及实现类"><span class="nav-number">5.0.0.1.7.</span> <span class="nav-text">5.1.7 编写service接口以及实现类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-8-编写controller"><span class="nav-number">5.0.0.1.8.</span> <span class="nav-text">5.1.8 编写controller</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-集成Spring-Data-Redis"><span class="nav-number">5.0.0.2.</span> <span class="nav-text">5.2 集成Spring Data Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-1-在同一工程Maven文件中配置Redis启动器"><span class="nav-number">5.0.0.2.1.</span> <span class="nav-text">5.2.1 在同一工程Maven文件中配置Redis启动器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-2-配置application-properties"><span class="nav-number">5.0.0.2.2.</span> <span class="nav-text">5.2.2 配置application.properties</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-3-更新UserServiceImpl"><span class="nav-number">5.0.0.2.3.</span> <span class="nav-text">5.2.3 更新UserServiceImpl</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-5-扩展-了解"><span class="nav-number">5.0.0.2.4.</span> <span class="nav-text">5.2.5 扩展-了解</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-集成定时器"><span class="nav-number">5.0.0.3.</span> <span class="nav-text">5.3 集成定时器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-集成单元测试"><span class="nav-number">5.0.0.4.</span> <span class="nav-text">5.4 集成单元测试</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-4-1-添加依赖"><span class="nav-number">5.0.0.4.1.</span> <span class="nav-text">5.4.1 添加依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-4-2-编写单元测试"><span class="nav-number">5.0.0.4.2.</span> <span class="nav-text">5.4.2 编写单元测试</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#六-SpringBoot自动配置使用"><span class="nav-number">6.</span> <span class="nav-text">六.SpringBoot自动配置使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-自动注入RedisTemplate"><span class="nav-number">6.0.0.1.</span> <span class="nav-text">6.1 自动注入RedisTemplate</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#6-1-1-需求"><span class="nav-number">6.0.0.1.1.</span> <span class="nav-text">6.1.1 需求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-1-2-代码实现"><span class="nav-number">6.0.0.1.2.</span> <span class="nav-text">6.1.2 代码实现</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#6-1-2-1-创建maven工程并添加依赖"><span class="nav-number">6.0.0.1.2.1.</span> <span class="nav-text">6.1.2.1 创建maven工程并添加依赖</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-1-2-2-创建启动类"><span class="nav-number">6.0.0.1.2.2.</span> <span class="nav-text">6.1.2.2 创建启动类</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-1-2-3-启动服务并测试"><span class="nav-number">6.0.0.1.2.3.</span> <span class="nav-text">6.1.2.3 启动服务并测试</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-1-3-总结"><span class="nav-number">6.0.0.1.3.</span> <span class="nav-text">6.1.3 总结</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-2-Spring之Conditional条件注解"><span class="nav-number">6.0.0.1.4.</span> <span class="nav-text">6.2 Spring之Conditional条件注解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-2-1-需求"><span class="nav-number">6.0.0.1.5.</span> <span class="nav-text">6.2.1 需求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-2-2-代码实现"><span class="nav-number">6.0.0.1.6.</span> <span class="nav-text">6.2.2 代码实现</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#6-2-2-1-添加依赖"><span class="nav-number">6.0.0.1.6.1.</span> <span class="nav-text">6.2.2.1 添加依赖</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-2-2-2-创建User对象"><span class="nav-number">6.0.0.1.6.2.</span> <span class="nav-text">6.2.2.2 创建User对象</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-2-2-3-创建ClassCondition"><span class="nav-number">6.0.0.1.6.3.</span> <span class="nav-text">6.2.2.3 创建ClassCondition</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-2-2-3-创建配置类"><span class="nav-number">6.0.0.1.6.4.</span> <span class="nav-text">6.2.2.3 创建配置类</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-2-3-代码优化"><span class="nav-number">6.0.0.1.7.</span> <span class="nav-text">6.2.3 代码优化</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#6-2-3-1-分析"><span class="nav-number">6.0.0.1.7.1.</span> <span class="nav-text">6.2.3.1 分析</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-2-3-2-自定义Conditional注解"><span class="nav-number">6.0.0.1.7.2.</span> <span class="nav-text">6.2.3.2 自定义Conditional注解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-2-3-3-修改UserConfig"><span class="nav-number">6.0.0.1.7.3.</span> <span class="nav-text">6.2.3.3 修改UserConfig</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#6-2-3-4-修改ClassCondition"><span class="nav-number">6.0.0.1.7.4.</span> <span class="nav-text">6.2.3.4 修改ClassCondition</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#七-SpringBoot自动配置原理"><span class="nav-number">7.</span> <span class="nav-text">七.SpringBoot自动配置原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-SpringBoot常用条件注解"><span class="nav-number">7.0.0.1.</span> <span class="nav-text">7.1 SpringBoot常用条件注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-如何初始化RedisTemplate"><span class="nav-number">7.0.0.2.</span> <span class="nav-text">7.2 如何初始化RedisTemplate</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#八-SpringBoot切换内置服务器"><span class="nav-number">8.</span> <span class="nav-text">八.SpringBoot切换内置服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#8-1-默认使用"><span class="nav-number">8.0.0.1.</span> <span class="nav-text">8.1 默认使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-2-切换其他服务器"><span class="nav-number">8.0.0.2.</span> <span class="nav-text">8.2 切换其他服务器</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#九-SpringBootApplication注解"><span class="nav-number">9.</span> <span class="nav-text">九.@SpringBootApplication注解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#9-1-注册第三方Bean的三种方式"><span class="nav-number">9.0.0.1.</span> <span class="nav-text">9.1 注册第三方Bean的三种方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#9-1-1-需求"><span class="nav-number">9.0.0.1.1.</span> <span class="nav-text">9.1.1 需求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#9-1-2-代码实现"><span class="nav-number">9.0.0.1.2.</span> <span class="nav-text">9.1.2 代码实现</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#9-1-2-1-创建maven工程springboot-enable-other"><span class="nav-number">9.0.0.1.2.1.</span> <span class="nav-text">9.1.2.1 创建maven工程springboot_enable_other</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#9-1-2-2-创建maven工程springboot-enable"><span class="nav-number">9.0.0.1.2.2.</span> <span class="nav-text">9.1.2.2 创建maven工程springboot_enable</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#9-1-2-3-启动服务并测试"><span class="nav-number">9.0.0.1.2.3.</span> <span class="nav-text">9.1.2.3 启动服务并测试</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#9-1-2-4-ComponentScan注解"><span class="nav-number">9.0.0.1.2.4.</span> <span class="nav-text">9.1.2.4 @ComponentScan注解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#9-1-2-5-Import注解"><span class="nav-number">9.0.0.1.2.5.</span> <span class="nav-text">9.1.2.5 @Import注解</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#9-1-2-6-自定注解-EnableUser"><span class="nav-number">9.0.0.1.2.6.</span> <span class="nav-text">9.1.2.6 自定注解@EnableUser</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-Import注解使用方式"><span class="nav-number">9.0.0.2.</span> <span class="nav-text">9.2 @Import注解使用方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#9-2-1-直接注入Bean"><span class="nav-number">9.0.0.2.1.</span> <span class="nav-text">9.2.1 直接注入Bean</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#9-2-2-导入配置类"><span class="nav-number">9.0.0.2.2.</span> <span class="nav-text">9.2.2 导入配置类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#9-2-3-导入ImportSelector实现类"><span class="nav-number">9.0.0.2.3.</span> <span class="nav-text">9.2.3 导入ImportSelector实现类</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#9-2-3-1-创建MyImportSelector"><span class="nav-number">9.0.0.2.3.1.</span> <span class="nav-text">9.2.3.1 创建MyImportSelector</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#9-2-3-2-更新启动类"><span class="nav-number">9.0.0.2.3.2.</span> <span class="nav-text">9.2.3.2 更新启动类</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#9-2-4-导入ImportBeanDefinitionRegistrar实现类"><span class="nav-number">9.0.0.2.4.</span> <span class="nav-text">9.2.4 导入ImportBeanDefinitionRegistrar实现类</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#9-2-4-1创建MyImportBeanDefinitionRegistrar"><span class="nav-number">9.0.0.2.4.1.</span> <span class="nav-text">9.2.4.1创建MyImportBeanDefinitionRegistrar</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#9-2-4-2-更新启动类"><span class="nav-number">9.0.0.2.4.2.</span> <span class="nav-text">9.2.4.2 更新启动类</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-3-EnableAutoConfiguration注解详解"><span class="nav-number">9.0.0.3.</span> <span class="nav-text">9.3 @EnableAutoConfiguration注解详解</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十-SpringBoot自定义第三方starter"><span class="nav-number">10.</span> <span class="nav-text">十.SpringBoot自定义第三方starter</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#10-1-思路分析"><span class="nav-number">10.0.0.1.</span> <span class="nav-text">10.1 思路分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#10-1-1-myredis-spring-boot-starter"><span class="nav-number">10.0.0.1.1.</span> <span class="nav-text">10.1.1 myredis_spring_boot_starter</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-1-2-myredis-spring-boot-starter-autoconfigure"><span class="nav-number">10.0.0.1.2.</span> <span class="nav-text">10.1.2 myredis_spring_boot_starter_autoconfigure</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-2-结论"><span class="nav-number">10.0.0.2.</span> <span class="nav-text">10.2 结论</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-3-代码实现"><span class="nav-number">10.0.0.3.</span> <span class="nav-text">10.3 代码实现</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#10-3-1-创建myredis-spring-boot-starter-autoconfigure工程"><span class="nav-number">10.0.0.3.1.</span> <span class="nav-text">10.3.1 创建myredis-spring-boot-starter-autoconfigure工程</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#10-3-1-1-创建工程并且添加依赖"><span class="nav-number">10.0.0.3.1.1.</span> <span class="nav-text">10.3.1.1 创建工程并且添加依赖</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#10-3-1-2-创建MyRedisProperties"><span class="nav-number">10.0.0.3.1.2.</span> <span class="nav-text">10.3.1.2 创建MyRedisProperties</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#10-3-1-3-创建MyRedisAutoConfiguration"><span class="nav-number">10.0.0.3.1.3.</span> <span class="nav-text">10.3.1.3 创建MyRedisAutoConfiguration</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#10-3-1-4-创建spring-factories文件"><span class="nav-number">10.0.0.3.1.4.</span> <span class="nav-text">10.3.1.4 创建spring.factories文件</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-3-2-创建myredis-spring-boot-starter工程"><span class="nav-number">10.0.0.3.2.</span> <span class="nav-text">10.3.2 创建myredis-spring-boot-starter工程</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-4-测试"><span class="nav-number">10.0.0.4.</span> <span class="nav-text">10.4 测试</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#10-4-1-创建测试工程"><span class="nav-number">10.0.0.4.1.</span> <span class="nav-text">10.4.1 创建测试工程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-4-2-测试bean是否自动配置"><span class="nav-number">10.0.0.4.2.</span> <span class="nav-text">10.4.2 测试bean是否自动配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-4-3-测试配置文件是否生效"><span class="nav-number">10.0.0.4.3.</span> <span class="nav-text">10.4.3 测试配置文件是否生效</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十一-SpringBoot事件监听"><span class="nav-number">11.</span> <span class="nav-text">十一.SpringBoot事件监听</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#11-1-介绍"><span class="nav-number">11.0.0.1.</span> <span class="nav-text">11.1 介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-2-CommandLineRunner和ApplicationRunner使用"><span class="nav-number">11.0.0.2.</span> <span class="nav-text">11.2 CommandLineRunner和ApplicationRunner使用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#11-2-1-创建maven工程"><span class="nav-number">11.0.0.2.1.</span> <span class="nav-text">11.2.1 创建maven工程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#11-2-2-编写启动类"><span class="nav-number">11.0.0.2.2.</span> <span class="nav-text">11.2.2 编写启动类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#11-2-3-自定义监听器"><span class="nav-number">11.0.0.2.3.</span> <span class="nav-text">11.2.3 自定义监听器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#11-2-4-启动测试可以看到控制台打印信息"><span class="nav-number">11.0.0.2.4.</span> <span class="nav-text">11.2.4 启动测试可以看到控制台打印信息</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-3-SpringApplicationRunListenerer和ApplicationContextInitializ使用"><span class="nav-number">11.0.0.3.</span> <span class="nav-text">11.3 SpringApplicationRunListenerer和ApplicationContextInitializ使用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#11-3-1-自定义监听器"><span class="nav-number">11.0.0.3.1.</span> <span class="nav-text">11.3.1 自定义监听器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#11-3-2-创建spring-factories文件"><span class="nav-number">11.0.0.3.2.</span> <span class="nav-text">11.3.2 创建spring.factories文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#11-3-3-启动服务并测试，可以发现控制台打印信息包含Listener输出"><span class="nav-number">11.0.0.3.3.</span> <span class="nav-text">11.3.3 启动服务并测试，可以发现控制台打印信息包含Listener输出</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-4-总结"><span class="nav-number">11.0.0.4.</span> <span class="nav-text">11.4 总结</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十二-SpringBoot监控"><span class="nav-number">12.</span> <span class="nav-text">十二.SpringBoot监控</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-介绍"><span class="nav-number">12.0.0.1.</span> <span class="nav-text">12.1 介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-2-Actuator入门"><span class="nav-number">12.0.0.2.</span> <span class="nav-text">12.2 Actuator入门</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#12-2-1-创建maven工程"><span class="nav-number">12.0.0.2.1.</span> <span class="nav-text">12.2.1 创建maven工程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#12-2-2-启动服务并访问-localhost-8080-actuator"><span class="nav-number">12.0.0.2.2.</span> <span class="nav-text">12.2.2 启动服务并访问 localhost:8080&#x2F;actuator</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-3-Actuator使用说明"><span class="nav-number">12.0.0.3.</span> <span class="nav-text">12.3 Actuator使用说明</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#12-3-1-info信息"><span class="nav-number">12.0.0.3.1.</span> <span class="nav-text">12.3.1 info信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#12-3-2-健康信息"><span class="nav-number">12.0.0.3.2.</span> <span class="nav-text">12.3.2 健康信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#12-3-3-开放web相关端点信息"><span class="nav-number">12.0.0.3.3.</span> <span class="nav-text">12.3.3 开放web相关端点信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#12-3-4-Actuator暴露的端点说明"><span class="nav-number">12.0.0.3.4.</span> <span class="nav-text">12.3.4 Actuator暴露的端点说明</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-4-Spring-Boot-Admin"><span class="nav-number">12.0.0.4.</span> <span class="nav-text">12.4 Spring Boot Admin</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#12-4-1-介绍"><span class="nav-number">12.0.0.4.1.</span> <span class="nav-text">12.4.1 介绍</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#12-4-2-入门程序"><span class="nav-number">12.0.0.4.2.</span> <span class="nav-text">12.4.2 入门程序</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#12-4-2-1-创建admin-server工程"><span class="nav-number">12.0.0.4.2.1.</span> <span class="nav-text">12.4.2.1 创建admin server工程</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#12-4-2-2-创建admin-client工程"><span class="nav-number">12.0.0.4.2.2.</span> <span class="nav-text">12.4.2.2 创建admin client工程</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#12-4-3-测试"><span class="nav-number">12.0.0.4.3.</span> <span class="nav-text">12.4.3 测试</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description">学习笔记</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">111</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
