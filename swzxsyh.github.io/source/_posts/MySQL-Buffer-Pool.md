---
layout: post
title: MySQL-Buffer Pool
date: 2022-06-30 23:09:37
tags:
---

# Buffer Pool

MySQL以页为单位，默认大小16K，会在Buffer Pool中划分出很多的缓存页，并用描述数据（元数据）记录缓存页所在的表空间 数据页编号、Buffer Pool地址等信息
所有的更新和读取都是在Buffer Pool中进行。并由异步线程不断刷盘。查询数据时通过hash表快速定位到对应的缓存页

## Free 链表

- 记录空闲的缓存页。从磁盘加载数据时，通过free链表找到空闲缓存页进行写入

## Flush 链表

- 异步线程刷盘时，不会把所有的缓存页刷盘，只会把flush链表上的脏页刷盘

## LRU

- 通过LRU淘汰最近最少使用的缓存页，以供新加载的数据进行写入
- 由于读取磁盘数据时会把相邻的页也读入，所以为防止相邻的页没有被访问，但又不位于链表末尾，无法淘汰；或者全表扫描时频繁访问的数据位于了链表末尾被淘汰 这两个问题，LRU又做了冷热分离，划分为young和old区域
  - 数据第一次加载时，先放入冷（old）区域，如果1秒后再次访问到，则会移动到热区域（young）
  - young区域前面的1/4被访问不会移动到链表头部，后面3/4被访问才会，防止区域节点频繁移动
